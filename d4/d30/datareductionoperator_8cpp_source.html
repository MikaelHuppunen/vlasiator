<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Vlasiator: datareduction/datareductionoperator.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Vlasiator<span id="projectnumber">&#160;25cfb9ae on dev (v4.0 + 5747 commits, including GPU_v1)</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('d4/d30/datareductionoperator_8cpp_source.html','../../',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">datareductionoperator.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="../../d4/d30/datareductionoperator_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment"> * This file is part of Vlasiator.</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment"> * Copyright 2010-2016 Finnish Meteorological Institute</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment"> *</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"> * For details of usage, see the COPYING file and read the &quot;Rules of the Road&quot;</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"> * at http://www.physics.helsinki.fi/vlasiator/</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment"> *</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment"> * This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment"> * it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment"> * the Free Software Foundation; either version 2 of the License, or</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment"> * (at your option) any later version.</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment"> *</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment"> * This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment"> * GNU General Public License for more details.</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment"> *</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment"> * You should have received a copy of the GNU General Public License along</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment"> * with this program; if not, write to the Free Software Foundation, Inc.,</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="comment"> * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="comment"> */</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span> </div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &lt;cstdlib&gt;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &lt;mpi.h&gt;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &lt;array&gt;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &quot;<a class="code" href="../../d0/d4f/datareductionoperator_8h.html">datareductionoperator.h</a>&quot;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &quot;<a class="code" href="../../d0/dfd/object__wrapper_8h.html">../object_wrapper.h</a>&quot;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span> </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="keyword">using namespace </span>std;</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span> </div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno"><a class="line" href="../../d4/d30/datareductionoperator_8cpp.html#a4fb833d220f3704421810d2f70ffbd0d">   34</a></span><span class="keyword">typedef</span> <a class="code hl_struct" href="../../d0/dbf/struct_parameters.html">Parameters</a> <a class="code hl_typedef" href="../../d4/d30/datareductionoperator_8cpp.html#a4fb833d220f3704421810d2f70ffbd0d">P</a>;</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span> </div>
<div class="foldopen" id="foldopen00036" data-start="{" data-end="}">
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno"><a class="line" href="../../db/d48/namespace_d_r_o.html">   36</a></span><span class="keyword">namespace </span><a class="code hl_namespace" href="../../db/d48/namespace_d_r_o.html">DRO</a> {</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span> </div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>   <span class="comment">// ************************************************************</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>   <span class="comment">// ***** DEFINITIONS FOR DATAREDUCTIONOPERATOR BASE CLASS *****</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>   <span class="comment">// ************************************************************</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno"><a class="line" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">   43</a></span>   <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DataReductionOperator::DataReductionOperator</a>() { }</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno"><a class="line" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a4d77da3882b685fb30efef6fe94ed144">   46</a></span>   <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a4d77da3882b685fb30efef6fe94ed144">DataReductionOperator::~DataReductionOperator</a>() { }</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span></div>
<div class="foldopen" id="foldopen00053" data-start="{" data-end="}">
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno"><a class="line" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a6761dbf578f0feb9027706a9976df633">   53</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a6761dbf578f0feb9027706a9976df633">DataReductionOperator::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>      cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: DataReductionOperator::reduceData called instead of derived class function! (variable&quot;</span> &lt;&lt;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>               <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a44aceedc6dca48c9418184d260336202">getName</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>      cerr &lt;&lt; <span class="stringliteral">&quot;       Did you use a diagnostic reducer for writing bulk data?&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>   }</div>
</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span></div>
<div class="foldopen" id="foldopen00067" data-start="{" data-end="}">
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno"><a class="line" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a259404d49d13bfb267f42dde226b726a">   67</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a259404d49d13bfb267f42dde226b726a">DataReductionOperator::reduceDiagnostic</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>* result) {</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>      cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: DataReductionOperator::reduceData called instead of derived class function! (variable &quot;</span> &lt;&lt;</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>              <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a44aceedc6dca48c9418184d260336202">getName</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>      cerr &lt;&lt; <span class="stringliteral">&quot;       Did you use a bulk reducer for writing diagnostic data?&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>   }</div>
</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span> </div>
<div class="foldopen" id="foldopen00074" data-start="{" data-end="}">
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno"><a class="line" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a1bdf365d6ead48011a0220a231e8bced">   74</a></span>   <a class="code hl_function" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a1bdf365d6ead48011a0220a231e8bced">DataReductionOperatorCellParams::DataReductionOperatorCellParams</a>(<span class="keyword">const</span> std::string&amp; name,<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> parameterIndex,<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _vectorSize) :</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>      <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DataReductionOperator</a>(), <a class="code hl_variable" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a4fdec3fbb1461f812ac68904e9dfb042">_parameterIndex</a> {parameterIndex}, <a class="code hl_variable" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a7ed040bcc0f67439fcfbf506aa985cd3">vectorSize</a> {_vectorSize}, <a class="code hl_variable" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#ae41d76025b42eebccb33ee7ee46589ed">variableName</a> {name} {}</div>
</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno"><a class="line" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#ae944611dd23023f88109f7155db7a71d">   76</a></span>   <a class="code hl_function" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#ae944611dd23023f88109f7155db7a71d">DataReductionOperatorCellParams::~DataReductionOperatorCellParams</a>() { }</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span> </div>
<div class="foldopen" id="foldopen00078" data-start="{" data-end="}">
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno"><a class="line" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#af4ed33850c9cf656c1067248df268e44">   78</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#af4ed33850c9cf656c1067248df268e44">DataReductionOperatorCellParams::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; _vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>      dataSize =  <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>);</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>      _vectorSize = <a class="code hl_variable" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a7ed040bcc0f67439fcfbf506aa985cd3">vectorSize</a>;</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>   }</div>
</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span> </div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno"><a class="line" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#aa9ef742818e75c507a7af251492c0ed8">   85</a></span>   std::string <a class="code hl_function" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#aa9ef742818e75c507a7af251492c0ed8">DataReductionOperatorCellParams::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#ae41d76025b42eebccb33ee7ee46589ed">variableName</a>;}</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span> </div>
<div class="foldopen" id="foldopen00087" data-start="{" data-end="}">
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno"><a class="line" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#af4942b658c4c57f5f67f2de5a066261b">   87</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#af4942b658c4c57f5f67f2de5a066261b">DataReductionOperatorCellParams::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a13a2940a5b472af0ee678e73823a4327">data</a>);</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; <a class="code hl_variable" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a7ed040bcc0f67439fcfbf506aa985cd3">vectorSize</a>*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>){</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>         buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>      }</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>   }</div>
</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span> </div>
<div class="foldopen" id="foldopen00095" data-start="{" data-end="}">
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno"><a class="line" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#af6d2b0fc71f6e6817bbd31dc2290e5b9">   95</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#af6d2b0fc71f6e6817bbd31dc2290e5b9">DataReductionOperatorCellParams::reduceDiagnostic</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>* buffer){</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>      <span class="comment">//If vectorSize is &gt;1 it still works, we just give the first value and no other ones..</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>      *buffer=<a class="code hl_variable" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a13a2940a5b472af0ee678e73823a4327">data</a>[0];</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>   }</div>
</div>
<div class="foldopen" id="foldopen00100" data-start="{" data-end="}">
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno"><a class="line" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a91f83e19ec9f3e8a5032ace9e642a377">  100</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a91f83e19ec9f3e8a5032ace9e642a377">DataReductionOperatorCellParams::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>=0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>&lt;<a class="code hl_variable" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a7ed040bcc0f67439fcfbf506aa985cd3">vectorSize</a>; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++) {</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>         <span class="keywordflow">if</span>(!std::isfinite(cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_variable" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a4fdec3fbb1461f812ac68904e9dfb042">_parameterIndex</a>+<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>])) {</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>            <span class="keywordtype">string</span> message = <span class="stringliteral">&quot;The DataReductionOperator &quot;</span> + this-&gt;<a class="code hl_function" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#aa9ef742818e75c507a7af251492c0ed8">getName</a>() + <span class="stringliteral">&quot; returned a nan or an inf in its &quot;</span> + std::to_string(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) + <span class="stringliteral">&quot;-component.&quot;</span>;</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>            <a class="code hl_function" href="../../d9/df9/common_8cpp.html#a6167b9f510c4eef8b16fa67bf3d5566e">bailout</a>(<span class="keyword">true</span>, message, __FILE__, __LINE__);</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>         }</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>      }</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>      <a class="code hl_variable" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a13a2940a5b472af0ee678e73823a4327">data</a>  = &amp;(cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_variable" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a4fdec3fbb1461f812ac68904e9dfb042">_parameterIndex</a>]);</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>   }</div>
</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span> </div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno"><a class="line" href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#af9cf391de86c667488a5768dfcb9159a">  111</a></span>   std::string <a class="code hl_function" href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#af9cf391de86c667488a5768dfcb9159a">DataReductionOperatorFsGrid::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#a42f058d9ae5fcbfa23c8857472073a44">variableName</a>;}</div>
<div class="foldopen" id="foldopen00112" data-start="{" data-end="}">
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno"><a class="line" href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#a0f8eb40cf188a4e3275afbdf64055ee4">  112</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#a0f8eb40cf188a4e3275afbdf64055ee4">DataReductionOperatorFsGrid::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>      <span class="comment">// These are only set to dmmy values, as this reducer writes its own vlsv dataset anyway</span></div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>      dataSize = <span class="keyword">sizeof</span>(double);</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>      vectorSize = 1;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>   }</div>
</div>
<div class="foldopen" id="foldopen00119" data-start="{" data-end="}">
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno"><a class="line" href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#afccfc26d02f0f58676130bce64571cf7">  119</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#afccfc26d02f0f58676130bce64571cf7">DataReductionOperatorFsGrid::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>      <span class="comment">// This returns false, since it will handle writing itself in writeFsGridData below.</span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>   }</div>
</div>
<div class="foldopen" id="foldopen00123" data-start="{" data-end="}">
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno"><a class="line" href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#a15803e7139cde5eccbf184eb26946d35">  123</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#a15803e7139cde5eccbf184eb26946d35">DataReductionOperatorFsGrid::reduceDiagnostic</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> * result) {</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>   }</div>
</div>
<div class="foldopen" id="foldopen00126" data-start="{" data-end="}">
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno"><a class="line" href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#a1a2b9f25cd16bc28506d7f9df1a80022">  126</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#a1a2b9f25cd16bc28506d7f9df1a80022">DataReductionOperatorFsGrid::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>   }</div>
</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span> </div>
<div class="foldopen" id="foldopen00130" data-start="{" data-end="}">
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno"><a class="line" href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#a524e76c5e5c165287e35a0a8df1c97d1">  130</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#a524e76c5e5c165287e35a0a8df1c97d1">DataReductionOperatorFsGrid::writeFsGridData</a>(</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>                      FsGrid&lt; std::array&lt;Real, fsgrids::bfield::N_BFIELD&gt;, <a class="code hl_define" href="../../d6/dc2/definitions_8h.html#a65ab62fb58204a4baa2fb83894a20d8a">FS_STENCIL_WIDTH</a>&gt; &amp; perBGrid,</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>                      FsGrid&lt; std::array&lt;Real, fsgrids::efield::N_EFIELD&gt;, <a class="code hl_define" href="../../d6/dc2/definitions_8h.html#a65ab62fb58204a4baa2fb83894a20d8a">FS_STENCIL_WIDTH</a>&gt; &amp; EGrid,</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>                      FsGrid&lt; std::array&lt;Real, fsgrids::ehall::N_EHALL&gt;, <a class="code hl_define" href="../../d6/dc2/definitions_8h.html#a65ab62fb58204a4baa2fb83894a20d8a">FS_STENCIL_WIDTH</a>&gt; &amp; EHallGrid,</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>                      FsGrid&lt; std::array&lt;Real, fsgrids::egradpe::N_EGRADPE&gt;, <a class="code hl_define" href="../../d6/dc2/definitions_8h.html#a65ab62fb58204a4baa2fb83894a20d8a">FS_STENCIL_WIDTH</a>&gt; &amp; EGradPeGrid,</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>                      FsGrid&lt; std::array&lt;Real, fsgrids::moments::N_MOMENTS&gt;, <a class="code hl_define" href="../../d6/dc2/definitions_8h.html#a65ab62fb58204a4baa2fb83894a20d8a">FS_STENCIL_WIDTH</a>&gt; &amp; momentsGrid,</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>                      FsGrid&lt; std::array&lt;Real, fsgrids::dperb::N_DPERB&gt;, <a class="code hl_define" href="../../d6/dc2/definitions_8h.html#a65ab62fb58204a4baa2fb83894a20d8a">FS_STENCIL_WIDTH</a>&gt; &amp; dPerBGrid,</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>                      FsGrid&lt; std::array&lt;Real, fsgrids::dmoments::N_DMOMENTS&gt;, <a class="code hl_define" href="../../d6/dc2/definitions_8h.html#a65ab62fb58204a4baa2fb83894a20d8a">FS_STENCIL_WIDTH</a>&gt; &amp; dMomentsGrid,</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>                      FsGrid&lt; std::array&lt;Real, fsgrids::bgbfield::N_BGB&gt;, <a class="code hl_define" href="../../d6/dc2/definitions_8h.html#a65ab62fb58204a4baa2fb83894a20d8a">FS_STENCIL_WIDTH</a>&gt; &amp; BgBGrid,</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>                      FsGrid&lt; std::array&lt;Real, fsgrids::volfields::N_VOL&gt;, <a class="code hl_define" href="../../d6/dc2/definitions_8h.html#a65ab62fb58204a4baa2fb83894a20d8a">FS_STENCIL_WIDTH</a>&gt; &amp; volGrid,</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>                      FsGrid&lt; fsgrids::technical, FS_STENCIL_WIDTH&gt; &amp; technicalGrid,</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>                      <span class="keyword">const</span> std::string&amp; meshName, vlsv::Writer&amp; vlsvWriter,</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>                      <span class="keyword">const</span> <span class="keywordtype">bool</span> writeAsFloat) {</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span> </div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>      std::map&lt;std::string,std::string&gt; attribs;</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>      attribs[<span class="stringliteral">&quot;mesh&quot;</span>]=meshName;</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>      attribs[<span class="stringliteral">&quot;name&quot;</span>]=<a class="code hl_variable" href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#a42f058d9ae5fcbfa23c8857472073a44">variableName</a>;</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>      attribs[<span class="stringliteral">&quot;unit&quot;</span>]=<a class="code hl_variable" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a4ed1e17513da860dde24bfe63cac9119">unit</a>;</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>      attribs[<span class="stringliteral">&quot;unitLaTeX&quot;</span>]=<a class="code hl_variable" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#afe311d7be08842eb5d77c1af2010095d">unitLaTeX</a>;</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>      attribs[<span class="stringliteral">&quot;unitConversion&quot;</span>]=<a class="code hl_variable" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a6007d65b072f39e9a107c88cc127dec7">unitConversion</a>;</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>      attribs[<span class="stringliteral">&quot;variableLaTeX&quot;</span>]=<a class="code hl_variable" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a4a6ff6ab3eb4e17176c247765946b359">variableLaTeX</a>;</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span> </div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>      std::vector&lt;double&gt; varBuffer =</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>         <a class="code hl_variable" href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#a3195a8dc79a32f93b27a1c06f08026e2">lambda</a>(perBGrid,EGrid,EHallGrid,EGradPeGrid,momentsGrid,dPerBGrid,dMomentsGrid,BgBGrid,volGrid,technicalGrid);</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span> </div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>      std::array&lt;FsGridTools::FsIndex_t,3&gt;&amp; gridSize = technicalGrid.getLocalSize();</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>      <span class="keywordtype">int</span> vectorSize;</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span> </div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>      <span class="comment">// Check if there is anything to write (eg, we are a non-FS process)</span></div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>      <span class="keywordflow">if</span> (gridSize[0]*gridSize[1]*gridSize[2] == 0)</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>         vectorSize = 0;</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>         vectorSize = varBuffer.size() / (gridSize[0]*gridSize[1]*gridSize[2]);</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span> </div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>      <span class="keywordflow">if</span>(writeAsFloat) {</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>         <span class="comment">// Convert down to 32bit floats to save output space</span></div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>         std::vector&lt;float&gt; varBufferFloat(varBuffer.size());</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>         <span class="keywordflow">for</span>(uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>=0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>&lt;varBuffer.size(); <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++) {</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>            varBufferFloat[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = (float)varBuffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>         }</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>         <span class="keywordflow">if</span>(vlsvWriter.writeArray(<span class="stringliteral">&quot;VARIABLE&quot;</span>,attribs, <span class="stringliteral">&quot;float&quot;</span>, gridSize[0]*gridSize[1]*gridSize[2], vectorSize, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(varBufferFloat.data())) == <span class="keyword">false</span>) {</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>            <span class="keywordtype">string</span> message = <span class="stringliteral">&quot;The DataReductionOperator &quot;</span> + this-&gt;<a class="code hl_function" href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#af9cf391de86c667488a5768dfcb9159a">getName</a>() + <span class="stringliteral">&quot; failed to write its data.&quot;</span>;</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>            <a class="code hl_function" href="../../d9/df9/common_8cpp.html#a6167b9f510c4eef8b16fa67bf3d5566e">bailout</a>(<span class="keyword">true</span>, message, __FILE__, __LINE__);</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>         }</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span> </div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>         <span class="keywordflow">if</span>(vlsvWriter.writeArray(<span class="stringliteral">&quot;VARIABLE&quot;</span>,attribs, <span class="stringliteral">&quot;float&quot;</span>, gridSize[0]*gridSize[1]*gridSize[2], vectorSize, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>), <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(varBuffer.data())) == <span class="keyword">false</span>) {</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>            <span class="keywordtype">string</span> message = <span class="stringliteral">&quot;The DataReductionOperator &quot;</span> + this-&gt;<a class="code hl_function" href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#af9cf391de86c667488a5768dfcb9159a">getName</a>() + <span class="stringliteral">&quot; failed to write its data.&quot;</span>;</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>            <a class="code hl_function" href="../../d9/df9/common_8cpp.html#a6167b9f510c4eef8b16fa67bf3d5566e">bailout</a>(<span class="keyword">true</span>, message, __FILE__, __LINE__);</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>         }</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>      }</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span> </div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>   }</div>
</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span> </div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno"><a class="line" href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#a5cb0fc845273134ba3c2f0c7ac2fa78a">  185</a></span>   std::string <a class="code hl_function" href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#a5cb0fc845273134ba3c2f0c7ac2fa78a">DataReductionOperatorIonosphereElement::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#aff8b8161c47f4e970f19ab53696b084a">variableName</a>;}</div>
<div class="foldopen" id="foldopen00186" data-start="{" data-end="}">
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno"><a class="line" href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#a8a704a92e2085d244b8c18bd4e8197cc">  186</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#a8a704a92e2085d244b8c18bd4e8197cc">DataReductionOperatorIonosphereElement::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>      dataSize = <span class="keyword">sizeof</span>(double);</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>      vectorSize = 1;</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>   }</div>
</div>
<div class="foldopen" id="foldopen00192" data-start="{" data-end="}">
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno"><a class="line" href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#a4d0c18fde92c4d39bf327c6ae9a2821f">  192</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#a4d0c18fde92c4d39bf327c6ae9a2821f">DataReductionOperatorIonosphereElement::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>      <span class="comment">// This returns false, since it will handle writing itself in writeIonosphereGridData below.</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>   }</div>
</div>
<div class="foldopen" id="foldopen00196" data-start="{" data-end="}">
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno"><a class="line" href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#a908c0d85fe9c2f0f666cfef475f0dd72">  196</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#a908c0d85fe9c2f0f666cfef475f0dd72">DataReductionOperatorIonosphereElement::reduceDiagnostic</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> * result) {</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>   }</div>
</div>
<div class="foldopen" id="foldopen00199" data-start="{" data-end="}">
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno"><a class="line" href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#a49481337596135604c98f7634c83fd25">  199</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#a49481337596135604c98f7634c83fd25">DataReductionOperatorIonosphereElement::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>   }</div>
</div>
<div class="foldopen" id="foldopen00202" data-start="{" data-end="}">
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno"><a class="line" href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#a3441e39b208d8f119a70bf351e7d1bc2">  202</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#a3441e39b208d8f119a70bf351e7d1bc2">DataReductionOperatorIonosphereElement::writeIonosphereData</a>(<a class="code hl_struct" href="../../d4/d8d/struct_s_b_c_1_1_spherical_tri_grid.html">SBC::SphericalTriGrid</a>&amp;</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>            grid, vlsv::Writer&amp; vlsvWriter) {</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span> </div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>      <span class="comment">// No point in trying to write anything if there is no ionosphere grid.</span></div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>      <span class="keywordflow">if</span>(grid.elements.size() == 0) {</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>         <span class="comment">// Note this indicates success, since not writing an empty mesh is quite ok.</span></div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>         <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>      }</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span> </div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>      std::map&lt;std::string,std::string&gt; attribs;</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>      attribs[<span class="stringliteral">&quot;mesh&quot;</span>]=<span class="stringliteral">&quot;ionosphere&quot;</span>;</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>      attribs[<span class="stringliteral">&quot;name&quot;</span>]=<a class="code hl_variable" href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#aff8b8161c47f4e970f19ab53696b084a">variableName</a>;</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>      attribs[<span class="stringliteral">&quot;unit&quot;</span>]=<a class="code hl_variable" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a4ed1e17513da860dde24bfe63cac9119">unit</a>;</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>      attribs[<span class="stringliteral">&quot;unitLaTeX&quot;</span>]=<a class="code hl_variable" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#afe311d7be08842eb5d77c1af2010095d">unitLaTeX</a>;</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>      attribs[<span class="stringliteral">&quot;unitConversion&quot;</span>]=<a class="code hl_variable" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a6007d65b072f39e9a107c88cc127dec7">unitConversion</a>;</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>      attribs[<span class="stringliteral">&quot;variableLaTeX&quot;</span>]=<a class="code hl_variable" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a4a6ff6ab3eb4e17176c247765946b359">variableLaTeX</a>;</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span> </div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>      <span class="comment">// Only task 0 of the ionosphere communicator writes, but all other need to sync vectorSize</span></div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>      <span class="keywordtype">int</span> rank = -1;</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>      <span class="keywordtype">int</span> worldRank = 0;</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>      <span class="keywordflow">if</span>(grid.isCouplingInwards || grid.isCouplingOutwards) {</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>        MPI_Comm_rank(grid.communicator,&amp;rank);</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>      }</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>      MPI_Comm_rank(MPI_COMM_WORLD,&amp;worldRank);</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>      <span class="keywordtype">int</span> vectorSize = 0;</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>      <span class="keywordflow">if</span>(rank == 0) {</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>        std::vector&lt;Real&gt; varBuffer = <a class="code hl_variable" href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#aaa713c54badca1df3919466df8f65837">lambda</a>(grid);</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span> </div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>        <span class="keywordtype">int</span> vectorSize = varBuffer.size() / grid.elements.size();</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span> </div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>        <span class="comment">// We need to have vectorSize the same on all ranks, otherwise MPI_COMM_WORLD rank 0 writes a bogus value</span></div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>        MPI_Bcast(&amp;vectorSize, 1, MPI_INT, grid.writingRank, MPI_COMM_WORLD);</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span> </div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>        <span class="keywordflow">if</span>(vlsvWriter.writeArray(<span class="stringliteral">&quot;VARIABLE&quot;</span>, attribs, <span class="stringliteral">&quot;float&quot;</span>, grid.elements.size(), vectorSize, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>), <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(varBuffer.data())) == <span class="keyword">false</span>) {</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>          <span class="keywordtype">string</span> message = <span class="stringliteral">&quot;The DataReductionOperator &quot;</span> + this-&gt;<a class="code hl_function" href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#a5cb0fc845273134ba3c2f0c7ac2fa78a">getName</a>() + <span class="stringliteral">&quot; failed to write its data.&quot;</span>;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>          <a class="code hl_function" href="../../d9/df9/common_8cpp.html#a6167b9f510c4eef8b16fa67bf3d5566e">bailout</a>(<span class="keyword">true</span>, message, __FILE__, __LINE__);</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>        }</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>        <span class="comment">// We need to have vectorSize the same on all ranks, otherwise MPI_COMM_WORLD rank 0 writes a bogus value</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>        MPI_Bcast(&amp;vectorSize, 1, MPI_INT, grid.writingRank, MPI_COMM_WORLD);</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span> </div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>        <span class="comment">// Dummy write</span></div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>        vlsvWriter.writeArray(<span class="stringliteral">&quot;VARIABLE&quot;</span>, attribs, <span class="stringliteral">&quot;float&quot;</span>, 0, vectorSize, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>), <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>      }</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span> </div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>   }</div>
</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span> </div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno"><a class="line" href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#a1101a5ac929d6458f505036858f1d87a">  250</a></span>   std::string <a class="code hl_function" href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#a1101a5ac929d6458f505036858f1d87a">DataReductionOperatorIonosphereNode::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#a17096855535a40bd803fca99eb92ce51">variableName</a>;}</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno"><a class="line" href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#a1904ab3384e807a777d35ffd6f7b155d">  251</a></span>   std::string <a class="code hl_function" href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#a1904ab3384e807a777d35ffd6f7b155d">DataReductionOperatorIonosphereNodeInt::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#a4d3071ee26e3c7988b8e4f50c1401f64">variableName</a>;}</div>
<div class="foldopen" id="foldopen00252" data-start="{" data-end="}">
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno"><a class="line" href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#a63bce8b284f6d1d383c3dc6c8fcaeea7">  252</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#a63bce8b284f6d1d383c3dc6c8fcaeea7">DataReductionOperatorIonosphereNode::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>      dataSize = <span class="keyword">sizeof</span>(double);</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>      vectorSize = 1;</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>   }</div>
</div>
<div class="foldopen" id="foldopen00258" data-start="{" data-end="}">
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno"><a class="line" href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#ac46d14a5b3fc6d7a7ab2b84efb561efd">  258</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#ac46d14a5b3fc6d7a7ab2b84efb561efd">DataReductionOperatorIonosphereNodeInt::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>      dataType = <span class="stringliteral">&quot;int&quot;</span>;</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>      dataSize = <span class="keyword">sizeof</span>(int);</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>      vectorSize = 1;</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>   }</div>
</div>
<div class="foldopen" id="foldopen00264" data-start="{" data-end="}">
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno"><a class="line" href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#a03425a64095d72e23c8afa40dd0ef52a">  264</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#a03425a64095d72e23c8afa40dd0ef52a">DataReductionOperatorIonosphereNode::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>      <span class="comment">// This returns false, since it will handle writing itself in writeIonosphereGridData below.</span></div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>   }</div>
</div>
<div class="foldopen" id="foldopen00268" data-start="{" data-end="}">
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno"><a class="line" href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#a31b4106dc212b48af50ffd6c72a83d46">  268</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#a31b4106dc212b48af50ffd6c72a83d46">DataReductionOperatorIonosphereNodeInt::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>      <span class="comment">// This returns false, since it will handle writing itself in writeIonosphereGridData below.</span></div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>   }</div>
</div>
<div class="foldopen" id="foldopen00272" data-start="{" data-end="}">
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno"><a class="line" href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#a88268f5df6b9d0ee575512db1f0476cf">  272</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#a88268f5df6b9d0ee575512db1f0476cf">DataReductionOperatorIonosphereNode::reduceDiagnostic</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> * result) {</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>   }</div>
</div>
<div class="foldopen" id="foldopen00275" data-start="{" data-end="}">
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno"><a class="line" href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#a50192064a88fc78228bfd037ab436a0a">  275</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#a50192064a88fc78228bfd037ab436a0a">DataReductionOperatorIonosphereNodeInt::reduceDiagnostic</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> * result) {</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>   }</div>
</div>
<div class="foldopen" id="foldopen00278" data-start="{" data-end="}">
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno"><a class="line" href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#aaacfe407045230a8340f72ac831cf3f9">  278</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#aaacfe407045230a8340f72ac831cf3f9">DataReductionOperatorIonosphereNode::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>   }</div>
</div>
<div class="foldopen" id="foldopen00281" data-start="{" data-end="}">
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno"><a class="line" href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#ac000989aab649780a3220e516984b5af">  281</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#ac000989aab649780a3220e516984b5af">DataReductionOperatorIonosphereNodeInt::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>   }</div>
</div>
<div class="foldopen" id="foldopen00284" data-start="{" data-end="}">
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno"><a class="line" href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#ad77dfc604690ce0b16c9eecf2f93254c">  284</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#ad77dfc604690ce0b16c9eecf2f93254c">DataReductionOperatorIonosphereNode::writeIonosphereData</a>(<a class="code hl_struct" href="../../d4/d8d/struct_s_b_c_1_1_spherical_tri_grid.html">SBC::SphericalTriGrid</a>&amp;</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>            grid, vlsv::Writer&amp; vlsvWriter) {</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span> </div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>      <span class="comment">// skip ionosphere for inital-grid as it breaks</span></div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d0/dbf/struct_parameters.html#ae493fa7c00c862e1124a85ecb6ea7e19">P::systemWriteName</a>[<a class="code hl_variable" href="../../d0/dbf/struct_parameters.html#ae493fa7c00c862e1124a85ecb6ea7e19">P::systemWriteName</a>.size() - 1] == <span class="stringliteral">&quot;initial-grid&quot;</span>) {</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>         <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>      }</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span> </div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>      <span class="comment">// No point in trying to write anything if there is no ionosphere grid.</span></div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>      <span class="keywordflow">if</span>(grid.nodes.size() == 0) {</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>         <span class="comment">// Note this indicates success, since not writing an empty mesh is quite ok.</span></div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>         <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>      }</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>      std::map&lt;std::string,std::string&gt; attribs;</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>      attribs[<span class="stringliteral">&quot;mesh&quot;</span>]=<span class="stringliteral">&quot;ionosphere&quot;</span>;</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>      attribs[<span class="stringliteral">&quot;name&quot;</span>]=<a class="code hl_variable" href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#a17096855535a40bd803fca99eb92ce51">variableName</a>;</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>      attribs[<span class="stringliteral">&quot;centering&quot;</span>]= <span class="stringliteral">&quot;node&quot;</span>; <span class="comment">// &lt;-- this tells visit the variable is node-centered</span></div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>      attribs[<span class="stringliteral">&quot;unit&quot;</span>]=<a class="code hl_variable" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a4ed1e17513da860dde24bfe63cac9119">unit</a>;</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>      attribs[<span class="stringliteral">&quot;unitLaTeX&quot;</span>]=<a class="code hl_variable" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#afe311d7be08842eb5d77c1af2010095d">unitLaTeX</a>;</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>      attribs[<span class="stringliteral">&quot;unitConversion&quot;</span>]=<a class="code hl_variable" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a6007d65b072f39e9a107c88cc127dec7">unitConversion</a>;</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>      attribs[<span class="stringliteral">&quot;variableLaTeX&quot;</span>]=<a class="code hl_variable" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a4a6ff6ab3eb4e17176c247765946b359">variableLaTeX</a>;</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span> </div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>      <span class="comment">// Only task 0 of the ionosphere communicator writes, but all others need to sync vectorSize</span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>      <span class="keywordtype">int</span> rank = -1;</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>      <span class="keywordtype">int</span> worldRank = 0;</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>      <span class="keywordflow">if</span>(grid.isCouplingInwards || grid.isCouplingOutwards) {</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>        MPI_Comm_rank(grid.communicator,&amp;rank);</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>      }</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>      MPI_Comm_rank(MPI_COMM_WORLD,&amp;worldRank);</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>      <span class="keywordtype">int</span> vectorSize = 0;</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>      <span class="keywordflow">if</span>(rank == 0) {</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>        std::vector&lt;Real&gt; varBuffer = <a class="code hl_variable" href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#a0f8e2d83b51826e8559f44450a3bfca2">lambda</a>(grid);</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span> </div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>        vectorSize = varBuffer.size() / grid.nodes.size();</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span> </div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>        <span class="comment">// We need to have vectorSize the same on all ranks, otherwise MPI_COMM_WORLD rank 0 writes a bogus value</span></div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>        MPI_Bcast(&amp;vectorSize, 1, MPI_INT, grid.writingRank, MPI_COMM_WORLD);</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span> </div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>        <span class="keywordflow">if</span>(vlsvWriter.writeArray(<span class="stringliteral">&quot;VARIABLE&quot;</span>, attribs, <span class="stringliteral">&quot;float&quot;</span>, grid.nodes.size(), vectorSize, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>), <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(varBuffer.data())) == <span class="keyword">false</span>) {</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>          <span class="keywordtype">string</span> message = <span class="stringliteral">&quot;The DataReductionOperator &quot;</span> + this-&gt;<a class="code hl_function" href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#a1101a5ac929d6458f505036858f1d87a">getName</a>() + <span class="stringliteral">&quot; failed to write its data.&quot;</span>;</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>          <a class="code hl_function" href="../../d9/df9/common_8cpp.html#a6167b9f510c4eef8b16fa67bf3d5566e">bailout</a>(<span class="keyword">true</span>, message, __FILE__, __LINE__);</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>        }</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>        <span class="comment">// We need to have vectorSize the same on all ranks, otherwise MPI_COMM_WORLD rank 0 writes a bogus value</span></div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>        MPI_Bcast(&amp;vectorSize, 1, MPI_INT, grid.writingRank, MPI_COMM_WORLD);</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span> </div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>        <span class="comment">// Dummy write</span></div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>        vlsvWriter.writeArray(<span class="stringliteral">&quot;VARIABLE&quot;</span>, attribs, <span class="stringliteral">&quot;float&quot;</span>, 0, vectorSize, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>), <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>      }</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span> </div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>   }</div>
</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span> </div>
<div class="foldopen" id="foldopen00337" data-start="{" data-end="}">
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno"><a class="line" href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#aeb057cf741f068054af2b81dced6c12f">  337</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#aeb057cf741f068054af2b81dced6c12f">DataReductionOperatorIonosphereNodeInt::writeIonosphereData</a>(<a class="code hl_struct" href="../../d4/d8d/struct_s_b_c_1_1_spherical_tri_grid.html">SBC::SphericalTriGrid</a>&amp; grid, vlsv::Writer&amp; vlsvWriter) {</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span> </div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>      <span class="comment">// skip ionosphere for inital-grid as it breaks</span></div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d0/dbf/struct_parameters.html#ae493fa7c00c862e1124a85ecb6ea7e19">P::systemWriteName</a>[<a class="code hl_variable" href="../../d0/dbf/struct_parameters.html#ae493fa7c00c862e1124a85ecb6ea7e19">P::systemWriteName</a>.size() - 1] == <span class="stringliteral">&quot;initial-grid&quot;</span>) {</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>         <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>      }</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span> </div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>      <span class="comment">// No point in trying to write anything if there is no ionosphere grid.</span></div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>      <span class="keywordflow">if</span>(grid.nodes.size() == 0) {</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>         <span class="comment">// Note this indicates success, since not writing an empty mesh is quite ok.</span></div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>         <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>      }</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>      std::map&lt;std::string,std::string&gt; attribs;</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>      attribs[<span class="stringliteral">&quot;mesh&quot;</span>]=<span class="stringliteral">&quot;ionosphere&quot;</span>;</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>      attribs[<span class="stringliteral">&quot;name&quot;</span>]=<a class="code hl_variable" href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#a4d3071ee26e3c7988b8e4f50c1401f64">variableName</a>;</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>      attribs[<span class="stringliteral">&quot;centering&quot;</span>]= <span class="stringliteral">&quot;node&quot;</span>; <span class="comment">// &lt;-- this tells visit the variable is node-centered</span></div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>      attribs[<span class="stringliteral">&quot;unit&quot;</span>]=<a class="code hl_variable" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a4ed1e17513da860dde24bfe63cac9119">unit</a>;</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>      attribs[<span class="stringliteral">&quot;unitLaTeX&quot;</span>]=<a class="code hl_variable" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#afe311d7be08842eb5d77c1af2010095d">unitLaTeX</a>;</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>      attribs[<span class="stringliteral">&quot;unitConversion&quot;</span>]=<a class="code hl_variable" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a6007d65b072f39e9a107c88cc127dec7">unitConversion</a>;</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>      attribs[<span class="stringliteral">&quot;variableLaTeX&quot;</span>]=<a class="code hl_variable" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a4a6ff6ab3eb4e17176c247765946b359">variableLaTeX</a>;</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span> </div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>      <span class="comment">// Only task 0 of the ionosphere communicator writes, but all others need to sync vectorSize</span></div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>      <span class="keywordtype">int</span> rank = -1;</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>      <span class="keywordtype">int</span> worldRank = 0;</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>      <span class="keywordflow">if</span>(grid.isCouplingInwards || grid.isCouplingOutwards) {</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>         MPI_Comm_rank(grid.communicator,&amp;rank);</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>      }</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>      MPI_Comm_rank(MPI_COMM_WORLD,&amp;worldRank);</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>      <span class="keywordtype">int</span> vectorSize = 0;</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>      <span class="keywordflow">if</span>(rank == 0) {</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>         std::vector&lt;int&gt; varBuffer = <a class="code hl_variable" href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#a463f0867355fcc9eb7ebc670975b345b">lambda</a>(grid);</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span> </div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>         vectorSize = varBuffer.size() / grid.nodes.size();</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span> </div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>         <span class="comment">// We need to have vectorSize the same on all ranks, otherwise MPI_COMM_WORLD rank 0 writes a bogus value</span></div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>         MPI_Bcast(&amp;vectorSize, 1, MPI_INT, grid.writingRank, MPI_COMM_WORLD);</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span> </div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>         <span class="keywordflow">if</span>(vlsvWriter.writeArray(<span class="stringliteral">&quot;VARIABLE&quot;</span>, attribs, <span class="stringliteral">&quot;int&quot;</span>, grid.nodes.size(), vectorSize, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(varBuffer.data())) == <span class="keyword">false</span>) {</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>            <span class="keywordtype">string</span> message = <span class="stringliteral">&quot;The DataReductionOperator &quot;</span> + this-&gt;<a class="code hl_function" href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#a1904ab3384e807a777d35ffd6f7b155d">getName</a>() + <span class="stringliteral">&quot; failed to write its data.&quot;</span>;</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>            <a class="code hl_function" href="../../d9/df9/common_8cpp.html#a6167b9f510c4eef8b16fa67bf3d5566e">bailout</a>(<span class="keyword">true</span>, message, __FILE__, __LINE__);</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>         }</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>         <span class="comment">// We need to have vectorSize the same on all ranks, otherwise MPI_COMM_WORLD rank 0 writes a bogus value</span></div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>         MPI_Bcast(&amp;vectorSize, 1, MPI_INT, grid.writingRank, MPI_COMM_WORLD);</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span> </div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>         <span class="comment">// Dummy write</span></div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>         vlsvWriter.writeArray(<span class="stringliteral">&quot;VARIABLE&quot;</span>, attribs, <span class="stringliteral">&quot;int&quot;</span>, 0, vectorSize, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>      }</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span> </div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>   }</div>
</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span> </div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno"><a class="line" href="../../d4/d27/class_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell.html#a842401743a6b4b7f18f0e33c614578ef">  389</a></span>   std::string <a class="code hl_function" href="../../d4/d27/class_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell.html#a842401743a6b4b7f18f0e33c614578ef">DataReductionOperatorMPIGridCell::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d4/d27/class_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell.html#aac2029b6995661def0c0665d6dde97af">variableName</a>;}</div>
<div class="foldopen" id="foldopen00390" data-start="{" data-end="}">
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno"><a class="line" href="../../d4/d27/class_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell.html#af38cb676f9de20bacc980269d2be92ec">  390</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d4/d27/class_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell.html#af38cb676f9de20bacc980269d2be92ec">DataReductionOperatorMPIGridCell::getDataVectorInfo</a>(std::string&amp; dataType, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>      dataSize = <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>);</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>      vectorSize = <a class="code hl_variable" href="../../d4/d27/class_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell.html#ade082787d525ad7aea31eb3a2f565e67">numFloats</a>;</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>   }</div>
</div>
<div class="foldopen" id="foldopen00396" data-start="{" data-end="}">
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno"><a class="line" href="../../d4/d27/class_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell.html#ac430d3907fce7d8bd34f7c7e2b42287f">  396</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d4/d27/class_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell.html#ac430d3907fce7d8bd34f7c7e2b42287f">DataReductionOperatorMPIGridCell::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>      std::vector&lt;Real&gt; varBuffer = <a class="code hl_variable" href="../../d4/d27/class_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell.html#a0c74463de50aade2194e4952b6ac74db">lambda</a>(cell);</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span> </div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>      assert(varBuffer.size() == (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)<a class="code hl_variable" href="../../d4/d27/class_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell.html#ade082787d525ad7aea31eb3a2f565e67">numFloats</a>);</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span> </div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>=0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>&lt;<a class="code hl_variable" href="../../d4/d27/class_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell.html#ade082787d525ad7aea31eb3a2f565e67">numFloats</a>; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++) {</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>         buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = varBuffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>      }</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span> </div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>   }</div>
</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span> </div>
<div class="foldopen" id="foldopen00408" data-start="{" data-end="}">
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno"><a class="line" href="../../d8/d46/class_d_r_o_1_1_data_reduction_operator_b_v_o_l_derivatives.html#a184d43f7eabbe63ce043cf7cf523aade">  408</a></span>   <a class="code hl_function" href="../../d8/d46/class_d_r_o_1_1_data_reduction_operator_b_v_o_l_derivatives.html#a184d43f7eabbe63ce043cf7cf523aade">DataReductionOperatorBVOLDerivatives::DataReductionOperatorBVOLDerivatives</a>(<span class="keyword">const</span> std::string&amp; name,<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> parameterIndex,<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a7ed040bcc0f67439fcfbf506aa985cd3">vectorSize</a>):</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>   <a class="code hl_function" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a1bdf365d6ead48011a0220a231e8bced">DataReductionOperatorCellParams</a>(name,parameterIndex,<a class="code hl_variable" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a7ed040bcc0f67439fcfbf506aa985cd3">vectorSize</a>) {</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span> </div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>   }</div>
</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>   <span class="comment">//a version with derivatives, this is the only function that is different</span></div>
<div class="foldopen" id="foldopen00413" data-start="{" data-end="}">
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno"><a class="line" href="../../d8/d46/class_d_r_o_1_1_data_reduction_operator_b_v_o_l_derivatives.html#a8ed699bd920697c276604dde7a68593e">  413</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d8/d46/class_d_r_o_1_1_data_reduction_operator_b_v_o_l_derivatives.html#a8ed699bd920697c276604dde7a68593e">DataReductionOperatorBVOLDerivatives::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>      <a class="code hl_variable" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a13a2940a5b472af0ee678e73823a4327">data</a>  = &amp;(cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ab748ab53cfa53a48978a1ed8b6f16e54">derivativesBVOL</a>[<a class="code hl_variable" href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a4fdec3fbb1461f812ac68904e9dfb042">_parameterIndex</a>]);</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>   }</div>
</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span> </div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span> </div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span> </div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>   <span class="comment">//------------------ total BVOL ---------------------------------------</span></div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno"><a class="line" href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#a6d6b48efa6881b91d664f6e55973de1a">  421</a></span>   <a class="code hl_function" href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#a6d6b48efa6881b91d664f6e55973de1a">VariableBVol::VariableBVol</a>(): <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DataReductionOperator</a>() { }</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno"><a class="line" href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#a85720351528aab235b37a96142084fcf">  422</a></span>   <a class="code hl_function" href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#a85720351528aab235b37a96142084fcf">VariableBVol::~VariableBVol</a>() { }</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span> </div>
<div class="foldopen" id="foldopen00424" data-start="{" data-end="}">
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno"><a class="line" href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#a9bde5c19e6f1c99b1ccef8a95c54a205">  424</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#a9bde5c19e6f1c99b1ccef8a95c54a205">VariableBVol::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>      dataSize =  <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>);</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>      vectorSize = 3;</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>   }</div>
</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span> </div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno"><a class="line" href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#ac53326ababd7b786a467e9e359ea7587">  431</a></span>   std::string <a class="code hl_function" href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#ac53326ababd7b786a467e9e359ea7587">VariableBVol::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <span class="stringliteral">&quot;vg_b_vol&quot;</span>;}</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span> </div>
<div class="foldopen" id="foldopen00433" data-start="{" data-end="}">
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno"><a class="line" href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#a78b1cb0a1fb3eaf19e92a3a4a753f0d9">  433</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#a78b1cb0a1fb3eaf19e92a3a4a753f0d9">VariableBVol::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#aeea1047ee5db36eda3ca9d764a273694">B</a>);</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; 3*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>   }</div>
</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span> </div>
<div class="foldopen" id="foldopen00439" data-start="{" data-end="}">
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno"><a class="line" href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#a5fc41696f8747856047d825e38468eef">  439</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#a5fc41696f8747856047d825e38468eef">VariableBVol::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>      <a class="code hl_variable" href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#aeea1047ee5db36eda3ca9d764a273694">B</a>[0] = cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a50f3584d2fa8255ba2df24d8b01d8a83">CellParams::PERBXVOL</a>] +  cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a0b14dcc916a785f309ca6c122d8acecb">CellParams::BGBXVOL</a>];</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>      <a class="code hl_variable" href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#aeea1047ee5db36eda3ca9d764a273694">B</a>[1] = cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840ac44a0b8ba721d489ba7f5d0e74c592ac">CellParams::PERBYVOL</a>] +  cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840ae5c6d66d7d0c73858a1c8ca46f5952a5">CellParams::BGBYVOL</a>];</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>      <a class="code hl_variable" href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#aeea1047ee5db36eda3ca9d764a273694">B</a>[2] = cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840ad9d470cda28e4d96059ae0a1335552e5">CellParams::PERBZVOL</a>] +  cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a8d84d511a8af5fc3860564fbf862845e">CellParams::BGBZVOL</a>];</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>      <span class="keywordflow">if</span>(!(std::isfinite(<a class="code hl_variable" href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#aeea1047ee5db36eda3ca9d764a273694">B</a>[0]) &amp;&amp; std::isfinite(<a class="code hl_variable" href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#aeea1047ee5db36eda3ca9d764a273694">B</a>[1]) &amp;&amp; std::isfinite(<a class="code hl_variable" href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#aeea1047ee5db36eda3ca9d764a273694">B</a>[2]))) {</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>         <span class="keywordtype">string</span> message = <span class="stringliteral">&quot;The DataReductionOperator &quot;</span> + this-&gt;<a class="code hl_function" href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#ac53326ababd7b786a467e9e359ea7587">getName</a>() + <span class="stringliteral">&quot; returned a nan or an inf.&quot;</span>;</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>         <a class="code hl_function" href="../../d9/df9/common_8cpp.html#a6167b9f510c4eef8b16fa67bf3d5566e">bailout</a>(<span class="keyword">true</span>, message, __FILE__, __LINE__);</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>      }</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>   }</div>
</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span> </div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>   <span class="comment">//MPI rank</span></div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno"><a class="line" href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#a22ca4af2f1648c4f153514b86294f66d">  451</a></span>   <a class="code hl_function" href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#a22ca4af2f1648c4f153514b86294f66d">MPIrank::MPIrank</a>(): <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DataReductionOperator</a>() { }</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno"><a class="line" href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#a66edf7f65fb3212d893bbf40ea79c8b1">  452</a></span>   <a class="code hl_function" href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#a66edf7f65fb3212d893bbf40ea79c8b1">MPIrank::~MPIrank</a>() { }</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span> </div>
<div class="foldopen" id="foldopen00454" data-start="{" data-end="}">
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno"><a class="line" href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#a9093dab4accb71b990e0dcd56645fbf1">  454</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#a9093dab4accb71b990e0dcd56645fbf1">MPIrank::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>      dataType = <span class="stringliteral">&quot;int&quot;</span>;</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>      dataSize = <span class="keyword">sizeof</span>(int);</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>      vectorSize = 1;</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>   }</div>
</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span> </div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno"><a class="line" href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#a9e4da3de3d0fa09a84eb41950a4a31b4">  461</a></span>   std::string <a class="code hl_function" href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#a9e4da3de3d0fa09a84eb41950a4a31b4">MPIrank::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <span class="stringliteral">&quot;vg_rank&quot;</span>;}</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span> </div>
<div class="foldopen" id="foldopen00463" data-start="{" data-end="}">
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno"><a class="line" href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#ae7636f61a3871c2e2ab5c189fa031bc9">  463</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#ae7636f61a3871c2e2ab5c189fa031bc9">MPIrank::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#a454a1fbbb19e0123ddae1d5d640d39db">mpiRank</a>);</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; <span class="keyword">sizeof</span>(int); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>   }</div>
</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span> </div>
<div class="foldopen" id="foldopen00469" data-start="{" data-end="}">
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno"><a class="line" href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#ae4fcfb573466ae5dead8253e0414bea1">  469</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#ae4fcfb573466ae5dead8253e0414bea1">MPIrank::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>      <span class="keywordtype">int</span> intRank;</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>      MPI_Comm_rank(MPI_COMM_WORLD,&amp;intRank);</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>      <a class="code hl_variable" href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#acabf3d55d433c19d082b74781b7eadee">rank</a> = 1.0*intRank;</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>      <a class="code hl_variable" href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#a454a1fbbb19e0123ddae1d5d640d39db">mpiRank</a> = intRank;</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>   }</div>
</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span> </div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>   <span class="comment">// BoundaryType</span></div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno"><a class="line" href="../../d0/d19/class_d_r_o_1_1_boundary_type.html#a4063bc0cbea1c31eefffc1d5319222d6">  478</a></span>   <a class="code hl_function" href="../../d0/d19/class_d_r_o_1_1_boundary_type.html#a4063bc0cbea1c31eefffc1d5319222d6">BoundaryType::BoundaryType</a>(): <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DataReductionOperator</a>() { }</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno"><a class="line" href="../../d0/d19/class_d_r_o_1_1_boundary_type.html#a4c64d55d82c639a6e906885d0ddc91af">  479</a></span>   <a class="code hl_function" href="../../d0/d19/class_d_r_o_1_1_boundary_type.html#a4c64d55d82c639a6e906885d0ddc91af">BoundaryType::~BoundaryType</a>() { }</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span> </div>
<div class="foldopen" id="foldopen00481" data-start="{" data-end="}">
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno"><a class="line" href="../../d0/d19/class_d_r_o_1_1_boundary_type.html#a12844eb2ae0b2d52a22bfe93529047b2">  481</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d0/d19/class_d_r_o_1_1_boundary_type.html#a12844eb2ae0b2d52a22bfe93529047b2">BoundaryType::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>      dataType = <span class="stringliteral">&quot;int&quot;</span>;</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>      dataSize = <span class="keyword">sizeof</span>(int);</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>      vectorSize = 1;</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>   }</div>
</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span> </div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno"><a class="line" href="../../d0/d19/class_d_r_o_1_1_boundary_type.html#a6777577e973086d5df7208e07c8a633f">  488</a></span>   std::string <a class="code hl_function" href="../../d0/d19/class_d_r_o_1_1_boundary_type.html#a6777577e973086d5df7208e07c8a633f">BoundaryType::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <span class="stringliteral">&quot;vg_boundarytype&quot;</span>;}</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span> </div>
<div class="foldopen" id="foldopen00490" data-start="{" data-end="}">
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno"><a class="line" href="../../d0/d19/class_d_r_o_1_1_boundary_type.html#a39026d936d51972bb25aa66a73665db3">  490</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d0/d19/class_d_r_o_1_1_boundary_type.html#a39026d936d51972bb25aa66a73665db3">BoundaryType::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../d0/d19/class_d_r_o_1_1_boundary_type.html#ac372ed619934e86fdf47075060470e68">boundaryType</a>);</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; <span class="keyword">sizeof</span>(int); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>   }</div>
</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span> </div>
<div class="foldopen" id="foldopen00496" data-start="{" data-end="}">
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno"><a class="line" href="../../d0/d19/class_d_r_o_1_1_boundary_type.html#a80af9cd08b7c1e4b4350e6c951cfb441">  496</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d0/d19/class_d_r_o_1_1_boundary_type.html#a80af9cd08b7c1e4b4350e6c951cfb441">BoundaryType::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>      <a class="code hl_variable" href="../../d0/d19/class_d_r_o_1_1_boundary_type.html#ac372ed619934e86fdf47075060470e68">boundaryType</a> = (int)cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad51ae9a217adf8a65c6b316b1959f95d">sysBoundaryFlag</a>;</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>   }</div>
</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span> </div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span> </div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>      <span class="comment">// BoundaryLayer</span></div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno"><a class="line" href="../../dd/d6a/class_d_r_o_1_1_boundary_layer.html#a9ea1e552794124fd7f3d18e4e55b199a">  503</a></span>   <a class="code hl_function" href="../../dd/d6a/class_d_r_o_1_1_boundary_layer.html#a9ea1e552794124fd7f3d18e4e55b199a">BoundaryLayer::BoundaryLayer</a>(): <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DataReductionOperator</a>() { }</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno"><a class="line" href="../../dd/d6a/class_d_r_o_1_1_boundary_layer.html#a2961338ff1d55e306e4dd3a37d2fd62b">  504</a></span>   <a class="code hl_function" href="../../dd/d6a/class_d_r_o_1_1_boundary_layer.html#a2961338ff1d55e306e4dd3a37d2fd62b">BoundaryLayer::~BoundaryLayer</a>() { }</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span> </div>
<div class="foldopen" id="foldopen00506" data-start="{" data-end="}">
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno"><a class="line" href="../../dd/d6a/class_d_r_o_1_1_boundary_layer.html#ae83c57180a5520c2a93af238f5397662">  506</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../dd/d6a/class_d_r_o_1_1_boundary_layer.html#ae83c57180a5520c2a93af238f5397662">BoundaryLayer::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>      dataType = <span class="stringliteral">&quot;int&quot;</span>;</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>      dataSize = <span class="keyword">sizeof</span>(int);</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>      vectorSize = 1;</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>   }</div>
</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span> </div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno"><a class="line" href="../../dd/d6a/class_d_r_o_1_1_boundary_layer.html#a0bcab88f7bde6a4fdda6c69b84d8447d">  513</a></span>   std::string <a class="code hl_function" href="../../dd/d6a/class_d_r_o_1_1_boundary_layer.html#a0bcab88f7bde6a4fdda6c69b84d8447d">BoundaryLayer::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <span class="stringliteral">&quot;vg_boundarylayer&quot;</span>;}</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span> </div>
<div class="foldopen" id="foldopen00515" data-start="{" data-end="}">
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno"><a class="line" href="../../dd/d6a/class_d_r_o_1_1_boundary_layer.html#aa0fe98dc7525bd950c577385352c04da">  515</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../dd/d6a/class_d_r_o_1_1_boundary_layer.html#aa0fe98dc7525bd950c577385352c04da">BoundaryLayer::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../dd/d6a/class_d_r_o_1_1_boundary_layer.html#a83250105c43d994772631b81defd27eb">boundaryLayer</a>);</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; <span class="keyword">sizeof</span>(int); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>   }</div>
</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span> </div>
<div class="foldopen" id="foldopen00521" data-start="{" data-end="}">
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno"><a class="line" href="../../dd/d6a/class_d_r_o_1_1_boundary_layer.html#ad3457c63916d86889ba0e3ef20d4dcf4">  521</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../dd/d6a/class_d_r_o_1_1_boundary_layer.html#ad3457c63916d86889ba0e3ef20d4dcf4">BoundaryLayer::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>      <a class="code hl_variable" href="../../dd/d6a/class_d_r_o_1_1_boundary_layer.html#a83250105c43d994772631b81defd27eb">boundaryLayer</a> = (int)cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a4d5096aa8cc677e97d6e1ff92df7e62e">sysBoundaryLayer</a>;</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>   }</div>
</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span> </div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>   <span class="comment">// Blocks</span></div>
<div class="foldopen" id="foldopen00527" data-start="{" data-end="}">
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno"><a class="line" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a391685268c5cbd962e5a223a7669e995">  527</a></span>   <a class="code hl_function" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a391685268c5cbd962e5a223a7669e995">Blocks::Blocks</a>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> _popID): <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DataReductionOperator</a>(),<a class="code hl_variable" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a2e8c2ed9994775c41394f50642111ccf">popID</a>(_popID) {</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>      <a class="code hl_variable" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a5d9e565132dc6ef7313f3f80b3f98170">popName</a>=<a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a2e8c2ed9994775c41394f50642111ccf">popID</a>].name;</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>   }</div>
</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno"><a class="line" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a3cc8adfc76d5294e756cfb629a1cd5ac">  530</a></span>   <a class="code hl_function" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a3cc8adfc76d5294e756cfb629a1cd5ac">Blocks::~Blocks</a>() { }</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span> </div>
<div class="foldopen" id="foldopen00532" data-start="{" data-end="}">
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno"><a class="line" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a69f39ab1719cdce2288e97a4067e4985">  532</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a69f39ab1719cdce2288e97a4067e4985">Blocks::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>      dataType = <span class="stringliteral">&quot;uint&quot;</span>;</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>      dataSize = <span class="keyword">sizeof</span>(int);</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>      vectorSize = 1;</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>   }</div>
</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span> </div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno"><a class="line" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a63069e1c883d1f2b6e337028848afdf9">  539</a></span>   std::string <a class="code hl_function" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a63069e1c883d1f2b6e337028848afdf9">Blocks::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a5d9e565132dc6ef7313f3f80b3f98170">popName</a> + <span class="stringliteral">&quot;/vg_blocks&quot;</span>;}</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span> </div>
<div class="foldopen" id="foldopen00541" data-start="{" data-end="}">
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno"><a class="line" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a19bf681aa623db7b4671f8f24295517e">  541</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a19bf681aa623db7b4671f8f24295517e">Blocks::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a61792a99b05a5b243909d20f72b70ecc">nBlocks</a>);</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; <span class="keyword">sizeof</span>(int); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>   }</div>
</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span> </div>
<div class="foldopen" id="foldopen00547" data-start="{" data-end="}">
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno"><a class="line" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a6aa12046d3164f336d5443b6b3531e16">  547</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a6aa12046d3164f336d5443b6b3531e16">Blocks::reduceDiagnostic</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>* buffer) {</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>      *buffer = 1.0 * <a class="code hl_variable" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a61792a99b05a5b243909d20f72b70ecc">nBlocks</a>;</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>   }</div>
</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span> </div>
<div class="foldopen" id="foldopen00552" data-start="{" data-end="}">
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno"><a class="line" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a5465be6d6e9d3a104707273f47373b3a">  552</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a5465be6d6e9d3a104707273f47373b3a">Blocks::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>      <a class="code hl_variable" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a61792a99b05a5b243909d20f72b70ecc">nBlocks</a> = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(<a class="code hl_variable" href="../../d3/d01/class_d_r_o_1_1_blocks.html#a2e8c2ed9994775c41394f50642111ccf">popID</a>);</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>   }</div>
</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span> </div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>   <span class="comment">// Scalar pressure from the stored values which were calculated to be used by the solvers</span></div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno"><a class="line" href="../../d6/d9e/class_d_r_o_1_1_variable_pressure_solver.html#ab131be4b23ca54d7f5709b40788f2d2d">  558</a></span>   <a class="code hl_function" href="../../d6/d9e/class_d_r_o_1_1_variable_pressure_solver.html#ab131be4b23ca54d7f5709b40788f2d2d">VariablePressureSolver::VariablePressureSolver</a>(): <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DataReductionOperator</a>() { }</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno"><a class="line" href="../../d6/d9e/class_d_r_o_1_1_variable_pressure_solver.html#aa5d843947ebd793a98c953207f0bbaa6">  559</a></span>   <a class="code hl_function" href="../../d6/d9e/class_d_r_o_1_1_variable_pressure_solver.html#aa5d843947ebd793a98c953207f0bbaa6">VariablePressureSolver::~VariablePressureSolver</a>() { }</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span> </div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno"><a class="line" href="../../d6/d9e/class_d_r_o_1_1_variable_pressure_solver.html#aa061cccab2f075d9721d828dd3b880b8">  561</a></span>   std::string <a class="code hl_function" href="../../d6/d9e/class_d_r_o_1_1_variable_pressure_solver.html#aa061cccab2f075d9721d828dd3b880b8">VariablePressureSolver::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <span class="stringliteral">&quot;vg_pressure&quot;</span>;}</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span> </div>
<div class="foldopen" id="foldopen00563" data-start="{" data-end="}">
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno"><a class="line" href="../../d6/d9e/class_d_r_o_1_1_variable_pressure_solver.html#aeffd3a116a0fb33af0ae324a4fb8b4d0">  563</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d6/d9e/class_d_r_o_1_1_variable_pressure_solver.html#aeffd3a116a0fb33af0ae324a4fb8b4d0">VariablePressureSolver::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>      dataSize =  <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>);</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>      vectorSize = 1;</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>   }</div>
</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span> </div>
<div class="foldopen" id="foldopen00570" data-start="{" data-end="}">
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno"><a class="line" href="../../d6/d9e/class_d_r_o_1_1_variable_pressure_solver.html#acb54d09fcbacc03be938d4653aef5b7f">  570</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d6/d9e/class_d_r_o_1_1_variable_pressure_solver.html#acb54d09fcbacc03be938d4653aef5b7f">VariablePressureSolver::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../d6/d9e/class_d_r_o_1_1_variable_pressure_solver.html#ab8a6bb2206bfac9513ae40ea18e3302b">Pressure</a>);</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>   }</div>
</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span> </div>
<div class="foldopen" id="foldopen00576" data-start="{" data-end="}">
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno"><a class="line" href="../../d6/d9e/class_d_r_o_1_1_variable_pressure_solver.html#acbb88158769b837d3af825a6f40b55c3">  576</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d6/d9e/class_d_r_o_1_1_variable_pressure_solver.html#acbb88158769b837d3af825a6f40b55c3">VariablePressureSolver::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>      <a class="code hl_variable" href="../../d6/d9e/class_d_r_o_1_1_variable_pressure_solver.html#ab8a6bb2206bfac9513ae40ea18e3302b">Pressure</a> = 1.0/3.0 * (cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a1512b1251b929440b04528c5ba06f6f9">CellParams::P_11</a>] + cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a80b0754b2b9b26ada32cb7e7ea3835d4">CellParams::P_22</a>] + cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a228714562c2cdc3ad2e73659046a8efa">CellParams::P_33</a>]);</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>   }</div>
</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span> </div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>   <span class="comment">// YK Adding pressure calculations to Vlasiator.</span></div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>   <span class="comment">// p_ij = m/3 * integral((v - &lt;V&gt;)_i(v - &lt;V&gt;)_j * f(r,v) dV)</span></div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span> </div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>   <span class="comment">// Pressure tensor 6 components (11, 22, 33, 23, 13, 12) added by YK</span></div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>   <span class="comment">// Split into VariablePTensorDiagonal (11, 22, 33)</span></div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>   <span class="comment">// and VariablePTensorOffDiagonal (23, 13, 12)</span></div>
<div class="foldopen" id="foldopen00587" data-start="{" data-end="}">
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno"><a class="line" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#af5a8f2f47daf18177a8d0822cfc18bc3">  587</a></span>   <a class="code hl_function" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#af5a8f2f47daf18177a8d0822cfc18bc3">VariablePTensorDiagonal::VariablePTensorDiagonal</a>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> _popID): <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DataReductionOperator</a>(),<a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a576feac0afcf3d416ccd684d46da7f8d">popID</a>(_popID) {</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>      <a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a36656ec9d41a50f7a9c3d795438a2f1d">popName</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a576feac0afcf3d416ccd684d46da7f8d">popID</a>].name;</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>   }</div>
</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno"><a class="line" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a577f183622516a1ad3f96cc7421821fc">  590</a></span>   <a class="code hl_function" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a577f183622516a1ad3f96cc7421821fc">VariablePTensorDiagonal::~VariablePTensorDiagonal</a>() { }</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span> </div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno"><a class="line" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a49ffb829d7478815c3c65e5600a45bd4">  592</a></span>   std::string <a class="code hl_function" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a49ffb829d7478815c3c65e5600a45bd4">VariablePTensorDiagonal::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a36656ec9d41a50f7a9c3d795438a2f1d">popName</a> + <span class="stringliteral">&quot;/vg_ptensor_diagonal&quot;</span>;}</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span> </div>
<div class="foldopen" id="foldopen00594" data-start="{" data-end="}">
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno"><a class="line" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a3b4f8f038178eb30e30aa0232bb374ab">  594</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a3b4f8f038178eb30e30aa0232bb374ab">VariablePTensorDiagonal::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>      dataSize =  <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>);</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>      vectorSize = 3;</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>   }</div>
</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span> </div>
<div class="foldopen" id="foldopen00601" data-start="{" data-end="}">
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno"><a class="line" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#ad1a2db2e02752d3b2692ae3dd7e88cef">  601</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#ad1a2db2e02752d3b2692ae3dd7e88cef">VariablePTensorDiagonal::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span> </div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span><span class="preprocessor">      #ifdef USE_GPU</span></div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ae0f93c317e351510eeaeaf8a57bf3f79">dev_get_velocity_blocks</a>(<a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a576feac0afcf3d416ccd684d46da7f8d">popID</a>);</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span><span class="preprocessor">      #else</span></div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a1dc25bb724906fa5d6dd76096cb7b9a4">get_velocity_blocks</a>(<a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a576feac0afcf3d416ccd684d46da7f8d">popID</a>);</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span><span class="preprocessor">      #endif</span></div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a> = 0.5;</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>      <span class="comment">// ARCH interface includes OpenMP looping including critical regions for thread summation</span></div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>      {</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> sum[3] = {0.0, 0.0, 0.0};</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#aa15257d3bb97e6324d14208620f088ce">averageVX</a> = this-&gt;averageVX, <a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a5f8c127b61116e821e5ea39e03608116">averageVY</a> = this-&gt;averageVY, <a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a859f532973b32c3d2f56bb8256395e2c">averageVZ</a> = this-&gt;averageVZ;</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span> </div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>         <span class="keywordflow">if</span> (cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(<a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a576feac0afcf3d416ccd684d46da7f8d">popID</a>) != 0)</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>         <a class="code hl_function" href="../../d9/d6a/namespacearch.html#a8b44f7f5126702d29110d539cdfbd7e8">arch::parallel_reduce&lt;arch::sum&gt;</a>({<a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, (uint)cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(<a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a576feac0afcf3d416ccd684d46da7f8d">popID</a>)},</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>                                          <a class="code hl_define" href="../../db/d79/arch__device__cuda_8h.html#abeccfbc804a98c6b06b7fc99c71dac5d">ARCH_LOOP_LAMBDA</a>(<span class="keyword">const</span> uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>, <span class="keyword">const</span> uint n, <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *lsum ){</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span> </div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a6760bdacc1d8a5bb4c1a42e1103f0064">Realf</a> *block_data = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab577ace09cdc66074a7cdc3d79394cfb">getData</a>(n);</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *block_parameters = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab492eded4908cb97927ddc54a0f3d9d3">getParameters</a>(n);</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856ace98fdb03651c50d1123499280fcb7ba">BlockParams::VXCRD</a>] + (<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>];</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856addc5022ec6d36b0fc9a73d025cc14485">BlockParams::VYCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>];</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aa4ae61e72bc15b4114a74faad6e64b07">BlockParams::VZCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> DV3 = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>]</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>                                                * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>] * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span> </div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>                                             lsum[0] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> - <a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#aa15257d3bb97e6324d14208620f088ce">averageVX</a>) * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> - <a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#aa15257d3bb97e6324d14208620f088ce">averageVX</a>) * DV3;</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>                                             lsum[1] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> - <a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a5f8c127b61116e821e5ea39e03608116">averageVY</a>) * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> - <a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a5f8c127b61116e821e5ea39e03608116">averageVY</a>) * DV3;</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>                                             lsum[2] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> - <a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a859f532973b32c3d2f56bb8256395e2c">averageVZ</a>) * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> - <a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a859f532973b32c3d2f56bb8256395e2c">averageVZ</a>) * DV3;</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>                                          }, sum);</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span> </div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>         <a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a256bc92ab8e6737cca2b70dc81708700">PTensor</a>[0] = sum[0] * <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a576feac0afcf3d416ccd684d46da7f8d">popID</a>].mass;</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>         <a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a256bc92ab8e6737cca2b70dc81708700">PTensor</a>[1] = sum[1] * <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a576feac0afcf3d416ccd684d46da7f8d">popID</a>].mass;</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>         <a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a256bc92ab8e6737cca2b70dc81708700">PTensor</a>[2] = sum[2] * <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a576feac0afcf3d416ccd684d46da7f8d">popID</a>].mass;</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>      }</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span> </div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a256bc92ab8e6737cca2b70dc81708700">PTensor</a>);</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; 3*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>   }</div>
</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span> </div>
<div class="foldopen" id="foldopen00641" data-start="{" data-end="}">
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno"><a class="line" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a1a2f574e6c0979aa8816694f509fb305">  641</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a1a2f574e6c0979aa8816694f509fb305">VariablePTensorDiagonal::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>      <a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#aa15257d3bb97e6324d14208620f088ce">averageVX</a> = cell-&gt; parameters[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a75e41e45c0e401d091dad2e29dde4909">CellParams::VX</a>];</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>      <a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a5f8c127b61116e821e5ea39e03608116">averageVY</a> = cell-&gt; parameters[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840af916b65768e628165d616adb69c30441">CellParams::VY</a>];</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>      <a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a859f532973b32c3d2f56bb8256395e2c">averageVZ</a> = cell-&gt; parameters[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a2de546e2cd563cbb4d339f823c28fc7f">CellParams::VZ</a>];</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; 3; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++) {</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>         <a class="code hl_variable" href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a256bc92ab8e6737cca2b70dc81708700">PTensor</a>[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = 0.0;</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>      }</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>   }</div>
</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span> </div>
<div class="foldopen" id="foldopen00651" data-start="{" data-end="}">
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno"><a class="line" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a44319ec8f1d10c2c52563dac5c643fc1">  651</a></span>   <a class="code hl_function" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a44319ec8f1d10c2c52563dac5c643fc1">VariablePTensorOffDiagonal::VariablePTensorOffDiagonal</a>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> _popID): <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DataReductionOperator</a>(),<a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a57dd22bbfbd474a4f51db129981e2901">popID</a>(_popID) {</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>      <a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#af51d0b0cbf9d05243c6612aba1b77319">popName</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a57dd22bbfbd474a4f51db129981e2901">popID</a>].name;</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>   }</div>
</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno"><a class="line" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a51844b71a2319e2975b315423310afed">  654</a></span>   <a class="code hl_function" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a51844b71a2319e2975b315423310afed">VariablePTensorOffDiagonal::~VariablePTensorOffDiagonal</a>() { }</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span> </div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno"><a class="line" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#ac575804d5b7d1f3872b89306314c2c8e">  656</a></span>   std::string <a class="code hl_function" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#ac575804d5b7d1f3872b89306314c2c8e">VariablePTensorOffDiagonal::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#af51d0b0cbf9d05243c6612aba1b77319">popName</a> + <span class="stringliteral">&quot;/vg_ptensor_offdiagonal&quot;</span>;}</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span> </div>
<div class="foldopen" id="foldopen00658" data-start="{" data-end="}">
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno"><a class="line" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#af75174b28e1d77cbc477fb188a40f781">  658</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#af75174b28e1d77cbc477fb188a40f781">VariablePTensorOffDiagonal::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>      dataSize =  <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>);</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>      vectorSize = 3;</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>   }</div>
</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span> </div>
<div class="foldopen" id="foldopen00665" data-start="{" data-end="}">
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno"><a class="line" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a0581e11beeca2b0ce1ca359aa043e13e">  665</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a0581e11beeca2b0ce1ca359aa043e13e">VariablePTensorOffDiagonal::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span><span class="preprocessor">      #ifdef USE_GPU</span></div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ae0f93c317e351510eeaeaf8a57bf3f79">dev_get_velocity_blocks</a>(<a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a57dd22bbfbd474a4f51db129981e2901">popID</a>);</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span><span class="preprocessor">      #else</span></div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a1dc25bb724906fa5d6dd76096cb7b9a4">get_velocity_blocks</a>(<a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a57dd22bbfbd474a4f51db129981e2901">popID</a>);</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span><span class="preprocessor">      #endif</span></div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a> = 0.5;</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>      <span class="comment">// ARCH interface includes OpenMP looping including critical regions for thread summation</span></div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>      {</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> sum[3] = {0.0, 0.0, 0.0};</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#ae7b6c008f6f7ee3ffaaa049132ae0a35">averageVX</a> = this-&gt;averageVX, <a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#afc53c9d4596f525ce7731657fed7377a">averageVY</a> = this-&gt;averageVY, <a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#afa2cb559da09b99f49d0b444bb3855a2">averageVZ</a> = this-&gt;averageVZ;</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span> </div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>         <span class="keywordflow">if</span> (cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(<a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a57dd22bbfbd474a4f51db129981e2901">popID</a>) != 0)</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>         <a class="code hl_function" href="../../d9/d6a/namespacearch.html#a8b44f7f5126702d29110d539cdfbd7e8">arch::parallel_reduce&lt;arch::sum&gt;</a>({<a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, (uint)cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(<a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a57dd22bbfbd474a4f51db129981e2901">popID</a>)},</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>                                          <a class="code hl_define" href="../../db/d79/arch__device__cuda_8h.html#abeccfbc804a98c6b06b7fc99c71dac5d">ARCH_LOOP_LAMBDA</a>(<span class="keyword">const</span> uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>, <span class="keyword">const</span> uint n, <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *lsum ) {</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span> </div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a6760bdacc1d8a5bb4c1a42e1103f0064">Realf</a> *block_data = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab577ace09cdc66074a7cdc3d79394cfb">getData</a>(n);</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *block_parameters = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab492eded4908cb97927ddc54a0f3d9d3">getParameters</a>(n);</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856ace98fdb03651c50d1123499280fcb7ba">BlockParams::VXCRD</a>] + (<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>];</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856addc5022ec6d36b0fc9a73d025cc14485">BlockParams::VYCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>];</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aa4ae61e72bc15b4114a74faad6e64b07">BlockParams::VZCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> DV3 = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>]</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>                                                * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>] * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span> </div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>                                             lsum[0] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> - <a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#ae7b6c008f6f7ee3ffaaa049132ae0a35">averageVX</a>) * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> - <a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#afc53c9d4596f525ce7731657fed7377a">averageVY</a>) * DV3;</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>                                             lsum[1] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> - <a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#afa2cb559da09b99f49d0b444bb3855a2">averageVZ</a>) * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> - <a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#ae7b6c008f6f7ee3ffaaa049132ae0a35">averageVX</a>) * DV3;</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>                                             lsum[2] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> - <a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#afc53c9d4596f525ce7731657fed7377a">averageVY</a>) * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> - <a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#afa2cb559da09b99f49d0b444bb3855a2">averageVZ</a>) * DV3;</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>                                          }, sum);</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span> </div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>         <a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a5f2e0b86241ee62adee64ca874e70749">PTensor</a>[0] = sum[0] * <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a57dd22bbfbd474a4f51db129981e2901">popID</a>].mass;</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>         <a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a5f2e0b86241ee62adee64ca874e70749">PTensor</a>[1] = sum[1] * <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a57dd22bbfbd474a4f51db129981e2901">popID</a>].mass;</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>         <a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a5f2e0b86241ee62adee64ca874e70749">PTensor</a>[2] = sum[2] * <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a57dd22bbfbd474a4f51db129981e2901">popID</a>].mass;</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span> </div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>      }</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a5f2e0b86241ee62adee64ca874e70749">PTensor</a>);</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; 3*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>   }</div>
</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span> </div>
<div class="foldopen" id="foldopen00704" data-start="{" data-end="}">
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno"><a class="line" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a5b14d5cd348e69987e08315df544865d">  704</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a5b14d5cd348e69987e08315df544865d">VariablePTensorOffDiagonal::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>      <a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#ae7b6c008f6f7ee3ffaaa049132ae0a35">averageVX</a> = cell-&gt; parameters[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a75e41e45c0e401d091dad2e29dde4909">CellParams::VX</a>];</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>      <a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#afc53c9d4596f525ce7731657fed7377a">averageVY</a> = cell-&gt; parameters[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840af916b65768e628165d616adb69c30441">CellParams::VY</a>];</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>      <a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#afa2cb559da09b99f49d0b444bb3855a2">averageVZ</a> = cell-&gt; parameters[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a2de546e2cd563cbb4d339f823c28fc7f">CellParams::VZ</a>];</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; 3; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++) {</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>         <a class="code hl_variable" href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a5f2e0b86241ee62adee64ca874e70749">PTensor</a>[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = 0.0;</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>      }</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>   }</div>
</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span> </div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span><span class="comment">  /********</span></div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span><span class="comment">      Next level of helper functions - these include threading and calculate zeroth or first velocity moments or the</span></div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span><span class="comment">      diagonal / off-diagonal pressure tensor components for</span></div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span><span class="comment">      thermal or non-thermal populations  ********/</span></div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span> </div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>   <span class="comment">//Calculates rho thermal or rho non-thermal</span></div>
<div class="foldopen" id="foldopen00720" data-start="{" data-end="}">
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno"><a class="line" href="../../db/d48/namespace_d_r_o.html#aee822912aab9606485c338aef20c84dc">  720</a></span>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="../../db/d48/namespace_d_r_o.html#aee822912aab9606485c338aef20c84dc">rhoNonthermalCalculation</a>( <span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a> * cell, <span class="keyword">const</span> <span class="keywordtype">bool</span> calculateNonthermal, <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> popID, <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> &amp; rho ) {</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#add503fc20115bd5669fb3e0fe4fd344f">creal</a> <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a> = 0.5;</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#add503fc20115bd5669fb3e0fe4fd344f">creal</a> thermalRadius = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[popID].thermalRadius;</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>      <span class="keyword">const</span> std::array&lt;Real, 3&gt; thermalV = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[popID].thermalV;</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span> </div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span><span class="preprocessor">      #ifdef USE_GPU</span></div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ae0f93c317e351510eeaeaf8a57bf3f79">dev_get_velocity_blocks</a>(popID);</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span><span class="preprocessor">      #else</span></div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a1dc25bb724906fa5d6dd76096cb7b9a4">get_velocity_blocks</a>(popID);</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span><span class="preprocessor">      #endif</span></div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span> </div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>      <span class="comment">// ARCH interface includes OpenMP looping including critical regions for thread summation</span></div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>      {</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> thread_n_sum = 0.0;</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> thermalV0 = thermalV[0];</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> thermalV1 = thermalV[1];</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> thermalV2 = thermalV[2];</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span> </div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>         <span class="keywordflow">if</span> (cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(popID) != 0)</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>         <a class="code hl_function" href="../../d9/d6a/namespacearch.html#a8b44f7f5126702d29110d539cdfbd7e8">arch::parallel_reduce&lt;arch::sum&gt;</a>({<a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, (uint)cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(popID)},</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>                                          <a class="code hl_define" href="../../db/d79/arch__device__cuda_8h.html#abeccfbc804a98c6b06b7fc99c71dac5d">ARCH_LOOP_LAMBDA</a> (<span class="keyword">const</span> uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>, <span class="keyword">const</span> uint n, <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *lsum ) {</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span> </div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a6760bdacc1d8a5bb4c1a42e1103f0064">Realf</a> *block_data = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab577ace09cdc66074a7cdc3d79394cfb">getData</a>(n);</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *block_parameters = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab492eded4908cb97927ddc54a0f3d9d3">getParameters</a>(n);</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> DV3 = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>] * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>] *  block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span> </div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>                                             <span class="comment">// Go through every velocity cell (i, j, k are indices)</span></div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>                                             <a class="code hl_define" href="../../dc/d9d/arch__device__api_8h.html#acf97310a30e30277ebe000e7e4ab6f53">ARCH_INNER_BODY</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>, n, lsum) {</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>                                                <span class="comment">// Get the vx, vy, vz coordinates of the velocity cell</span></div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>                                                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856ace98fdb03651c50d1123499280fcb7ba">BlockParams::VXCRD</a>] + (<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>) * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>];</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>                                                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856addc5022ec6d36b0fc9a73d025cc14485">BlockParams::VYCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>) * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>];</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>                                                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aa4ae61e72bc15b4114a74faad6e64b07">BlockParams::VZCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>) * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>                                                <span class="comment">// Compare the distance of the velocity cell from the center of the maxwellian distribution to the radius of the maxwellian distribution</span></div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>                                                <span class="keywordflow">if</span> (((calculateNonthermal == <span class="keyword">true</span>) &amp;&amp;</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>                                                     (( (thermalV0 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a>) * (thermalV0 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a>)</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>                                                        + (thermalV1 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a>) * (thermalV1 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a>)</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>                                                        + (thermalV2 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>) * (thermalV2 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>) )</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>                                                      &gt; thermalRadius*thermalRadius))</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>                                                     ||</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>                                                     ((calculateNonthermal == <span class="keyword">false</span>) &amp;&amp;</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>                                                      (( (thermalV0 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a>) * (thermalV0 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a>)</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>                                                         + (thermalV1 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a>) * (thermalV1 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a>)</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>                                                         + (thermalV2 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>) * (thermalV2 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>) )</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>                                                       &lt;= thermalRadius*thermalRadius) )) {</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>                                                   <span class="comment">//The velocity cell is a part of the nonthermal/thermal population:</span></div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>                                                   lsum[0] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * DV3;</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>                                                }</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>                                             };</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>                                          }, thread_n_sum);</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>         rho = thread_n_sum;</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>      }</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>   }</div>
</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span> </div>
<div class="foldopen" id="foldopen00774" data-start="{" data-end="}">
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno"><a class="line" href="../../db/d48/namespace_d_r_o.html#a4665b4ea30292022d8c8d81b83e6813f">  774</a></span>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="../../db/d48/namespace_d_r_o.html#a4665b4ea30292022d8c8d81b83e6813f">VNonthermalCalculation</a>( <span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a> * cell, <span class="keyword">const</span> <span class="keywordtype">bool</span> calculateNonthermal, <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> popID, <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> * <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a> ) {</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#add503fc20115bd5669fb3e0fe4fd344f">creal</a> <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a> = 0.5;</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>      <span class="keyword">const</span> std::array&lt;Real, 3&gt; thermalV = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[popID].thermalV;</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#add503fc20115bd5669fb3e0fe4fd344f">creal</a> thermalRadius = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[popID].thermalRadius;</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span> </div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>      <span class="comment">// Make sure the V is initialized</span></div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>      <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[0] = 0;</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>      <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[1] = 0;</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>      <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[2] = 0;</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> n_sum = 0;</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span> </div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span><span class="preprocessor">      #ifdef USE_GPU</span></div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ae0f93c317e351510eeaeaf8a57bf3f79">dev_get_velocity_blocks</a>(popID);</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span><span class="preprocessor">      #else</span></div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a1dc25bb724906fa5d6dd76096cb7b9a4">get_velocity_blocks</a>(popID);</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span><span class="preprocessor">      #endif</span></div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span> </div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>      <span class="comment">// ARCH interface includes OpenMP looping including critical regions for thread summation</span></div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>      {</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span> </div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> sum[4] = {0};</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> thermalV0 = thermalV[0];</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> thermalV1 = thermalV[1];</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> thermalV2 = thermalV[2];</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span> </div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>         <span class="keywordflow">if</span> (cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(popID) != 0)</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>         <a class="code hl_function" href="../../d9/d6a/namespacearch.html#a8b44f7f5126702d29110d539cdfbd7e8">arch::parallel_reduce&lt;arch::sum&gt;</a>({<a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, (uint)cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(popID)},</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>                                          <a class="code hl_define" href="../../db/d79/arch__device__cuda_8h.html#abeccfbc804a98c6b06b7fc99c71dac5d">ARCH_LOOP_LAMBDA</a> (<span class="keyword">const</span> uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>, <span class="keyword">const</span> uint n, <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *lsum ) {</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span> </div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a6760bdacc1d8a5bb4c1a42e1103f0064">Realf</a> *block_data = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab577ace09cdc66074a7cdc3d79394cfb">getData</a>(n);</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *block_parameters = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab492eded4908cb97927ddc54a0f3d9d3">getParameters</a>(n);</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>                                             <span class="comment">// Get the volume of a velocity cell</span></div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> DV3 = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>] * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>] * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span> </div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>                                             <span class="comment">// Go through a block&#39;s every velocity cell</span></div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>                                             <a class="code hl_define" href="../../dc/d9d/arch__device__api_8h.html#acf97310a30e30277ebe000e7e4ab6f53">ARCH_INNER_BODY</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>, n, lsum) {</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>                                                <span class="comment">// Get the coordinates of the velocity cell (e.g. VX = block_vx_min_coordinates + (velocity_cell_indice_x+0.5)*length_of_velocity_cell_in_x_direction</span></div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>                                                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856ace98fdb03651c50d1123499280fcb7ba">BlockParams::VXCRD</a>] + (<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>) * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>];</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>                                                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856addc5022ec6d36b0fc9a73d025cc14485">BlockParams::VYCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>) * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>];</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>                                                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aa4ae61e72bc15b4114a74faad6e64b07">BlockParams::VZCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>) * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>                                                <span class="comment">// Calculate the distance of the velocity cell from the center of the maxwellian distribution and compare it to the approximate radius of the maxwellian distribution</span></div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>                                                <span class="keywordflow">if</span> (((calculateNonthermal == <span class="keyword">true</span>) &amp;&amp;</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>                                                     (( (thermalV0 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a>) * (thermalV0 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a>)</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>                                                        + (thermalV1 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a>) * (thermalV1 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a>)</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>                                                        + (thermalV2 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>) * (thermalV2 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>) )</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>                                                      &gt; thermalRadius*thermalRadius))</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>                                                   ||</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>                                                    ((calculateNonthermal == <span class="keyword">false</span>) &amp;&amp;</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>                                                     (( (thermalV0 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a>) * (thermalV0 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a>)</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>                                                        + (thermalV1 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a>) * (thermalV1 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a>)</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>                                                        + (thermalV2 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>) * (thermalV2 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>) )</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>                                                      &lt;= thermalRadius*thermalRadius) )) {</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>                                                   <span class="comment">// Add the value of the coordinates and multiply by the AVGS value of the velocity cell and the volume of the velocity cell</span></div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>                                                   lsum[0] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)]*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a>*DV3;</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>                                                   lsum[1] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)]*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a>*DV3;</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>                                                   lsum[2] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)]*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>*DV3;</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>                                                   lsum[3] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)]*DV3;</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>                                                }</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>                                             };</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>                                          }, sum);</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span> </div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>         <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[0] = sum[0];</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>         <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[1] = sum[1];</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>         <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[2] = sum[2];</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>         n_sum = sum[3];</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>      }</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span> </div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>      <span class="comment">// Finally, divide n_sum*V by V.</span></div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>      <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[0]/=n_sum;</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>      <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[1]/=n_sum;</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>      <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[2]/=n_sum;</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span> </div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>   }</div>
</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span> </div>
<div class="foldopen" id="foldopen00849" data-start="{" data-end="}">
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno"><a class="line" href="../../db/d48/namespace_d_r_o.html#a52d86cee7ef279930db199747125a464">  849</a></span>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="../../db/d48/namespace_d_r_o.html#a52d86cee7ef279930db199747125a464">PTensorDiagonalNonthermalCalculations</a>( <span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a> * cell,</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>                                                      <span class="keyword">const</span> <span class="keywordtype">bool</span> calculateNonthermal,</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>                                                      <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> averageVX,</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>                                                      <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> averageVY,</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>                                                      <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> averageVZ,</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>                                                      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> popID,</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>                                                      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> * PTensor ) {</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#add503fc20115bd5669fb3e0fe4fd344f">creal</a> <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a> = 0.5;</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>      <span class="keyword">const</span> std::array&lt;Real, 3&gt; thermalV = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[popID].thermalV;</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#add503fc20115bd5669fb3e0fe4fd344f">creal</a> thermalRadius = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[popID].thermalRadius;</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span> </div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span><span class="preprocessor">      #ifdef USE_GPU</span></div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ae0f93c317e351510eeaeaf8a57bf3f79">dev_get_velocity_blocks</a>(popID);</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span><span class="preprocessor">      #else</span></div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a1dc25bb724906fa5d6dd76096cb7b9a4">get_velocity_blocks</a>(popID);</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span><span class="preprocessor">      #endif</span></div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span> </div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>      <span class="comment">// ARCH interface includes OpenMP looping including critical regions for thread summation</span></div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>      {</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> sum[3] = {0};</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> thermalV0 = thermalV[0];</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> thermalV1 = thermalV[1];</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> thermalV2 = thermalV[2];</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span> </div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>         <span class="keywordflow">if</span> (cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(popID) != 0)</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>         <a class="code hl_function" href="../../d9/d6a/namespacearch.html#a8b44f7f5126702d29110d539cdfbd7e8">arch::parallel_reduce&lt;arch::sum&gt;</a>({<a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, (uint)cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(popID)},</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>                                          <a class="code hl_define" href="../../db/d79/arch__device__cuda_8h.html#abeccfbc804a98c6b06b7fc99c71dac5d">ARCH_LOOP_LAMBDA</a> (<span class="keyword">const</span> uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>, <span class="keyword">const</span> uint n, <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *lsum ) {</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span> </div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a6760bdacc1d8a5bb4c1a42e1103f0064">Realf</a> *block_data = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab577ace09cdc66074a7cdc3d79394cfb">getData</a>(n);</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *block_parameters = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab492eded4908cb97927ddc54a0f3d9d3">getParameters</a>(n);</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>                                             <span class="comment">// Get the volume of a velocity cell</span></div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> DV3 = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>] * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>] * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span> </div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>                                             <a class="code hl_define" href="../../dc/d9d/arch__device__api_8h.html#acf97310a30e30277ebe000e7e4ab6f53">ARCH_INNER_BODY</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>, n, lsum) {</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>                                                <span class="comment">// Get the coordinates of the velocity cell (e.g. VX = block_vx_min_coordinates + (velocity_cell_indice_x+0.5)*length_of_velocity_cell_in_x_direction</span></div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>                                                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856ace98fdb03651c50d1123499280fcb7ba">BlockParams::VXCRD</a>] + (<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>) * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>];</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>                                                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856addc5022ec6d36b0fc9a73d025cc14485">BlockParams::VYCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>) * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>];</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>                                                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aa4ae61e72bc15b4114a74faad6e64b07">BlockParams::VZCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>) * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>                                                <span class="comment">// Calculate the distance of the velocity cell from the center of the maxwellian distribution and compare it to the approximate radius of the maxwellian distribution</span></div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>                                                <span class="keywordflow">if</span> (((calculateNonthermal == <span class="keyword">true</span>) &amp;&amp;</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>                                                     (( (thermalV0 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a>) * (thermalV0 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a>)</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>                                                        + (thermalV1 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a>) * (thermalV1 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a>)</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>                                                        + (thermalV2 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>) * (thermalV2 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>) )</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>                                                      &gt; thermalRadius*thermalRadius))</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>                                                    ||</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>                                                    ((calculateNonthermal == <span class="keyword">false</span>) &amp;&amp;</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>                                                     (( (thermalV0 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a>) * (thermalV0 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a>)</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>                                                        + (thermalV1 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a>) * (thermalV1 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a>)</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>                                                        + (thermalV2 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>) * (thermalV2 - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>) )</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>                                                      &lt;= thermalRadius*thermalRadius ))) {</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>                                                   lsum[0] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> - averageVX) * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> - averageVX) * DV3;</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>                                                   lsum[1] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> - averageVY) * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> - averageVY) * DV3;</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>                                                   lsum[2] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> - averageVZ) * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> - averageVZ) * DV3;</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>                                                }</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>                                             };</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>                                          }, sum);</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span> </div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>         PTensor[0] = sum[0] * <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[popID].mass;</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>         PTensor[1] = sum[1] * <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[popID].mass;</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>         PTensor[2] = sum[2] * <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[popID].mass;</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span> </div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>      }</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>   }</div>
</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span> </div>
<div class="foldopen" id="foldopen00914" data-start="{" data-end="}">
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno"><a class="line" href="../../db/d48/namespace_d_r_o.html#a52c6728e661e56288611a96cf1c25d80">  914</a></span>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="../../db/d48/namespace_d_r_o.html#a52c6728e661e56288611a96cf1c25d80">PTensorOffDiagonalNonthermalCalculations</a>( <span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a> * cell,</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>                                                         <span class="keyword">const</span> <span class="keywordtype">bool</span> calculateNonthermal,</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>                                                         <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> averageVX,</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>                                                         <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> averageVY,</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>                                                         <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> averageVZ,</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>                                                         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> popID,</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>                                                         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> * PTensor ) {</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#add503fc20115bd5669fb3e0fe4fd344f">creal</a> <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a> = 0.5;</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>      <span class="keyword">const</span> std::array&lt;Real, 3&gt; thermalV = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[popID].thermalV;</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#add503fc20115bd5669fb3e0fe4fd344f">creal</a> thermalRadius = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[popID].thermalRadius;</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span> </div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span><span class="preprocessor">      #ifdef USE_GPU</span></div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ae0f93c317e351510eeaeaf8a57bf3f79">dev_get_velocity_blocks</a>(popID);</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span><span class="preprocessor">      #else</span></div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a1dc25bb724906fa5d6dd76096cb7b9a4">get_velocity_blocks</a>(popID);</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span><span class="preprocessor">      #endif</span></div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span> </div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>      <span class="comment">// ARCH interface includes OpenMP looping including critical regions for thread summation</span></div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>      {</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> sum[3] = {0};</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> thermalVX = thermalV[0];</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> thermalVY = thermalV[1];</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> thermalVZ = thermalV[2];</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span> </div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>         <span class="keywordflow">if</span> (cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(popID) != 0)</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>         <a class="code hl_function" href="../../d9/d6a/namespacearch.html#a8b44f7f5126702d29110d539cdfbd7e8">arch::parallel_reduce&lt;arch::sum&gt;</a>({<a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, (uint)cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(popID)},</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>                                          <a class="code hl_define" href="../../db/d79/arch__device__cuda_8h.html#abeccfbc804a98c6b06b7fc99c71dac5d">ARCH_LOOP_LAMBDA</a> (<span class="keyword">const</span> uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>, <span class="keyword">const</span> uint n, <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *lsum ) {</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span> </div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a6760bdacc1d8a5bb4c1a42e1103f0064">Realf</a> *block_data = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab577ace09cdc66074a7cdc3d79394cfb">getData</a>(n);</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *block_parameters = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab492eded4908cb97927ddc54a0f3d9d3">getParameters</a>(n);</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>                                             <span class="comment">// Get the volume of a velocity cell</span></div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> DV3 = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>] * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>] * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span> </div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>                                             <a class="code hl_define" href="../../dc/d9d/arch__device__api_8h.html#acf97310a30e30277ebe000e7e4ab6f53">ARCH_INNER_BODY</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>, n, lsum) {</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>                                                <span class="comment">// Get the coordinates of the velocity cell (e.g. VX = block_vx_min_coordinates + (velocity_cell_indice_x+0.5)*length_of_velocity_cell_in_x_direction</span></div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>                                                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856ace98fdb03651c50d1123499280fcb7ba">BlockParams::VXCRD</a>] + (<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>) * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>];</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>                                                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856addc5022ec6d36b0fc9a73d025cc14485">BlockParams::VYCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>) * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>];</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>                                                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aa4ae61e72bc15b4114a74faad6e64b07">BlockParams::VZCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>) * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>                                                <span class="comment">// Calculate the distance of the velocity cell from the center of the maxwellian distribution and compare it to the approximate radius of the maxwellian distribution</span></div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>                                                <span class="keywordflow">if</span> (((calculateNonthermal == <span class="keyword">true</span>) &amp;&amp;</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>                                                     (( (thermalVX - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a>) * (thermalVX - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a>)</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>                                                        + (thermalVY - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a>) * (thermalVY - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a>)</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>                                                        + (thermalVZ - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>) * (thermalVZ - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>) )</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>                                                      &gt; thermalRadius*thermalRadius))</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>                                                    ||</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>                                                    ((calculateNonthermal == <span class="keyword">false</span>) &amp;&amp;</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>                                                     (( (thermalVX - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a>) * (thermalVX - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a>)</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>                                                        + (thermalVY - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a>) * (thermalVY - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a>)</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>                                                        + (thermalVZ - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>) * (thermalVZ - <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>) )</div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>                                                      &lt;= thermalRadius*thermalRadius ))) {</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>                                                   lsum[0] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> - averageVX) * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> - averageVY) * DV3;</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>                                                   lsum[1] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> - averageVZ) * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> - averageVX) * DV3;</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>                                                   lsum[2] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> - averageVY) * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> - averageVZ) * DV3;</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>                                                }</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>                                             };</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>                                          }, sum);</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span> </div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>         PTensor[0] = sum[0] * <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[popID].mass;</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>         PTensor[1] = sum[1] * <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[popID].mass;</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>         PTensor[2] = sum[2] * <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[popID].mass;</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span> </div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>      }</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>   }</div>
</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span> </div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span><span class="comment">  /*********</span></div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span><span class="comment">        End velocity moment / thermal/non-thermal helper functions</span></div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span><span class="comment">  *********/</span></div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span> </div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>   <span class="comment">// Rho nonthermal:</span></div>
<div class="foldopen" id="foldopen00984" data-start="{" data-end="}">
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno"><a class="line" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a0cd4d9c16cd360a30461396ed53776e3">  984</a></span>   <a class="code hl_function" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a0cd4d9c16cd360a30461396ed53776e3">VariableRhoNonthermal::VariableRhoNonthermal</a>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> _popID): <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DataReductionOperator</a>(),<a class="code hl_variable" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a936685050cd690311caa49a9f750ec8a">popID</a>(_popID) {</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span>      <a class="code hl_variable" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#aec45b2e2297bad42783d6353c8ab71d6">popName</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a936685050cd690311caa49a9f750ec8a">popID</a>].name;</div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>      <a class="code hl_variable" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a534526c4a3b49b9713817d14ba3da9ba">doSkip</a> = (<a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a936685050cd690311caa49a9f750ec8a">popID</a>].thermalRadius == 0.0) ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>   }</div>
</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno"><a class="line" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a85c4e08160038fe6398edf3aedfdaa40">  988</a></span>   <a class="code hl_function" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a85c4e08160038fe6398edf3aedfdaa40">VariableRhoNonthermal::~VariableRhoNonthermal</a>() { }</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span> </div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno"><a class="line" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a508c82c938bb37d3e282df4cac3d3f7c">  990</a></span>   std::string <a class="code hl_function" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a508c82c938bb37d3e282df4cac3d3f7c">VariableRhoNonthermal::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#aec45b2e2297bad42783d6353c8ab71d6">popName</a> + <span class="stringliteral">&quot;/vg_rho_nonthermal&quot;</span>;}</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span> </div>
<div class="foldopen" id="foldopen00992" data-start="{" data-end="}">
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno"><a class="line" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a77dc54c6d4afa91205d800e2c83f7d8f">  992</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a77dc54c6d4afa91205d800e2c83f7d8f">VariableRhoNonthermal::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>      dataSize =  <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>);</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>      vectorSize = (<a class="code hl_variable" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a534526c4a3b49b9713817d14ba3da9ba">doSkip</a> == <span class="keyword">true</span>) ? 0 : 1;</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>   }</div>
</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span> </div>
<div class="foldopen" id="foldopen00999" data-start="{" data-end="}">
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno"><a class="line" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a12bae96561440553fa08c3c8d5065d0d">  999</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a12bae96561440553fa08c3c8d5065d0d">VariableRhoNonthermal::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> calculateNonthermal = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>      <a class="code hl_function" href="../../db/d48/namespace_d_r_o.html#aee822912aab9606485c338aef20c84dc">rhoNonthermalCalculation</a>( cell, calculateNonthermal, <a class="code hl_variable" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a936685050cd690311caa49a9f750ec8a">popID</a>, <a class="code hl_variable" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a4184f7dc704423fff41dc2484f4d71ac">RhoNonthermal</a> );</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a4184f7dc704423fff41dc2484f4d71ac">RhoNonthermal</a>);</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>   }</div>
</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span> </div>
<div class="foldopen" id="foldopen01007" data-start="{" data-end="}">
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"><a class="line" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a1f45a2cf6b2d9ebbb374ae998a9b98f6"> 1007</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a1f45a2cf6b2d9ebbb374ae998a9b98f6">VariableRhoNonthermal::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>      <a class="code hl_variable" href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a4184f7dc704423fff41dc2484f4d71ac">RhoNonthermal</a> = 0.0;</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>   }</div>
</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span> </div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>   <span class="comment">// Rho thermal:</span></div>
<div class="foldopen" id="foldopen01013" data-start="{" data-end="}">
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"><a class="line" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#abcca0868d1ab5d27af63f9700cd4a469"> 1013</a></span>   <a class="code hl_function" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#abcca0868d1ab5d27af63f9700cd4a469">VariableRhoThermal::VariableRhoThermal</a>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> _popID): <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DataReductionOperator</a>(),<a class="code hl_variable" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#ab1a8888230933588bc46b6a7dcb48c84">popID</a>(_popID) {</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>      <a class="code hl_variable" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#af7008095e60f00a2837c6f3aeaa31876">popName</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#ab1a8888230933588bc46b6a7dcb48c84">popID</a>].name;</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>      <a class="code hl_variable" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#a7c58f833c8c06c57882ea080fb2e87ef">doSkip</a> = (<a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#ab1a8888230933588bc46b6a7dcb48c84">popID</a>].thermalRadius == 0.0) ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>   }</div>
</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"><a class="line" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#a8295a49e15ece1374a1a852339cdcf30"> 1017</a></span>   <a class="code hl_function" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#a8295a49e15ece1374a1a852339cdcf30">VariableRhoThermal::~VariableRhoThermal</a>() { }</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span> </div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"><a class="line" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#a2a61e44572c1daf13dc4ef8050b0fba0"> 1019</a></span>   std::string <a class="code hl_function" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#a2a61e44572c1daf13dc4ef8050b0fba0">VariableRhoThermal::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#af7008095e60f00a2837c6f3aeaa31876">popName</a> + <span class="stringliteral">&quot;/vg_rho_thermal&quot;</span>;}</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span> </div>
<div class="foldopen" id="foldopen01021" data-start="{" data-end="}">
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"><a class="line" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#abb453ba8ca5bca39034e0b1494381876"> 1021</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#abb453ba8ca5bca39034e0b1494381876">VariableRhoThermal::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>      dataSize =  <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>);</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>      vectorSize = (<a class="code hl_variable" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#a7c58f833c8c06c57882ea080fb2e87ef">doSkip</a> == <span class="keyword">true</span>) ? 0 : 1;</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>   }</div>
</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span> </div>
<div class="foldopen" id="foldopen01028" data-start="{" data-end="}">
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"><a class="line" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#ae2ebb9e970d0c84dbe539159761f613c"> 1028</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#ae2ebb9e970d0c84dbe539159761f613c">VariableRhoThermal::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> calculateNonthermal = <span class="keyword">false</span>; <span class="comment">//We don&#39;t want nonthermal</span></div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>      <a class="code hl_function" href="../../db/d48/namespace_d_r_o.html#aee822912aab9606485c338aef20c84dc">rhoNonthermalCalculation</a>( cell, calculateNonthermal, <a class="code hl_variable" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#ab1a8888230933588bc46b6a7dcb48c84">popID</a>, <a class="code hl_variable" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#ad5a1e79a15059c7629f234ff61ea36be">RhoThermal</a> );</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#ad5a1e79a15059c7629f234ff61ea36be">RhoThermal</a>);</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>   }</div>
</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span> </div>
<div class="foldopen" id="foldopen01036" data-start="{" data-end="}">
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"><a class="line" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#a08e78b8800c932c47a1d3a83f5d2ff8b"> 1036</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#a08e78b8800c932c47a1d3a83f5d2ff8b">VariableRhoThermal::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>      <a class="code hl_variable" href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#ad5a1e79a15059c7629f234ff61ea36be">RhoThermal</a> = 0.0;</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>   }</div>
</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span> </div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>   <span class="comment">// v nonthermal:</span></div>
<div class="foldopen" id="foldopen01042" data-start="{" data-end="}">
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"><a class="line" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a8e30f5392a95f998ca7f5af7d1b642cc"> 1042</a></span>   <a class="code hl_function" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a8e30f5392a95f998ca7f5af7d1b642cc">VariableVNonthermal::VariableVNonthermal</a>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> _popID): <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DataReductionOperator</a>(),<a class="code hl_variable" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a90b6519c3dca2d589942b178e84d2c91">popID</a>(_popID) {</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>      <a class="code hl_variable" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a568581bac9f9fae801398fd53bd57c62">popName</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a90b6519c3dca2d589942b178e84d2c91">popID</a>].name;</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>      <a class="code hl_variable" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a2b10001b4dc64d20576ade0f6ccf1c68">doSkip</a> = (<a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a90b6519c3dca2d589942b178e84d2c91">popID</a>].thermalRadius == 0.0) ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>   }</div>
</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"><a class="line" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a58aebb4a4153d0687ed70a6b7a634968"> 1046</a></span>   <a class="code hl_function" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a58aebb4a4153d0687ed70a6b7a634968">VariableVNonthermal::~VariableVNonthermal</a>() { }</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span> </div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"><a class="line" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#aa7719605ef25e3ee7f5810443f33790e"> 1048</a></span>   std::string <a class="code hl_function" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#aa7719605ef25e3ee7f5810443f33790e">VariableVNonthermal::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a568581bac9f9fae801398fd53bd57c62">popName</a> + <span class="stringliteral">&quot;/vg_v_nonthermal&quot;</span>;}</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span> </div>
<div class="foldopen" id="foldopen01050" data-start="{" data-end="}">
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"><a class="line" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a605433709438fcaf6dab8efb9b3a34f7"> 1050</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a605433709438fcaf6dab8efb9b3a34f7">VariableVNonthermal::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>      dataSize =  <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>);</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>      vectorSize = (<a class="code hl_variable" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a2b10001b4dc64d20576ade0f6ccf1c68">doSkip</a> == <span class="keyword">true</span>) ? 0 : 3;</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>   }</div>
</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span> </div>
<div class="foldopen" id="foldopen01057" data-start="{" data-end="}">
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"><a class="line" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#aa6d4f037292e18c33ccd846ddda7ec0d"> 1057</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#aa6d4f037292e18c33ccd846ddda7ec0d">VariableVNonthermal::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> calculateNonthermal = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>      <span class="comment">//Calculate v nonthermal</span></div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>      <a class="code hl_function" href="../../db/d48/namespace_d_r_o.html#a4665b4ea30292022d8c8d81b83e6813f">VNonthermalCalculation</a>( cell, calculateNonthermal, <a class="code hl_variable" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a90b6519c3dca2d589942b178e84d2c91">popID</a>, <a class="code hl_variable" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a67f18a5a4ba4b5a4fee996cb040f34c2">VNonthermal</a> );</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>      <span class="keyword">const</span> uint VNonthermalSize = 3;</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a67f18a5a4ba4b5a4fee996cb040f34c2">VNonthermal</a>);</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; VNonthermalSize*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>   }</div>
</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span> </div>
<div class="foldopen" id="foldopen01067" data-start="{" data-end="}">
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"><a class="line" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a0d0a7b80819c4f495cad8f593db00503"> 1067</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a0d0a7b80819c4f495cad8f593db00503">VariableVNonthermal::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>      <span class="comment">// Initialize values</span></div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>      <span class="keywordflow">for</span>( uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; 3; ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> ) {</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>         <a class="code hl_variable" href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a67f18a5a4ba4b5a4fee996cb040f34c2">VNonthermal</a>[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = 0.0;</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>      }</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>   }</div>
</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span> </div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>   <span class="comment">//v thermal:</span></div>
<div class="foldopen" id="foldopen01076" data-start="{" data-end="}">
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"><a class="line" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a807ae3c03c380d71decc64da31f1cdab"> 1076</a></span>   <a class="code hl_function" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a807ae3c03c380d71decc64da31f1cdab">VariableVThermal::VariableVThermal</a>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> _popID): <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DataReductionOperator</a>(),<a class="code hl_variable" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a945385991b44cf9659ab95f274084ca0">popID</a>(_popID) {</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>      <a class="code hl_variable" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a4c39e866a9fa96bdeaf1b25d5faaf859">popName</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a945385991b44cf9659ab95f274084ca0">popID</a>].name;</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>      <a class="code hl_variable" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a8b065291564d47bdb4a26d081f84368e">doSkip</a> = (<a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a945385991b44cf9659ab95f274084ca0">popID</a>].thermalRadius == 0.0) ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>   }</div>
</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"><a class="line" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a3ef25f47cf736289eb1d482893357edd"> 1080</a></span>   <a class="code hl_function" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a3ef25f47cf736289eb1d482893357edd">VariableVThermal::~VariableVThermal</a>() { }</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span> </div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"><a class="line" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a376ed6459d60024ca6c743fda27e8e41"> 1082</a></span>   std::string <a class="code hl_function" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a376ed6459d60024ca6c743fda27e8e41">VariableVThermal::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a4c39e866a9fa96bdeaf1b25d5faaf859">popName</a> + <span class="stringliteral">&quot;/vg_v_thermal&quot;</span>;}</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span> </div>
<div class="foldopen" id="foldopen01084" data-start="{" data-end="}">
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"><a class="line" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a26031c22122753d147fb040d9dd0e235"> 1084</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a26031c22122753d147fb040d9dd0e235">VariableVThermal::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>      dataSize =  <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>);</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>      vectorSize = (<a class="code hl_variable" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a8b065291564d47bdb4a26d081f84368e">doSkip</a> == <span class="keyword">true</span>) ? 0 : 3;</div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>   }</div>
</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span> </div>
<div class="foldopen" id="foldopen01091" data-start="{" data-end="}">
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"><a class="line" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a39fafb68508d0d6ebc9fb55d282f863f"> 1091</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a39fafb68508d0d6ebc9fb55d282f863f">VariableVThermal::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> calculateNonthermal = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>      <span class="comment">//Calculate v nonthermal</span></div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>      <a class="code hl_function" href="../../db/d48/namespace_d_r_o.html#a4665b4ea30292022d8c8d81b83e6813f">VNonthermalCalculation</a>( cell, calculateNonthermal, <a class="code hl_variable" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a945385991b44cf9659ab95f274084ca0">popID</a>, <a class="code hl_variable" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a74d9c131419676f72737b9f7623805e1">VThermal</a> );</div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>      <span class="keyword">const</span> uint vectorSize = 3;</div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a74d9c131419676f72737b9f7623805e1">VThermal</a>);</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; vectorSize*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>   }</div>
</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span> </div>
<div class="foldopen" id="foldopen01101" data-start="{" data-end="}">
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"><a class="line" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a4cad8f13db3aee52df71fb3323306e99"> 1101</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a4cad8f13db3aee52df71fb3323306e99">VariableVThermal::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>      <span class="comment">// Initialize values</span></div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>      <span class="keywordflow">for</span>( uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; 3; ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> ) {</div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>         <a class="code hl_variable" href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a74d9c131419676f72737b9f7623805e1">VThermal</a>[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = 0.0;</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>      }</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>   }</div>
</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span> </div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>   <span class="comment">// Adding pressure calculations for nonthermal population to Vlasiator.</span></div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>   <span class="comment">// p_ij = m/3 * integral((v - &lt;V&gt;)_i(v - &lt;V&gt;)_j * f(r,v) dV)</span></div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span> </div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>   <span class="comment">// Pressure tensor 6 components (11, 22, 33, 23, 13, 12) added by YK</span></div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>   <span class="comment">// Split into VariablePTensorNonthermalDiagonal (11, 22, 33)</span></div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>   <span class="comment">// and VariablePTensorNonthermalOffDiagonal (23, 13, 12)</span></div>
<div class="foldopen" id="foldopen01115" data-start="{" data-end="}">
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"><a class="line" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a995d71d08684d83bbe4ce410918b0b0e"> 1115</a></span>   <a class="code hl_function" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a995d71d08684d83bbe4ce410918b0b0e">VariablePTensorNonthermalDiagonal::VariablePTensorNonthermalDiagonal</a>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> _popID): <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DataReductionOperator</a>(),<a class="code hl_variable" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a9316ea8410fbf7e6444dd620acd22a18">popID</a>(_popID) {</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>      <a class="code hl_variable" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a30ae26b2317786ec419f1d752798b03f">popName</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a9316ea8410fbf7e6444dd620acd22a18">popID</a>].name;</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>      <a class="code hl_variable" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a58f68fd5d361ad30c92ab3d56e0168c1">doSkip</a> = (<a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a9316ea8410fbf7e6444dd620acd22a18">popID</a>].thermalRadius == 0.0) ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>   }</div>
</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"><a class="line" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#ac0a02f0976c18fa7f6439931193f8d05"> 1119</a></span>   <a class="code hl_function" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#ac0a02f0976c18fa7f6439931193f8d05">VariablePTensorNonthermalDiagonal::~VariablePTensorNonthermalDiagonal</a>() { }</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span> </div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"><a class="line" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a6dd13c3030a1869205c1771afd0d7b39"> 1121</a></span>   std::string <a class="code hl_function" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a6dd13c3030a1869205c1771afd0d7b39">VariablePTensorNonthermalDiagonal::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a30ae26b2317786ec419f1d752798b03f">popName</a> + <span class="stringliteral">&quot;/vg_ptensor_nonthermal_diagonal&quot;</span>;}</div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span> </div>
<div class="foldopen" id="foldopen01123" data-start="{" data-end="}">
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"><a class="line" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#aae1a358d68bb9b959ee358447bc3dd88"> 1123</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#aae1a358d68bb9b959ee358447bc3dd88">VariablePTensorNonthermalDiagonal::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>      dataSize =  <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>);</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>      vectorSize = (<a class="code hl_variable" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a58f68fd5d361ad30c92ab3d56e0168c1">doSkip</a> == <span class="keyword">true</span>) ? 0 : 3;</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>   }</div>
</div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span> </div>
<div class="foldopen" id="foldopen01130" data-start="{" data-end="}">
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"><a class="line" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a12b79665c139384a797e0c95a57bff40"> 1130</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a12b79665c139384a797e0c95a57bff40">VariablePTensorNonthermalDiagonal::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> calculateNonthermal = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span>      <span class="comment">//Calculate PTensor and save it in PTensorArray:</span></div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>      <a class="code hl_function" href="../../db/d48/namespace_d_r_o.html#a52d86cee7ef279930db199747125a464">PTensorDiagonalNonthermalCalculations</a>( cell, calculateNonthermal, <a class="code hl_variable" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a5c6df6835c7b5a3e34139e78a9e974e0">averageVX</a>, <a class="code hl_variable" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a3d552c3144ead72eab8a08797e50c8e1">averageVY</a>, <a class="code hl_variable" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#af36b30a302e6a6234a96c38e25d8facd">averageVZ</a>, <a class="code hl_variable" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a9316ea8410fbf7e6444dd620acd22a18">popID</a>, <a class="code hl_variable" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#afeb9ca274b319bccf1338ccb7320e985">PTensor</a> );</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>      <span class="keyword">const</span> uint vectorSize = 3;</div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>      <span class="comment">//Save the data into buffer:</span></div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#afeb9ca274b319bccf1338ccb7320e985">PTensor</a>);</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; vectorSize*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>   }</div>
</div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span> </div>
<div class="foldopen" id="foldopen01141" data-start="{" data-end="}">
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"><a class="line" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#aeb1bf23342fcdeb511c7fd249e889793"> 1141</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#aeb1bf23342fcdeb511c7fd249e889793">VariablePTensorNonthermalDiagonal::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>      <span class="comment">//Get v of the nonthermal:</span></div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[3] = {0};</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> calculateNonthermal = <span class="keyword">true</span>; <span class="comment">//We are calculating nonthermal</span></div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>      <a class="code hl_function" href="../../db/d48/namespace_d_r_o.html#a4665b4ea30292022d8c8d81b83e6813f">VNonthermalCalculation</a>( cell, calculateNonthermal, <a class="code hl_variable" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a9316ea8410fbf7e6444dd620acd22a18">popID</a>, <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a> );</div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>      <span class="comment">//Set the average velocities:</span></div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>      <a class="code hl_variable" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a5c6df6835c7b5a3e34139e78a9e974e0">averageVX</a> = <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[0];</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>      <a class="code hl_variable" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a3d552c3144ead72eab8a08797e50c8e1">averageVY</a> = <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[1];</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>      <a class="code hl_variable" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#af36b30a302e6a6234a96c38e25d8facd">averageVZ</a> = <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[2];</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>      <span class="keyword">const</span> uint vectorSize = 3;</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>      <span class="keywordflow">for</span>(uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; vectorSize; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++) {</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>         <a class="code hl_variable" href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#afeb9ca274b319bccf1338ccb7320e985">PTensor</a>[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = 0.0;</div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>      }</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>   }</div>
</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span> </div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span>   <span class="comment">// Adding pressure calculations for thermal population to Vlasiator.</span></div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>   <span class="comment">// p_ij = m/3 * integral((v - &lt;V&gt;)_i(v - &lt;V&gt;)_j * f(r,v) dV)</span></div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span> </div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>   <span class="comment">// Pressure tensor 6 components (11, 22, 33, 23, 13, 12) added by YK</span></div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>   <span class="comment">// Split into VariablePTensorThermalDiagonal (11, 22, 33)</span></div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>   <span class="comment">// and VariablePTensorThermalOffDiagonal (23, 13, 12)</span></div>
<div class="foldopen" id="foldopen01163" data-start="{" data-end="}">
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"><a class="line" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#a86b1f715975e6222b6367e0916aaa9e1"> 1163</a></span>   <a class="code hl_function" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#a86b1f715975e6222b6367e0916aaa9e1">VariablePTensorThermalDiagonal::VariablePTensorThermalDiagonal</a>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> _popID): <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DataReductionOperator</a>(),<a class="code hl_variable" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#ab83f7f09a40d88eb216e228cfa866fb5">popID</a>(_popID) {</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>      <a class="code hl_variable" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#aec577889c883303cf41f9a69f5aa8bad">popName</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#ab83f7f09a40d88eb216e228cfa866fb5">popID</a>].name;</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>      <a class="code hl_variable" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#a7d7bd7c7c683802cfb779547c808c9dc">doSkip</a> = (<a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#ab83f7f09a40d88eb216e228cfa866fb5">popID</a>].thermalRadius == 0.0) ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>   }</div>
</div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"><a class="line" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#ae0d78dfbd648310610281924cefbf292"> 1167</a></span>   <a class="code hl_function" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#ae0d78dfbd648310610281924cefbf292">VariablePTensorThermalDiagonal::~VariablePTensorThermalDiagonal</a>() { }</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span> </div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"><a class="line" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#a7d93ea81a699a4b66e92e0436c4b2d61"> 1169</a></span>   std::string <a class="code hl_function" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#a7d93ea81a699a4b66e92e0436c4b2d61">VariablePTensorThermalDiagonal::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#aec577889c883303cf41f9a69f5aa8bad">popName</a> + <span class="stringliteral">&quot;/vg_ptensor_thermal_diagonal&quot;</span>;}</div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span> </div>
<div class="foldopen" id="foldopen01171" data-start="{" data-end="}">
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"><a class="line" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#a43763c25deb35c8fde46b0589c92684c"> 1171</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#a43763c25deb35c8fde46b0589c92684c">VariablePTensorThermalDiagonal::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>      dataSize =  <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>);</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>      vectorSize = (<a class="code hl_variable" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#a7d7bd7c7c683802cfb779547c808c9dc">doSkip</a> == <span class="keyword">true</span>) ? 0 : 3;</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>   }</div>
</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span> </div>
<div class="foldopen" id="foldopen01178" data-start="{" data-end="}">
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"><a class="line" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#a9fc98f5e8da0e87079da2c329e99a95d"> 1178</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#a9fc98f5e8da0e87079da2c329e99a95d">VariablePTensorThermalDiagonal::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> calculateNonthermal = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>      <span class="comment">//Calculate PTensor and save it in PTensorArray:</span></div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>      <a class="code hl_function" href="../../db/d48/namespace_d_r_o.html#a52d86cee7ef279930db199747125a464">PTensorDiagonalNonthermalCalculations</a>( cell, calculateNonthermal, <a class="code hl_variable" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#a9eb21a26e54dc0729b8772dffa228ffa">averageVX</a>, <a class="code hl_variable" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#a9a6656698db627f541d118692624c5e4">averageVY</a>, <a class="code hl_variable" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#af2e017c1b98e0a219e68b035d2839616">averageVZ</a>, <a class="code hl_variable" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#ab83f7f09a40d88eb216e228cfa866fb5">popID</a>, <a class="code hl_variable" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#aae95094f294f5a90933141367078e42c">PTensor</a> );</div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>      <span class="keyword">const</span> uint vectorSize = 3;</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>      <span class="comment">//Save the data into buffer:</span></div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#aae95094f294f5a90933141367078e42c">PTensor</a>);</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; vectorSize*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>   }</div>
</div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span> </div>
<div class="foldopen" id="foldopen01189" data-start="{" data-end="}">
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"><a class="line" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#ac4f3ad08111b62709c4f1ad0b4770d4a"> 1189</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#ac4f3ad08111b62709c4f1ad0b4770d4a">VariablePTensorThermalDiagonal::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>      <span class="comment">//Get v of the thermal:</span></div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[3] = {0};</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> calculateNonthermal = <span class="keyword">false</span>; <span class="comment">//We are not calculating nonthermal</span></div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>      <a class="code hl_function" href="../../db/d48/namespace_d_r_o.html#a4665b4ea30292022d8c8d81b83e6813f">VNonthermalCalculation</a>( cell, calculateNonthermal, <a class="code hl_variable" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#ab83f7f09a40d88eb216e228cfa866fb5">popID</a>, <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a> );</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>      <span class="comment">//Set the average velocities:</span></div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>      <a class="code hl_variable" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#a9eb21a26e54dc0729b8772dffa228ffa">averageVX</a> = <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[0];</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>      <a class="code hl_variable" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#a9a6656698db627f541d118692624c5e4">averageVY</a> = <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[1];</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>      <a class="code hl_variable" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#af2e017c1b98e0a219e68b035d2839616">averageVZ</a> = <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[2];</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>      <span class="keyword">const</span> uint vectorSize = 3;</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>      <span class="keywordflow">for</span>(uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; vectorSize; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++) {</div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>         <a class="code hl_variable" href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#aae95094f294f5a90933141367078e42c">PTensor</a>[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = 0.0;</div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>      }</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>   }</div>
</div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span> </div>
<div class="foldopen" id="foldopen01205" data-start="{" data-end="}">
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"><a class="line" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a636c26a7b70ed417bd4ddb673c7cf150"> 1205</a></span>   <a class="code hl_function" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a636c26a7b70ed417bd4ddb673c7cf150">VariablePTensorNonthermalOffDiagonal::VariablePTensorNonthermalOffDiagonal</a>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> _popID): <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DataReductionOperator</a>(),<a class="code hl_variable" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a4f087d80e4f2743ea1cfe63879472a83">popID</a>(_popID) {</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>      <a class="code hl_variable" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a7c73c46b3d0d33c05776432ca3a3c040">popName</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a4f087d80e4f2743ea1cfe63879472a83">popID</a>].name;</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>      <a class="code hl_variable" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a43347c376a93bcf6ea5f7b183ca2dab2">doSkip</a> = (<a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a4f087d80e4f2743ea1cfe63879472a83">popID</a>].thermalRadius == 0.0) ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>   }</div>
</div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"><a class="line" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#abf09ba1c432d0622cfe7a4e61a0d890f"> 1209</a></span>   <a class="code hl_function" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#abf09ba1c432d0622cfe7a4e61a0d890f">VariablePTensorNonthermalOffDiagonal::~VariablePTensorNonthermalOffDiagonal</a>() { }</div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span> </div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"><a class="line" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a1d93106e4d9e964429f560d4b4582974"> 1211</a></span>   std::string <a class="code hl_function" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a1d93106e4d9e964429f560d4b4582974">VariablePTensorNonthermalOffDiagonal::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a7c73c46b3d0d33c05776432ca3a3c040">popName</a> + <span class="stringliteral">&quot;/vg_ptensor_nonthermal_offdiagonal&quot;</span>;}</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span> </div>
<div class="foldopen" id="foldopen01213" data-start="{" data-end="}">
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"><a class="line" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#afa8419f2b016496d58742ca6fee9cc77"> 1213</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#afa8419f2b016496d58742ca6fee9cc77">VariablePTensorNonthermalOffDiagonal::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>      dataSize =  <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>);</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>      vectorSize = (<a class="code hl_variable" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a43347c376a93bcf6ea5f7b183ca2dab2">doSkip</a> == <span class="keyword">true</span>) ? 0 : 3;</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>   }</div>
</div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span> </div>
<div class="foldopen" id="foldopen01220" data-start="{" data-end="}">
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"><a class="line" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#aa1c7d07e73c56e2e434b2388de6c7406"> 1220</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#aa1c7d07e73c56e2e434b2388de6c7406">VariablePTensorNonthermalOffDiagonal::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>      <span class="comment">//Calculate PTensor for PTensorArray:</span></div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> calculateNonthermal = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span>      <span class="comment">//Calculate and save:</span></div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>      <a class="code hl_function" href="../../db/d48/namespace_d_r_o.html#a52c6728e661e56288611a96cf1c25d80">PTensorOffDiagonalNonthermalCalculations</a>( cell, calculateNonthermal, <a class="code hl_variable" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a0a4e5ad4ac08f01b712069632e33a9a9">averageVX</a>, <a class="code hl_variable" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a7dcb58b9932d8ae54233657d898a2206">averageVY</a>, <a class="code hl_variable" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a18537446bcbb7221c14125199afaaf0c">averageVZ</a>, <a class="code hl_variable" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a4f087d80e4f2743ea1cfe63879472a83">popID</a>, <a class="code hl_variable" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a0991dd8d4929942c7a04cf5ddb198959">PTensor</a> );</div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span>      <span class="keyword">const</span> uint vectorSize = 3;</div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span>      <span class="comment">//Input data into buffer</span></div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a0991dd8d4929942c7a04cf5ddb198959">PTensor</a>);</div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; vectorSize*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) {</div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>         buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>      }</div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>   }</div>
</div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span> </div>
<div class="foldopen" id="foldopen01234" data-start="{" data-end="}">
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"><a class="line" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a09255a9c48776fcc8db0e68a0425d884"> 1234</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a09255a9c48776fcc8db0e68a0425d884">VariablePTensorNonthermalOffDiagonal::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>      <span class="comment">//Get v of the nonthermal:</span></div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[3] = {0};</div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> calculateNonthermal = <span class="keyword">true</span>; <span class="comment">//We are calculating nonthermal</span></div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span>      <a class="code hl_function" href="../../db/d48/namespace_d_r_o.html#a4665b4ea30292022d8c8d81b83e6813f">VNonthermalCalculation</a>( cell, calculateNonthermal, <a class="code hl_variable" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a4f087d80e4f2743ea1cfe63879472a83">popID</a>, <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a> );</div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span>      <span class="comment">//Set the average velocities:</span></div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>      <a class="code hl_variable" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a0a4e5ad4ac08f01b712069632e33a9a9">averageVX</a> = <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[0];</div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span>      <a class="code hl_variable" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a7dcb58b9932d8ae54233657d898a2206">averageVY</a> = <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[1];</div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>      <a class="code hl_variable" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a18537446bcbb7221c14125199afaaf0c">averageVZ</a> = <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[2];</div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; 3; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++) {</div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span>         <a class="code hl_variable" href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a0991dd8d4929942c7a04cf5ddb198959">PTensor</a>[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = 0.0;</div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span>      }</div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>   }</div>
</div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span> </div>
<div class="foldopen" id="foldopen01249" data-start="{" data-end="}">
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"><a class="line" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a57735c40b14c08ce5faf6fdce774905d"> 1249</a></span>   <a class="code hl_function" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a57735c40b14c08ce5faf6fdce774905d">VariablePTensorThermalOffDiagonal::VariablePTensorThermalOffDiagonal</a>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> _popID): <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DataReductionOperator</a>(),<a class="code hl_variable" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a55cc4bb926a981087ea75c04fd29934a">popID</a>(_popID) {</div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>      <a class="code hl_variable" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#abc9338897137c19e50f493f991f345be">popName</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a55cc4bb926a981087ea75c04fd29934a">popID</a>].name;</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>      <a class="code hl_variable" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a383dda2255f8c5372d8e752ab36db8d8">doSkip</a> = (<a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a55cc4bb926a981087ea75c04fd29934a">popID</a>].thermalRadius == 0.0) ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span>   }</div>
</div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"><a class="line" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a1dda849ee3044d59d13a1be237cc2c15"> 1253</a></span>   <a class="code hl_function" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a1dda849ee3044d59d13a1be237cc2c15">VariablePTensorThermalOffDiagonal::~VariablePTensorThermalOffDiagonal</a>() { }</div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span> </div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"><a class="line" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#aab5199172396fa9b1b7c058231a0b61c"> 1255</a></span>   std::string <a class="code hl_function" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#aab5199172396fa9b1b7c058231a0b61c">VariablePTensorThermalOffDiagonal::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#abc9338897137c19e50f493f991f345be">popName</a> + <span class="stringliteral">&quot;/vg_ptensor_thermal_offdiagonal&quot;</span>;}</div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span> </div>
<div class="foldopen" id="foldopen01257" data-start="{" data-end="}">
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"><a class="line" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a686661ccca4ec8a67db837dde49d0e52"> 1257</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a686661ccca4ec8a67db837dde49d0e52">VariablePTensorThermalOffDiagonal::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>      dataSize =  <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>);</div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>      vectorSize = (<a class="code hl_variable" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a383dda2255f8c5372d8e752ab36db8d8">doSkip</a> == <span class="keyword">true</span>) ? 0 : 3;</div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>   }</div>
</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span> </div>
<div class="foldopen" id="foldopen01264" data-start="{" data-end="}">
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"><a class="line" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#aaf0ad6d93e2b89abad47d71ff88cfa0b"> 1264</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#aaf0ad6d93e2b89abad47d71ff88cfa0b">VariablePTensorThermalOffDiagonal::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>      <span class="comment">//Calculate PTensor for PTensorArray:</span></div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> calculateNonthermal = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>      <span class="comment">//Calculate and save:</span></div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>      <a class="code hl_function" href="../../db/d48/namespace_d_r_o.html#a52c6728e661e56288611a96cf1c25d80">PTensorOffDiagonalNonthermalCalculations</a>( cell, calculateNonthermal, <a class="code hl_variable" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#af26d404db73374c229016f510e4c1e58">averageVX</a>, <a class="code hl_variable" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a3b7db01778382478d2b01b8c1847877a">averageVY</a>, <a class="code hl_variable" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#ad777597108ab514d7d8ea2e82c5aa9ba">averageVZ</a>, <a class="code hl_variable" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a55cc4bb926a981087ea75c04fd29934a">popID</a>, <a class="code hl_variable" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#acc8fc9e94197e9d6a61c83d767222d34">PTensor</a> );</div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>      <span class="keyword">const</span> uint vectorSize = 3;</div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>      <span class="comment">//Input data into buffer</span></div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#acc8fc9e94197e9d6a61c83d767222d34">PTensor</a>);</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; vectorSize*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) {</div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>         buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span>      }</div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>   }</div>
</div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span> </div>
<div class="foldopen" id="foldopen01278" data-start="{" data-end="}">
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"><a class="line" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a3bd55ffced2c5d0eaaca36d1f3202904"> 1278</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a3bd55ffced2c5d0eaaca36d1f3202904">VariablePTensorThermalOffDiagonal::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>      <span class="comment">//Get v of the nonthermal:</span></div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[3] = {0};</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> calculateNonthermal = <span class="keyword">false</span>; <span class="comment">//We are not calculating nonthermal</span></div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>      <a class="code hl_function" href="../../db/d48/namespace_d_r_o.html#a4665b4ea30292022d8c8d81b83e6813f">VNonthermalCalculation</a>( cell, calculateNonthermal, <a class="code hl_variable" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a55cc4bb926a981087ea75c04fd29934a">popID</a>, <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a> );</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>      <span class="comment">//Set the average velocities:</span></div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>      <a class="code hl_variable" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#af26d404db73374c229016f510e4c1e58">averageVX</a> = <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[0];</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>      <a class="code hl_variable" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a3b7db01778382478d2b01b8c1847877a">averageVY</a> = <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[1];</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>      <a class="code hl_variable" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#ad777597108ab514d7d8ea2e82c5aa9ba">averageVZ</a> = <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a>[2];</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; 3; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++) {</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>         <a class="code hl_variable" href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#acc8fc9e94197e9d6a61c83d767222d34">PTensor</a>[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = 0.0;</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>      }</div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>   }</div>
</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span> </div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span> </div>
<div class="foldopen" id="foldopen01294" data-start="{" data-end="}">
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"><a class="line" href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a837b688e0d981fb89c3ca147f2daff24"> 1294</a></span>   <a class="code hl_function" href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a837b688e0d981fb89c3ca147f2daff24">VariableEffectiveSparsityThreshold::VariableEffectiveSparsityThreshold</a>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> _popID): <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DataReductionOperator</a>(),<a class="code hl_variable" href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#ab118dd930ae3b930b3d094aa4bf21ac1">popID</a>(_popID) {</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>     <a class="code hl_variable" href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a9e4af3bae5027f2e963a9efd5ccb2299">popName</a>=<a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#ab118dd930ae3b930b3d094aa4bf21ac1">popID</a>].name;</div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>   }</div>
</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"><a class="line" href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a8353c1e8993bf75c147d5606bfab30eb"> 1297</a></span>   <a class="code hl_function" href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a8353c1e8993bf75c147d5606bfab30eb">VariableEffectiveSparsityThreshold::~VariableEffectiveSparsityThreshold</a>() { }</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span> </div>
<div class="foldopen" id="foldopen01299" data-start="{" data-end="}">
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"><a class="line" href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a63fade3f84a863e1746a1d504dc4ca5b"> 1299</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a63fade3f84a863e1746a1d504dc4ca5b">VariableEffectiveSparsityThreshold::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>      dataSize =  <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>);</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span>      vectorSize = 1;</div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>   }</div>
</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span> </div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"><a class="line" href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#ad1abf6e695eacca7eaed524ecde30a62"> 1306</a></span>   std::string <a class="code hl_function" href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#ad1abf6e695eacca7eaed524ecde30a62">VariableEffectiveSparsityThreshold::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a9e4af3bae5027f2e963a9efd5ccb2299">popName</a> + <span class="stringliteral">&quot;/vg_effectivesparsitythreshold&quot;</span>;}</div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span> </div>
<div class="foldopen" id="foldopen01308" data-start="{" data-end="}">
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"><a class="line" href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a87efdb59ed07ac401d134ec41655f3fc"> 1308</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a87efdb59ed07ac401d134ec41655f3fc">VariableEffectiveSparsityThreshold::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">spatial_cell::SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> dummy;</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span>      <a class="code hl_function" href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a0b544b39aedbeff809ace0c3434b4ded">reduceDiagnostic</a>(cell,&amp;dummy);</div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;dummy);</div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span>   }</div>
</div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span> </div>
<div class="foldopen" id="foldopen01316" data-start="{" data-end="}">
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"><a class="line" href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a0b544b39aedbeff809ace0c3434b4ded"> 1316</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a0b544b39aedbeff809ace0c3434b4ded">VariableEffectiveSparsityThreshold::reduceDiagnostic</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">spatial_cell::SpatialCell</a>* cell,<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>* result) {</div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>      *result = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a5ac5e609f6acb3f06bf4853436a7aef7">getVelocityBlockMinValue</a>(<a class="code hl_variable" href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#ab118dd930ae3b930b3d094aa4bf21ac1">popID</a>);</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>   }</div>
</div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span> </div>
<div class="foldopen" id="foldopen01321" data-start="{" data-end="}">
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"><a class="line" href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a582a47b58cfc35951842e0b2d32e1d56"> 1321</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a582a47b58cfc35951842e0b2d32e1d56">VariableEffectiveSparsityThreshold::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">spatial_cell::SpatialCell</a>* cell) {</div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>   }</div>
</div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span></div>
<div class="foldopen" id="foldopen01334" data-start="{" data-end="}">
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"><a class="line" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#ab0e1d102168746834989a2bef3d8d76f"> 1334</a></span>   <a class="code hl_function" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#ab0e1d102168746834989a2bef3d8d76f">VariablePrecipitationDiffFlux::VariablePrecipitationDiffFlux</a>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> _popID): <a class="code hl_function" href="../../de/d11/class_d_r_o_1_1_data_reduction_operator_has_parameters.html#afb4eb20318147a30a2a180bafc8d0edb">DataReductionOperatorHasParameters</a>(),<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a0766447359b57dc5727154ca296f9d76">popID</a>(_popID) {</div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span>      <a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a4205814de8a8fa94bb31b95c925cbc06">popName</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a0766447359b57dc5727154ca296f9d76">popID</a>].name;</div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span>      <a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#ac2a5b3429c5762a8da06d90ee1237190">lossConeAngle</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a0766447359b57dc5727154ca296f9d76">popID</a>].precipitationLossConeAngle; <span class="comment">// deg</span></div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span>      <a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a4ca76516a9d661f46668e251e926543e">emin</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a0766447359b57dc5727154ca296f9d76">popID</a>].precipitationEmin;    <span class="comment">// already converted to SI</span></div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span>      <a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a72af7649d7dc163fc913542c1b84f6c2">emax</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a0766447359b57dc5727154ca296f9d76">popID</a>].precipitationEmax;    <span class="comment">// already converted to SI</span></div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span>      <a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a5a0a25b1de510ac22d9654462152a977">nChannels</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a0766447359b57dc5727154ca296f9d76">popID</a>].precipitationNChannels; <span class="comment">// number of energy channels, logarithmically spaced between emin and emax</span></div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>=0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>&lt;<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a5a0a25b1de510ac22d9654462152a977">nChannels</a>; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++){</div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span>         <a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a688406b498318337fed03ad079c4d186">channels</a>.push_back(<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a4ca76516a9d661f46668e251e926543e">emin</a> * pow(<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a72af7649d7dc163fc913542c1b84f6c2">emax</a>/<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a4ca76516a9d661f46668e251e926543e">emin</a>,(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>)<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>/(<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a5a0a25b1de510ac22d9654462152a977">nChannels</a>-1)));</div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span>      }</div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span>   }</div>
</div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"><a class="line" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#af0b83624796b6396a78dbec18f9329a4"> 1344</a></span>   <a class="code hl_function" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#af0b83624796b6396a78dbec18f9329a4">VariablePrecipitationDiffFlux::~VariablePrecipitationDiffFlux</a>() { }</div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span> </div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"><a class="line" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#ab15c09a7f743cea10da3dbe12dab7a32"> 1346</a></span>   std::string <a class="code hl_function" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#ab15c09a7f743cea10da3dbe12dab7a32">VariablePrecipitationDiffFlux::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a4205814de8a8fa94bb31b95c925cbc06">popName</a> + <span class="stringliteral">&quot;/vg_precipitationdifferentialflux&quot;</span>;}</div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span> </div>
<div class="foldopen" id="foldopen01348" data-start="{" data-end="}">
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"><a class="line" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#ab149bfa4c732ee30f1e042c9b09728f2"> 1348</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#ab149bfa4c732ee30f1e042c9b09728f2">VariablePrecipitationDiffFlux::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span>      dataSize =  <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>);</div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span>      vectorSize = <a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a5a0a25b1de510ac22d9654462152a977">nChannels</a>; <span class="comment">//Number of energy channels</span></div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span>   }</div>
</div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span> </div>
<div class="foldopen" id="foldopen01355" data-start="{" data-end="}">
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"><a class="line" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#ab196e65f7820268554e89a1614c82b7b"> 1355</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#ab196e65f7820268554e89a1614c82b7b">VariablePrecipitationDiffFlux::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span> </div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span>      <a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a845b8ff3136cb26783219ab9f6b723dd">dataDiffFlux</a>.assign(<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a5a0a25b1de510ac22d9654462152a977">nChannels</a>,0.0);</div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span> </div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span>      std::vector&lt;Real&gt; sumWeights(<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a5a0a25b1de510ac22d9654462152a977">nChannels</a>,0.0);</div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span> </div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span>      std::array&lt;Real,3&gt; B;</div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span>      B[0] = cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a50f3584d2fa8255ba2df24d8b01d8a83">CellParams::PERBXVOL</a>] +  cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a0b14dcc916a785f309ca6c122d8acecb">CellParams::BGBXVOL</a>];</div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span>      B[1] = cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840ac44a0b8ba721d489ba7f5d0e74c592ac">CellParams::PERBYVOL</a>] +  cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840ae5c6d66d7d0c73858a1c8ca46f5952a5">CellParams::BGBYVOL</a>];</div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span>      B[2] = cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840ad9d470cda28e4d96059ae0a1335552e5">CellParams::PERBZVOL</a>] +  cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a8d84d511a8af5fc3860564fbf862845e">CellParams::BGBZVOL</a>];</div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span> </div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> cosAngle = cos(<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#ac2a5b3429c5762a8da06d90ee1237190">lossConeAngle</a>*M_PI/180.0); <span class="comment">// cosine of fixed loss cone angle</span></div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span> </div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span>      <span class="comment">// Unit B-field direction</span></div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#add503fc20115bd5669fb3e0fe4fd344f">creal</a> normB = <a class="code hl_function" href="../../de/d31/_dispersion_8m.html#af276a2aede715061015c735080cf65df">sqrt</a>(B[0]*B[0] + B[1]*B[1] + B[2]*B[2]);</div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>=0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>&lt;3; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++){</div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>         B[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] /= normB;</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span>      }</div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span> </div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span>      <span class="comment">// If southern hemisphere, loss cone is around -B</span></div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span>      <span class="keywordflow">if</span> (cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a469ec6fde1e7d76a72800cd322b733d2">CellParams::ZCRD</a>] + 0.5*cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840ad5a8e812e459b91b7148798568c469a1">CellParams::DZ</a>] &lt; 0.0){</div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span>         <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>=0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>&lt;3; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++){</div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>            B[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = -B[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span>         }</div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span>      }</div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span> </div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span><span class="preprocessor">      #ifdef USE_GPU</span></div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ae0f93c317e351510eeaeaf8a57bf3f79">dev_get_velocity_blocks</a>(<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a0766447359b57dc5727154ca296f9d76">popID</a>);</div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span><span class="preprocessor">      #else</span></div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a1dc25bb724906fa5d6dd76096cb7b9a4">get_velocity_blocks</a>(<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a0766447359b57dc5727154ca296f9d76">popID</a>);</div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span><span class="preprocessor">      #endif</span></div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span> </div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span>      <span class="comment">// ARCH interface includes OpenMP looping including critical regions for thread summation</span></div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>      {</div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span>         std::vector&lt;Real&gt; sum(2 * <a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a5a0a25b1de510ac22d9654462152a977">nChannels</a>,0.0);</div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span>         <span class="keywordtype">int</span> nChannelsLocal = <a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a5a0a25b1de510ac22d9654462152a977">nChannels</a>;</div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a90ad4bd5b920bf33a857dacf0ff8f520">B0</a> = B[0];</div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> B1 = B[1];</div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> B2 = B[2];</div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> emaxLocal = <a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a72af7649d7dc163fc913542c1b84f6c2">emax</a>;</div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> eminLocal = <a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a4ca76516a9d661f46668e251e926543e">emin</a>;</div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span> </div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span>         <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> mass = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a0766447359b57dc5727154ca296f9d76">popID</a>].mass;</div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span>         <span class="keywordflow">if</span> (cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a0766447359b57dc5727154ca296f9d76">popID</a>) != 0)</div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span>         <a class="code hl_function" href="../../d9/d6a/namespacearch.html#a8b44f7f5126702d29110d539cdfbd7e8">arch::parallel_reduce&lt;arch::sum&gt;</a>({<a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, (uint)cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a0766447359b57dc5727154ca296f9d76">popID</a>)},</div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span>                                          <a class="code hl_define" href="../../db/d79/arch__device__cuda_8h.html#abeccfbc804a98c6b06b7fc99c71dac5d">ARCH_LOOP_LAMBDA</a> (<span class="keyword">const</span> uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>, <span class="keyword">const</span> uint n, <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *lsum )-&gt; <span class="keywordtype">void</span> {</div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span> </div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a6760bdacc1d8a5bb4c1a42e1103f0064">Realf</a> *block_data = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab577ace09cdc66074a7cdc3d79394cfb">getData</a>(n);</div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *block_parameters = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab492eded4908cb97927ddc54a0f3d9d3">getParameters</a>(n);</div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856ace98fdb03651c50d1123499280fcb7ba">BlockParams::VXCRD</a>] + (<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>];</div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856addc5022ec6d36b0fc9a73d025cc14485">BlockParams::VYCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>];</div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aa4ae61e72bc15b4114a74faad6e64b07">BlockParams::VZCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> DV3 = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>]</div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>                                                * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>] * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span> </div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aec0849c7d091eab157bff24464f60af2">normV</a> = <a class="code hl_function" href="../../de/d31/_dispersion_8m.html#af276a2aede715061015c735080cf65df">sqrt</a>(<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a>*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> + <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a>*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> + <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>);</div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> VdotB_norm = (<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a90ad4bd5b920bf33a857dacf0ff8f520">B0</a>*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> + B1*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> + B2*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>)/<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aec0849c7d091eab157bff24464f60af2">normV</a>;</div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span>                                             <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> countAndGate = <a class="code hl_function" href="../../d8/dbc/vectorclass__fallback_8h.html#ae83b95cd4defb63faf66a7cbc78801e6">floor</a>(VdotB_norm/cosAngle);  <span class="comment">// gate function: 0 outside loss cone, 1 inside</span></div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>                                             countAndGate = <a class="code hl_function" href="../../d8/dbc/vectorclass__fallback_8h.html#a92b2075c51472d120e4ef0a663e3814b">max</a>(0.,countAndGate);</div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> energy = <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a> * mass * <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aec0849c7d091eab157bff24464f60af2">normV</a>*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aec0849c7d091eab157bff24464f60af2">normV</a>; <span class="comment">// in SI</span></div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span> </div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>                                             <span class="comment">// Find the correct energy bin number to update</span></div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span>                                             <span class="keywordtype">int</span> binNumber = round((log(energy) - log(eminLocal)) / log(emaxLocal/eminLocal) * (nChannelsLocal-1));</div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span>                                             binNumber = <a class="code hl_function" href="../../d8/dbc/vectorclass__fallback_8h.html#a92b2075c51472d120e4ef0a663e3814b">max</a>(binNumber,0); <span class="comment">// anything &lt; emin goes to the lowest channel</span></div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span>                                             binNumber = <a class="code hl_function" href="../../d8/dbc/vectorclass__fallback_8h.html#a1896c5fbdb17de74189d1d18cdd4cf29">min</a>(binNumber,nChannelsLocal-1); <span class="comment">// anything &gt; emax goes to the highest channel</span></div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span> </div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span>                                             lsum[binNumber] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * countAndGate * <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aec0849c7d091eab157bff24464f60af2">normV</a>*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aec0849c7d091eab157bff24464f60af2">normV</a> * DV3;</div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span>                                             lsum[nChannelsLocal + binNumber] += countAndGate * DV3;</div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span>                                          }, sum);</div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span> </div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span>         <span class="comment">// Place ARCH results in correct buffers</span></div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span>         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>=0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>&lt;<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a5a0a25b1de510ac22d9654462152a977">nChannels</a>; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++) {</div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span>            <a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a845b8ff3136cb26783219ab9f6b723dd">dataDiffFlux</a>[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] += sum[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span>            sumWeights[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] += sum[<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a5a0a25b1de510ac22d9654462152a977">nChannels</a> + <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span>         }</div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span>      }</div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span> </div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span>      <span class="comment">// Averaging within each bin and conversion to unit of part. cm-2 s-1 sr-1 ev-1</span></div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>=0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>&lt;<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a5a0a25b1de510ac22d9654462152a977">nChannels</a>; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++) {</div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span>         <span class="keywordflow">if</span> (sumWeights[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] != 0) {</div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span>            <a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a845b8ff3136cb26783219ab9f6b723dd">dataDiffFlux</a>[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] *= 1.0 / (<a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a0766447359b57dc5727154ca296f9d76">popID</a>].mass * sumWeights[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>]) * <a class="code hl_variable" href="../../d7/d2f/namespacephysicalconstants.html#a3b6b084bee2f2d9da50526b722487f0e">physicalconstants::CHARGE</a> * 1.0e-4;</div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span>         }</div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"> 1437</span>      }</div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span> </div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a845b8ff3136cb26783219ab9f6b723dd">dataDiffFlux</a>.data());</div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; <a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a5a0a25b1de510ac22d9654462152a977">nChannels</a>*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span>   }</div>
</div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span> </div>
<div class="foldopen" id="foldopen01444" data-start="{" data-end="}">
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"><a class="line" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a958c6b3a402f9b695ba6577febb05c86"> 1444</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a958c6b3a402f9b695ba6577febb05c86">VariablePrecipitationDiffFlux::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span>   }</div>
</div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span> </div>
<div class="foldopen" id="foldopen01448" data-start="{" data-end="}">
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"><a class="line" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a2dc9aea62424a7ebd0c9499ea4f8fb85"> 1448</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a2dc9aea62424a7ebd0c9499ea4f8fb85">VariablePrecipitationDiffFlux::writeParameters</a>(vlsv::Writer&amp; vlsvWriter) {</div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>=0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>&lt;<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a5a0a25b1de510ac22d9654462152a977">nChannels</a>; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++) {</div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"> 1450</span>         <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> channelev = <a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a688406b498318337fed03ad079c4d186">channels</a>[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>]/<a class="code hl_variable" href="../../d7/d2f/namespacephysicalconstants.html#a3b6b084bee2f2d9da50526b722487f0e">physicalconstants::CHARGE</a>; <span class="comment">// in eV</span></div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"> 1451</span>         <span class="keywordflow">if</span>( vlsvWriter.writeParameter(<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a4205814de8a8fa94bb31b95c925cbc06">popName</a>+<span class="stringliteral">&quot;_PrecipitationCentreEnergy&quot;</span>+std::to_string(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>), &amp;channelev) == <span class="keyword">false</span> ) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"> 1452</span>      }</div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span>      <span class="keywordflow">if</span>( vlsvWriter.writeParameter(<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a4205814de8a8fa94bb31b95c925cbc06">popName</a>+<span class="stringliteral">&quot;_LossConeAngle&quot;</span>, &amp;<a class="code hl_variable" href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#ac2a5b3429c5762a8da06d90ee1237190">lossConeAngle</a>) == <span class="keyword">false</span> ) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span>   }</div>
</div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span></div>
<div class="foldopen" id="foldopen01459" data-start="{" data-end="}">
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"><a class="line" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a347fbd097e5c7af798233a8fc503d5fb"> 1459</a></span>   <a class="code hl_function" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a347fbd097e5c7af798233a8fc503d5fb">VariableMuSpace::VariableMuSpace</a>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> _popID): <a class="code hl_function" href="../../de/d11/class_d_r_o_1_1_data_reduction_operator_has_parameters.html#afb4eb20318147a30a2a180bafc8d0edb">DataReductionOperatorHasParameters</a>(),<a class="code hl_variable" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a3a7b647f76f584053946b33790694a00">popID</a>(_popID) {</div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span>      <a class="code hl_variable" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a057a53fbbce95d4cedd400f0c5a6b705">popName</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a3a7b647f76f584053946b33790694a00">popID</a>].name;</div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span>      <a class="code hl_variable" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a993f219e3d1ff6c830a3c6421e254a29">nBins</a> = <a class="code hl_variable" href="../../d0/dbf/struct_parameters.html#ad1619d6b9d1fc4f197cea1663171cff6">Parameters::PADmubins</a>; <span class="comment">//Number of bins to build muSpace</span></div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"> 1462</span>   }</div>
</div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"><a class="line" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a51ea6a193661bd98a33e84d5ddbdcf06"> 1463</a></span>   <a class="code hl_function" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a51ea6a193661bd98a33e84d5ddbdcf06">VariableMuSpace::~VariableMuSpace</a>() { }</div>
<div class="line"><a id="l01464" name="l01464"></a><span class="lineno"> 1464</span> </div>
<div class="line"><a id="l01465" name="l01465"></a><span class="lineno"><a class="line" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a01226a729d7933f37ac4c86a9093624a"> 1465</a></span>   std::string <a class="code hl_function" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a01226a729d7933f37ac4c86a9093624a">VariableMuSpace::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a057a53fbbce95d4cedd400f0c5a6b705">popName</a> + <span class="stringliteral">&quot;/vg_1dmuspace&quot;</span>;}</div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span> </div>
<div class="foldopen" id="foldopen01467" data-start="{" data-end="}">
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"><a class="line" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#af7a7225b04d7ddacd1a8e0681ced4d8f"> 1467</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#af7a7225b04d7ddacd1a8e0681ced4d8f">VariableMuSpace::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span>      dataSize =  <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>);</div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span>      vectorSize = <a class="code hl_variable" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a993f219e3d1ff6c830a3c6421e254a29">nBins</a>;</div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span>   }</div>
</div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span> </div>
<div class="foldopen" id="foldopen01474" data-start="{" data-end="}">
<div class="line"><a id="l01474" name="l01474"></a><span class="lineno"><a class="line" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a6428de05a5d75559e5731c55e0b5fdc9"> 1474</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a6428de05a5d75559e5731c55e0b5fdc9">VariableMuSpace::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l01475" name="l01475"></a><span class="lineno"> 1475</span> </div>
<div class="line"><a id="l01476" name="l01476"></a><span class="lineno"> 1476</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a6760bdacc1d8a5bb4c1a42e1103f0064">Realf</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aa516981a6e37a1d3e88478e289d085c9">dmubins</a> = 2.0 / <a class="code hl_variable" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a993f219e3d1ff6c830a3c6421e254a29">nBins</a>;</div>
<div class="line"><a id="l01477" name="l01477"></a><span class="lineno"> 1477</span>      std::vector&lt;Real&gt; fmu(<a class="code hl_variable" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a993f219e3d1ff6c830a3c6421e254a29">nBins</a>,0.0);</div>
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"> 1478</span> </div>
<div class="line"><a id="l01479" name="l01479"></a><span class="lineno"> 1479</span><span class="preprocessor">      #ifdef USE_GPU</span></div>
<div class="line"><a id="l01480" name="l01480"></a><span class="lineno"> 1480</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ae0f93c317e351510eeaeaf8a57bf3f79">dev_get_velocity_blocks</a>(<a class="code hl_variable" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a3a7b647f76f584053946b33790694a00">popID</a>);</div>
<div class="line"><a id="l01481" name="l01481"></a><span class="lineno"> 1481</span><span class="preprocessor">      #else</span></div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"> 1482</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a1dc25bb724906fa5d6dd76096cb7b9a4">get_velocity_blocks</a>(<a class="code hl_variable" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a3a7b647f76f584053946b33790694a00">popID</a>);</div>
<div class="line"><a id="l01483" name="l01483"></a><span class="lineno"> 1483</span><span class="preprocessor">      #endif</span></div>
<div class="line"><a id="l01484" name="l01484"></a><span class="lineno"> 1484</span> </div>
<div class="line"><a id="l01485" name="l01485"></a><span class="lineno"> 1485</span>      <span class="comment">// ARCH interface includes OpenMP looping including critical regions for thread summation</span></div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"> 1486</span>      {</div>
<div class="line"><a id="l01487" name="l01487"></a><span class="lineno"> 1487</span>         <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> bulkVX = cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a75e41e45c0e401d091dad2e29dde4909">CellParams::VX</a>];</div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span>         <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> bulkVY = cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840af916b65768e628165d616adb69c30441">CellParams::VY</a>];</div>
<div class="line"><a id="l01489" name="l01489"></a><span class="lineno"> 1489</span>         <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> bulkVZ = cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a2de546e2cd563cbb4d339f823c28fc7f">CellParams::VZ</a>];</div>
<div class="line"><a id="l01490" name="l01490"></a><span class="lineno"> 1490</span> </div>
<div class="line"><a id="l01491" name="l01491"></a><span class="lineno"> 1491</span>         <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a90ad4bd5b920bf33a857dacf0ff8f520">B0</a> = cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a50f3584d2fa8255ba2df24d8b01d8a83">CellParams::PERBXVOL</a>] +  cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a0b14dcc916a785f309ca6c122d8acecb">CellParams::BGBXVOL</a>];</div>
<div class="line"><a id="l01492" name="l01492"></a><span class="lineno"> 1492</span>         <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> B1 = cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840ac44a0b8ba721d489ba7f5d0e74c592ac">CellParams::PERBYVOL</a>] +  cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840ae5c6d66d7d0c73858a1c8ca46f5952a5">CellParams::BGBYVOL</a>];</div>
<div class="line"><a id="l01493" name="l01493"></a><span class="lineno"> 1493</span>         <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> B2 = cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840ad9d470cda28e4d96059ae0a1335552e5">CellParams::PERBZVOL</a>] +  cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a8d84d511a8af5fc3860564fbf862845e">CellParams::BGBZVOL</a>];</div>
<div class="line"><a id="l01494" name="l01494"></a><span class="lineno"> 1494</span>         <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> Bnorm = <a class="code hl_function" href="../../de/d31/_dispersion_8m.html#af276a2aede715061015c735080cf65df">sqrt</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a90ad4bd5b920bf33a857dacf0ff8f520">B0</a>*<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a90ad4bd5b920bf33a857dacf0ff8f520">B0</a> + B1*B1 + B2*B2);</div>
<div class="line"><a id="l01495" name="l01495"></a><span class="lineno"> 1495</span>         <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> b0 = <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a90ad4bd5b920bf33a857dacf0ff8f520">B0</a>/Bnorm;</div>
<div class="line"><a id="l01496" name="l01496"></a><span class="lineno"> 1496</span>         <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> b1 = B1/Bnorm;</div>
<div class="line"><a id="l01497" name="l01497"></a><span class="lineno"> 1497</span>         <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> b2 = B2/Bnorm;</div>
<div class="line"><a id="l01498" name="l01498"></a><span class="lineno"> 1498</span>         <span class="keyword">const</span> <span class="keywordtype">int</span> nBins_lambda = <a class="code hl_variable" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a993f219e3d1ff6c830a3c6421e254a29">nBins</a>; <span class="comment">// so lambda does not need to capture *this</span></div>
<div class="line"><a id="l01499" name="l01499"></a><span class="lineno"> 1499</span> </div>
<div class="line"><a id="l01500" name="l01500"></a><span class="lineno"> 1500</span>         <span class="keywordflow">if</span> (cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(<a class="code hl_variable" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a3a7b647f76f584053946b33790694a00">popID</a>) != 0)</div>
<div class="line"><a id="l01501" name="l01501"></a><span class="lineno"> 1501</span>         <a class="code hl_function" href="../../d9/d6a/namespacearch.html#a8b44f7f5126702d29110d539cdfbd7e8">arch::parallel_reduce&lt;arch::sum&gt;</a>({<a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, (uint)cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(<a class="code hl_variable" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a3a7b647f76f584053946b33790694a00">popID</a>)},</div>
<div class="line"><a id="l01502" name="l01502"></a><span class="lineno"> 1502</span>                                          <a class="code hl_define" href="../../db/d79/arch__device__cuda_8h.html#abeccfbc804a98c6b06b7fc99c71dac5d">ARCH_LOOP_LAMBDA</a> (<span class="keyword">const</span> uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>, <span class="keyword">const</span> uint n, <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *lsum )-&gt; <span class="keywordtype">void</span> {</div>
<div class="line"><a id="l01503" name="l01503"></a><span class="lineno"> 1503</span> </div>
<div class="line"><a id="l01504" name="l01504"></a><span class="lineno"> 1504</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a6760bdacc1d8a5bb4c1a42e1103f0064">Realf</a> *block_data = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab577ace09cdc66074a7cdc3d79394cfb">getData</a>(n);</div>
<div class="line"><a id="l01505" name="l01505"></a><span class="lineno"> 1505</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *block_parameters = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab492eded4908cb97927ddc54a0f3d9d3">getParameters</a>(n);</div>
<div class="line"><a id="l01506" name="l01506"></a><span class="lineno"> 1506</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856ace98fdb03651c50d1123499280fcb7ba">BlockParams::VXCRD</a>] + (<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>];</div>
<div class="line"><a id="l01507" name="l01507"></a><span class="lineno"> 1507</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856addc5022ec6d36b0fc9a73d025cc14485">BlockParams::VYCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>];</div>
<div class="line"><a id="l01508" name="l01508"></a><span class="lineno"> 1508</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aa4ae61e72bc15b4114a74faad6e64b07">BlockParams::VZCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l01509" name="l01509"></a><span class="lineno"> 1509</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> DV3 = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>]</div>
<div class="line"><a id="l01510" name="l01510"></a><span class="lineno"> 1510</span>                                                * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>] * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l01511" name="l01511"></a><span class="lineno"> 1511</span> </div>
<div class="line"><a id="l01512" name="l01512"></a><span class="lineno"> 1512</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ac46a17c4331f41374ce5f93f1044923b">VplasmaX</a> = <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> - bulkVX;</div>
<div class="line"><a id="l01513" name="l01513"></a><span class="lineno"> 1513</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a81874eae0012af6e53e97218e4e4a15f">VplasmaY</a> = <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> - bulkVY;</div>
<div class="line"><a id="l01514" name="l01514"></a><span class="lineno"> 1514</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a4d50c87f20e327a2879cb368ebe14a48">VplasmaZ</a> = <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> - bulkVZ;</div>
<div class="line"><a id="l01515" name="l01515"></a><span class="lineno"> 1515</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aec0849c7d091eab157bff24464f60af2">normV</a> = <a class="code hl_function" href="../../de/d31/_dispersion_8m.html#af276a2aede715061015c735080cf65df">sqrt</a>(<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ac46a17c4331f41374ce5f93f1044923b">VplasmaX</a>*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ac46a17c4331f41374ce5f93f1044923b">VplasmaX</a> + <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a81874eae0012af6e53e97218e4e4a15f">VplasmaY</a>*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a81874eae0012af6e53e97218e4e4a15f">VplasmaY</a> + <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a4d50c87f20e327a2879cb368ebe14a48">VplasmaZ</a>*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a4d50c87f20e327a2879cb368ebe14a48">VplasmaZ</a>);</div>
<div class="line"><a id="l01516" name="l01516"></a><span class="lineno"> 1516</span> </div>
<div class="line"><a id="l01517" name="l01517"></a><span class="lineno"> 1517</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae7b9d5f1a2beb5e993da2c8410e9a710">Vpara</a> = <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ac46a17c4331f41374ce5f93f1044923b">VplasmaX</a>*b0 + <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a81874eae0012af6e53e97218e4e4a15f">VplasmaY</a>*b1 + <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a4d50c87f20e327a2879cb368ebe14a48">VplasmaZ</a>*b2;</div>
<div class="line"><a id="l01518" name="l01518"></a><span class="lineno"> 1518</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a6040775a62badb3287320f921e52aac0">mu</a> = <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae7b9d5f1a2beb5e993da2c8410e9a710">Vpara</a>/(<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aec0849c7d091eab157bff24464f60af2">normV</a>+std::numeric_limits&lt;Realf&gt;::min()); <span class="comment">// + min value to avoid division by 0</span></div>
<div class="line"><a id="l01519" name="l01519"></a><span class="lineno"> 1519</span>                                             <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#abfa9553f301f5f29fe26a8d8f19a20da">muindex</a> = <a class="code hl_function" href="../../d8/dbc/vectorclass__fallback_8h.html#ae83b95cd4defb63faf66a7cbc78801e6">floor</a>((<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a6040775a62badb3287320f921e52aac0">mu</a>+1.0) / <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aa516981a6e37a1d3e88478e289d085c9">dmubins</a>);</div>
<div class="line"><a id="l01520" name="l01520"></a><span class="lineno"> 1520</span>                                             <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#abfa9553f301f5f29fe26a8d8f19a20da">muindex</a> = std::max(0,std::min(<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#abfa9553f301f5f29fe26a8d8f19a20da">muindex</a>,nBins_lambda-1));</div>
<div class="line"><a id="l01521" name="l01521"></a><span class="lineno"> 1521</span> </div>
<div class="line"><a id="l01522" name="l01522"></a><span class="lineno"> 1522</span>                                             lsum[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#abfa9553f301f5f29fe26a8d8f19a20da">muindex</a>] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * DV3 / <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aa516981a6e37a1d3e88478e289d085c9">dmubins</a>;</div>
<div class="line"><a id="l01523" name="l01523"></a><span class="lineno"> 1523</span>                                          }, fmu);</div>
<div class="line"><a id="l01524" name="l01524"></a><span class="lineno"> 1524</span>      }</div>
<div class="line"><a id="l01525" name="l01525"></a><span class="lineno"> 1525</span> </div>
<div class="line"><a id="l01526" name="l01526"></a><span class="lineno"> 1526</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(fmu.data());</div>
<div class="line"><a id="l01527" name="l01527"></a><span class="lineno"> 1527</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; <a class="code hl_variable" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a993f219e3d1ff6c830a3c6421e254a29">nBins</a>*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l01528" name="l01528"></a><span class="lineno"> 1528</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01529" name="l01529"></a><span class="lineno"> 1529</span>   }</div>
</div>
<div class="line"><a id="l01530" name="l01530"></a><span class="lineno"> 1530</span> </div>
<div class="foldopen" id="foldopen01531" data-start="{" data-end="}">
<div class="line"><a id="l01531" name="l01531"></a><span class="lineno"><a class="line" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a4a0dc6ab33464086c84d02f3a9d975e9"> 1531</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a4a0dc6ab33464086c84d02f3a9d975e9">VariableMuSpace::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l01532" name="l01532"></a><span class="lineno"> 1532</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01533" name="l01533"></a><span class="lineno"> 1533</span>   }</div>
</div>
<div class="line"><a id="l01534" name="l01534"></a><span class="lineno"> 1534</span> </div>
<div class="foldopen" id="foldopen01535" data-start="{" data-end="}">
<div class="line"><a id="l01535" name="l01535"></a><span class="lineno"><a class="line" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#aaebcf60db3207f08e2fbf0c17bf9e83e"> 1535</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#aaebcf60db3207f08e2fbf0c17bf9e83e">VariableMuSpace::writeParameters</a>(vlsv::Writer&amp; vlsvWriter) {</div>
<div class="line"><a id="l01536" name="l01536"></a><span class="lineno"> 1536</span>       <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01537" name="l01537"></a><span class="lineno"> 1537</span>   }</div>
</div>
<div class="line"><a id="l01538" name="l01538"></a><span class="lineno"> 1538</span></div>
<div class="foldopen" id="foldopen01548" data-start="{" data-end="}">
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"><a class="line" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#ace1f4e97f711f0c2077147ae8c594175"> 1548</a></span>   <a class="code hl_function" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#ace1f4e97f711f0c2077147ae8c594175">VariablePrecipitationLineDiffFlux::VariablePrecipitationLineDiffFlux</a>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> _popID): <a class="code hl_function" href="../../de/d11/class_d_r_o_1_1_data_reduction_operator_has_parameters.html#afb4eb20318147a30a2a180bafc8d0edb">DataReductionOperatorHasParameters</a>(),<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#abaad43f6701f4158e0423cceca255089">popID</a>(_popID) {</div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span>      <a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a6ab3d21b25488cd96f01fdf85b974c5e">popName</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#abaad43f6701f4158e0423cceca255089">popID</a>].name;</div>
<div class="line"><a id="l01550" name="l01550"></a><span class="lineno"> 1550</span>      <a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#aa4d3b4a525d0238b47c89d7697374856">emin</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#abaad43f6701f4158e0423cceca255089">popID</a>].precipitationEmin;    <span class="comment">// already converted to SI</span></div>
<div class="line"><a id="l01551" name="l01551"></a><span class="lineno"> 1551</span>      <a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a09113b265dfbde206eefea5674fc49b0">emax</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#abaad43f6701f4158e0423cceca255089">popID</a>].precipitationEmax;    <span class="comment">// already converted to SI</span></div>
<div class="line"><a id="l01552" name="l01552"></a><span class="lineno"> 1552</span>      <a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a54b5f9dc2c38818b559f88ab9bef9f2e">nChannels</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#abaad43f6701f4158e0423cceca255089">popID</a>].precipitationNChannels; <span class="comment">// number of energy channels, logarithmically spaced between emin and emax</span></div>
<div class="line"><a id="l01553" name="l01553"></a><span class="lineno"> 1553</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>=0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>&lt;<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a54b5f9dc2c38818b559f88ab9bef9f2e">nChannels</a>; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++){</div>
<div class="line"><a id="l01554" name="l01554"></a><span class="lineno"> 1554</span>         <a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a7868800003996655b2e87b1293430cd1">channels</a>.push_back(<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#aa4d3b4a525d0238b47c89d7697374856">emin</a> * pow(<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a09113b265dfbde206eefea5674fc49b0">emax</a>/<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#aa4d3b4a525d0238b47c89d7697374856">emin</a>,(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>)<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>/(<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a54b5f9dc2c38818b559f88ab9bef9f2e">nChannels</a>-1)));</div>
<div class="line"><a id="l01555" name="l01555"></a><span class="lineno"> 1555</span>      }</div>
<div class="line"><a id="l01556" name="l01556"></a><span class="lineno"> 1556</span>   }</div>
</div>
<div class="line"><a id="l01557" name="l01557"></a><span class="lineno"><a class="line" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a93cfd229d05b1e0c0b3673bd4409deaa"> 1557</a></span>   <a class="code hl_function" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a93cfd229d05b1e0c0b3673bd4409deaa">VariablePrecipitationLineDiffFlux::~VariablePrecipitationLineDiffFlux</a>() { }</div>
<div class="line"><a id="l01558" name="l01558"></a><span class="lineno"> 1558</span> </div>
<div class="line"><a id="l01559" name="l01559"></a><span class="lineno"><a class="line" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a30e178bf1427555c158796a3b07a1168"> 1559</a></span>   std::string <a class="code hl_function" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a30e178bf1427555c158796a3b07a1168">VariablePrecipitationLineDiffFlux::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a6ab3d21b25488cd96f01fdf85b974c5e">popName</a> + <span class="stringliteral">&quot;/vg_precipitationlinedifferentialflux&quot;</span>;}</div>
<div class="line"><a id="l01560" name="l01560"></a><span class="lineno"> 1560</span> </div>
<div class="foldopen" id="foldopen01561" data-start="{" data-end="}">
<div class="line"><a id="l01561" name="l01561"></a><span class="lineno"><a class="line" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#ae5c7d89896343fd468d98a980a08576a"> 1561</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#ae5c7d89896343fd468d98a980a08576a">VariablePrecipitationLineDiffFlux::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01562" name="l01562"></a><span class="lineno"> 1562</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l01563" name="l01563"></a><span class="lineno"> 1563</span>      dataSize =  <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>);</div>
<div class="line"><a id="l01564" name="l01564"></a><span class="lineno"> 1564</span>      vectorSize = <a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a54b5f9dc2c38818b559f88ab9bef9f2e">nChannels</a>; <span class="comment">//Number of energy channels</span></div>
<div class="line"><a id="l01565" name="l01565"></a><span class="lineno"> 1565</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01566" name="l01566"></a><span class="lineno"> 1566</span>   }</div>
</div>
<div class="line"><a id="l01567" name="l01567"></a><span class="lineno"> 1567</span> </div>
<div class="foldopen" id="foldopen01568" data-start="{" data-end="}">
<div class="line"><a id="l01568" name="l01568"></a><span class="lineno"><a class="line" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#af93f48e206bc3ea61dc1d10490cd5539"> 1568</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#af93f48e206bc3ea61dc1d10490cd5539">VariablePrecipitationLineDiffFlux::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l01569" name="l01569"></a><span class="lineno"> 1569</span> </div>
<div class="line"><a id="l01570" name="l01570"></a><span class="lineno"> 1570</span>      <a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#acc2c214e6e1776407df9c44fef234bbc">dataLineDiffFlux</a>.assign(<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a54b5f9dc2c38818b559f88ab9bef9f2e">nChannels</a>,0.0);</div>
<div class="line"><a id="l01571" name="l01571"></a><span class="lineno"> 1571</span> </div>
<div class="line"><a id="l01572" name="l01572"></a><span class="lineno"> 1572</span>      std::vector&lt;Real&gt; sumWeights(<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a54b5f9dc2c38818b559f88ab9bef9f2e">nChannels</a>,0.0);</div>
<div class="line"><a id="l01573" name="l01573"></a><span class="lineno"> 1573</span> </div>
<div class="line"><a id="l01574" name="l01574"></a><span class="lineno"> 1574</span>      std::array&lt;Real,3&gt; B;</div>
<div class="line"><a id="l01575" name="l01575"></a><span class="lineno"> 1575</span>      B[0] = cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a50f3584d2fa8255ba2df24d8b01d8a83">CellParams::PERBXVOL</a>] +  cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a0b14dcc916a785f309ca6c122d8acecb">CellParams::BGBXVOL</a>];</div>
<div class="line"><a id="l01576" name="l01576"></a><span class="lineno"> 1576</span>      B[1] = cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840ac44a0b8ba721d489ba7f5d0e74c592ac">CellParams::PERBYVOL</a>] +  cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840ae5c6d66d7d0c73858a1c8ca46f5952a5">CellParams::BGBYVOL</a>];</div>
<div class="line"><a id="l01577" name="l01577"></a><span class="lineno"> 1577</span>      B[2] = cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840ad9d470cda28e4d96059ae0a1335552e5">CellParams::PERBZVOL</a>] +  cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a8d84d511a8af5fc3860564fbf862845e">CellParams::BGBZVOL</a>];</div>
<div class="line"><a id="l01578" name="l01578"></a><span class="lineno"> 1578</span> </div>
<div class="line"><a id="l01579" name="l01579"></a><span class="lineno"> 1579</span>      <span class="comment">// Unit B-field direction</span></div>
<div class="line"><a id="l01580" name="l01580"></a><span class="lineno"> 1580</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#add503fc20115bd5669fb3e0fe4fd344f">creal</a> normB = <a class="code hl_function" href="../../de/d31/_dispersion_8m.html#af276a2aede715061015c735080cf65df">sqrt</a>(B[0]*B[0] + B[1]*B[1] + B[2]*B[2]);</div>
<div class="line"><a id="l01581" name="l01581"></a><span class="lineno"> 1581</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>=0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>&lt;3; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++){</div>
<div class="line"><a id="l01582" name="l01582"></a><span class="lineno"> 1582</span>         B[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] /= normB;</div>
<div class="line"><a id="l01583" name="l01583"></a><span class="lineno"> 1583</span>      }</div>
<div class="line"><a id="l01584" name="l01584"></a><span class="lineno"> 1584</span> </div>
<div class="line"><a id="l01585" name="l01585"></a><span class="lineno"> 1585</span>      <span class="comment">// If southern hemisphere, precipitation is along -B</span></div>
<div class="line"><a id="l01586" name="l01586"></a><span class="lineno"> 1586</span>      <span class="keywordflow">if</span> (cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a469ec6fde1e7d76a72800cd322b733d2">CellParams::ZCRD</a>] + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>*cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840ad5a8e812e459b91b7148798568c469a1">CellParams::DZ</a>] &lt; 0.0){</div>
<div class="line"><a id="l01587" name="l01587"></a><span class="lineno"> 1587</span>         <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>=0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>&lt;3; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++){</div>
<div class="line"><a id="l01588" name="l01588"></a><span class="lineno"> 1588</span>            B[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = -B[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l01589" name="l01589"></a><span class="lineno"> 1589</span>         }</div>
<div class="line"><a id="l01590" name="l01590"></a><span class="lineno"> 1590</span>      }</div>
<div class="line"><a id="l01591" name="l01591"></a><span class="lineno"> 1591</span> </div>
<div class="line"><a id="l01592" name="l01592"></a><span class="lineno"> 1592</span>      <span class="comment">// ARCH interface includes OpenMP looping including critical regions for thread summation</span></div>
<div class="line"><a id="l01593" name="l01593"></a><span class="lineno"> 1593</span>      {</div>
<div class="line"><a id="l01594" name="l01594"></a><span class="lineno"> 1594</span><span class="preprocessor">         #ifdef USE_GPU</span></div>
<div class="line"><a id="l01595" name="l01595"></a><span class="lineno"> 1595</span>         <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ae0f93c317e351510eeaeaf8a57bf3f79">dev_get_velocity_blocks</a>(<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#abaad43f6701f4158e0423cceca255089">popID</a>);</div>
<div class="line"><a id="l01596" name="l01596"></a><span class="lineno"> 1596</span><span class="preprocessor">         #else</span></div>
<div class="line"><a id="l01597" name="l01597"></a><span class="lineno"> 1597</span>         <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a1dc25bb724906fa5d6dd76096cb7b9a4">get_velocity_blocks</a>(<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#abaad43f6701f4158e0423cceca255089">popID</a>);</div>
<div class="line"><a id="l01598" name="l01598"></a><span class="lineno"> 1598</span><span class="preprocessor">         #endif</span></div>
<div class="line"><a id="l01599" name="l01599"></a><span class="lineno"> 1599</span> </div>
<div class="line"><a id="l01600" name="l01600"></a><span class="lineno"> 1600</span>         std::vector&lt;Real&gt; sum(2 * <a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a54b5f9dc2c38818b559f88ab9bef9f2e">nChannels</a>,0.0);</div>
<div class="line"><a id="l01601" name="l01601"></a><span class="lineno"> 1601</span>         <span class="keywordtype">int</span> nChannelsLocal = <a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a54b5f9dc2c38818b559f88ab9bef9f2e">nChannels</a>;</div>
<div class="line"><a id="l01602" name="l01602"></a><span class="lineno"> 1602</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a90ad4bd5b920bf33a857dacf0ff8f520">B0</a> = B[0];</div>
<div class="line"><a id="l01603" name="l01603"></a><span class="lineno"> 1603</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> B1 = B[1];</div>
<div class="line"><a id="l01604" name="l01604"></a><span class="lineno"> 1604</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> B2 = B[2];</div>
<div class="line"><a id="l01605" name="l01605"></a><span class="lineno"> 1605</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> emaxLocal = <a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a09113b265dfbde206eefea5674fc49b0">emax</a>;</div>
<div class="line"><a id="l01606" name="l01606"></a><span class="lineno"> 1606</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> eminLocal = <a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#aa4d3b4a525d0238b47c89d7697374856">emin</a>;</div>
<div class="line"><a id="l01607" name="l01607"></a><span class="lineno"> 1607</span>         <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> mass = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#abaad43f6701f4158e0423cceca255089">popID</a>].mass;</div>
<div class="line"><a id="l01608" name="l01608"></a><span class="lineno"> 1608</span> </div>
<div class="line"><a id="l01609" name="l01609"></a><span class="lineno"> 1609</span>         <span class="keywordflow">if</span> (cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#abaad43f6701f4158e0423cceca255089">popID</a>) != 0)</div>
<div class="line"><a id="l01610" name="l01610"></a><span class="lineno"> 1610</span>         <a class="code hl_function" href="../../d9/d6a/namespacearch.html#a8b44f7f5126702d29110d539cdfbd7e8">arch::parallel_reduce&lt;arch::sum&gt;</a>({<a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, (uint)cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#abaad43f6701f4158e0423cceca255089">popID</a>)},</div>
<div class="line"><a id="l01611" name="l01611"></a><span class="lineno"> 1611</span>                                          <a class="code hl_define" href="../../db/d79/arch__device__cuda_8h.html#abeccfbc804a98c6b06b7fc99c71dac5d">ARCH_LOOP_LAMBDA</a>(<span class="keyword">const</span> uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>, <span class="keyword">const</span> uint n, <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *lsum ){</div>
<div class="line"><a id="l01612" name="l01612"></a><span class="lineno"> 1612</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a6760bdacc1d8a5bb4c1a42e1103f0064">Realf</a> *block_data = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab577ace09cdc66074a7cdc3d79394cfb">getData</a>(n);</div>
<div class="line"><a id="l01613" name="l01613"></a><span class="lineno"> 1613</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *block_parameters = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab492eded4908cb97927ddc54a0f3d9d3">getParameters</a>(n);</div>
<div class="line"><a id="l01614" name="l01614"></a><span class="lineno"> 1614</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856ace98fdb03651c50d1123499280fcb7ba">BlockParams::VXCRD</a>] + (<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>];</div>
<div class="line"><a id="l01615" name="l01615"></a><span class="lineno"> 1615</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856addc5022ec6d36b0fc9a73d025cc14485">BlockParams::VYCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>];</div>
<div class="line"><a id="l01616" name="l01616"></a><span class="lineno"> 1616</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aa4ae61e72bc15b4114a74faad6e64b07">BlockParams::VZCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l01617" name="l01617"></a><span class="lineno"> 1617</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> DV3 = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>]</div>
<div class="line"><a id="l01618" name="l01618"></a><span class="lineno"> 1618</span>                  * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>] * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l01619" name="l01619"></a><span class="lineno"> 1619</span> </div>
<div class="line"><a id="l01620" name="l01620"></a><span class="lineno"> 1620</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aec0849c7d091eab157bff24464f60af2">normV</a> = <a class="code hl_function" href="../../de/d31/_dispersion_8m.html#af276a2aede715061015c735080cf65df">sqrt</a>(<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a>*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> + <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a>*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> + <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>);</div>
<div class="line"><a id="l01621" name="l01621"></a><span class="lineno"> 1621</span>               <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> BnormV[3];</div>
<div class="line"><a id="l01622" name="l01622"></a><span class="lineno"> 1622</span>               BnormV[0] = <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a90ad4bd5b920bf33a857dacf0ff8f520">B0</a> * <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aec0849c7d091eab157bff24464f60af2">normV</a>;</div>
<div class="line"><a id="l01623" name="l01623"></a><span class="lineno"> 1623</span>               BnormV[1] = B1 * <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aec0849c7d091eab157bff24464f60af2">normV</a>;</div>
<div class="line"><a id="l01624" name="l01624"></a><span class="lineno"> 1624</span>               BnormV[2] = B2 * <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aec0849c7d091eab157bff24464f60af2">normV</a>;</div>
<div class="line"><a id="l01625" name="l01625"></a><span class="lineno"> 1625</span> </div>
<div class="line"><a id="l01626" name="l01626"></a><span class="lineno"> 1626</span>               <span class="comment">// We will use a gate function based on criteria that Vi-HALF*DVi &lt;= BnormV[i] &lt;= Vi+HALF*DVi (for i=x,y,z or 0,1,2)</span></div>
<div class="line"><a id="l01627" name="l01627"></a><span class="lineno"> 1627</span>               <span class="keywordtype">bool</span> xGateCrit, yGateCrit, zGateCrit;</div>
<div class="line"><a id="l01628" name="l01628"></a><span class="lineno"> 1628</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> _DVX= block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>];</div>
<div class="line"><a id="l01629" name="l01629"></a><span class="lineno"> 1629</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> _DVY= block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>];</div>
<div class="line"><a id="l01630" name="l01630"></a><span class="lineno"> 1630</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> _DVZ= block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l01631" name="l01631"></a><span class="lineno"> 1631</span>               xGateCrit = (BnormV[0] - (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> - <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>*_DVX)) * (BnormV[0] - (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>*_DVX)) &lt;= 0;</div>
<div class="line"><a id="l01632" name="l01632"></a><span class="lineno"> 1632</span>               yGateCrit = (BnormV[1] - (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> - <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>*_DVY)) * (BnormV[1] - (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>*_DVY)) &lt;= 0;</div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"> 1633</span>               zGateCrit = (BnormV[2] - (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> - <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>*_DVZ)) * (BnormV[2] - (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>*_DVZ)) &lt;= 0;</div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span>               <span class="keywordtype">bool</span> xyzGateCrit = xGateCrit &amp;&amp; yGateCrit &amp;&amp; zGateCrit;  <span class="comment">// gate function: 1 if the line goes through the v-cell, else 0.</span></div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span>               <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> countAndGate = (<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>) xyzGateCrit;</div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> energy = <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a> * mass * <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aec0849c7d091eab157bff24464f60af2">normV</a>*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aec0849c7d091eab157bff24464f60af2">normV</a>; <span class="comment">// in SI</span></div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"> 1637</span> </div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span>               <span class="comment">// Find the correct energy bin number to update</span></div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span>               <span class="keywordtype">int</span> binNumber = round((log(energy) - log(eminLocal)) / log(emaxLocal/eminLocal) * (nChannelsLocal-1));</div>
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"> 1640</span>               binNumber = <a class="code hl_function" href="../../d8/dbc/vectorclass__fallback_8h.html#a92b2075c51472d120e4ef0a663e3814b">max</a>(binNumber,0); <span class="comment">// anything &lt; eminLocal goes to the lowest channel</span></div>
<div class="line"><a id="l01641" name="l01641"></a><span class="lineno"> 1641</span>               binNumber = <a class="code hl_function" href="../../d8/dbc/vectorclass__fallback_8h.html#a1896c5fbdb17de74189d1d18cdd4cf29">min</a>(binNumber,nChannelsLocal-1); <span class="comment">// anything &gt; emaxLocal goes to the highest channel</span></div>
<div class="line"><a id="l01642" name="l01642"></a><span class="lineno"> 1642</span> </div>
<div class="line"><a id="l01643" name="l01643"></a><span class="lineno"> 1643</span>               lsum[binNumber] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * countAndGate * <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aec0849c7d091eab157bff24464f60af2">normV</a>*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aec0849c7d091eab157bff24464f60af2">normV</a> * DV3;</div>
<div class="line"><a id="l01644" name="l01644"></a><span class="lineno"> 1644</span>               lsum[nChannelsLocal + binNumber] += countAndGate * DV3;</div>
<div class="line"><a id="l01645" name="l01645"></a><span class="lineno"> 1645</span>         }, sum);</div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span> </div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span>         <span class="comment">// Place ARCH results in correct buffers</span></div>
<div class="line"><a id="l01648" name="l01648"></a><span class="lineno"> 1648</span>         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>=0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>&lt;<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a54b5f9dc2c38818b559f88ab9bef9f2e">nChannels</a>; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++) {</div>
<div class="line"><a id="l01649" name="l01649"></a><span class="lineno"> 1649</span>            <a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#acc2c214e6e1776407df9c44fef234bbc">dataLineDiffFlux</a>[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] += sum[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l01650" name="l01650"></a><span class="lineno"> 1650</span>            sumWeights[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] += sum[<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a54b5f9dc2c38818b559f88ab9bef9f2e">nChannels</a> + <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l01651" name="l01651"></a><span class="lineno"> 1651</span>         }</div>
<div class="line"><a id="l01652" name="l01652"></a><span class="lineno"> 1652</span>      }</div>
<div class="line"><a id="l01653" name="l01653"></a><span class="lineno"> 1653</span> </div>
<div class="line"><a id="l01654" name="l01654"></a><span class="lineno"> 1654</span>      <span class="comment">// Averaging within each bin and conversion to unit of part. cm-2 s-1 sr-1 ev-1</span></div>
<div class="line"><a id="l01655" name="l01655"></a><span class="lineno"> 1655</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>=0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>&lt;<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a54b5f9dc2c38818b559f88ab9bef9f2e">nChannels</a>; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++) {</div>
<div class="line"><a id="l01656" name="l01656"></a><span class="lineno"> 1656</span>         <span class="keywordflow">if</span> (sumWeights[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] != 0) {</div>
<div class="line"><a id="l01657" name="l01657"></a><span class="lineno"> 1657</span>            <a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#acc2c214e6e1776407df9c44fef234bbc">dataLineDiffFlux</a>[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] *= 1.0 / (<a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#abaad43f6701f4158e0423cceca255089">popID</a>].mass * sumWeights[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>]) * <a class="code hl_variable" href="../../d7/d2f/namespacephysicalconstants.html#a3b6b084bee2f2d9da50526b722487f0e">physicalconstants::CHARGE</a> * 1.0e-4;</div>
<div class="line"><a id="l01658" name="l01658"></a><span class="lineno"> 1658</span>         }</div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span>      }</div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"> 1660</span> </div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#acc2c214e6e1776407df9c44fef234bbc">dataLineDiffFlux</a>.data());</div>
<div class="line"><a id="l01662" name="l01662"></a><span class="lineno"> 1662</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; <a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a54b5f9dc2c38818b559f88ab9bef9f2e">nChannels</a>*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l01663" name="l01663"></a><span class="lineno"> 1663</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01664" name="l01664"></a><span class="lineno"> 1664</span>   }</div>
</div>
<div class="line"><a id="l01665" name="l01665"></a><span class="lineno"> 1665</span> </div>
<div class="foldopen" id="foldopen01666" data-start="{" data-end="}">
<div class="line"><a id="l01666" name="l01666"></a><span class="lineno"><a class="line" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#ac14b3c3918e051eb5e42a2797ef69a07"> 1666</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#ac14b3c3918e051eb5e42a2797ef69a07">VariablePrecipitationLineDiffFlux::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l01667" name="l01667"></a><span class="lineno"> 1667</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01668" name="l01668"></a><span class="lineno"> 1668</span>   }</div>
</div>
<div class="line"><a id="l01669" name="l01669"></a><span class="lineno"> 1669</span> </div>
<div class="foldopen" id="foldopen01670" data-start="{" data-end="}">
<div class="line"><a id="l01670" name="l01670"></a><span class="lineno"><a class="line" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#afa2dcee8f3b0f97231b9fc29495862d5"> 1670</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#afa2dcee8f3b0f97231b9fc29495862d5">VariablePrecipitationLineDiffFlux::writeParameters</a>(vlsv::Writer&amp; vlsvWriter) {</div>
<div class="line"><a id="l01671" name="l01671"></a><span class="lineno"> 1671</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>=0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>&lt;<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a54b5f9dc2c38818b559f88ab9bef9f2e">nChannels</a>; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++) {</div>
<div class="line"><a id="l01672" name="l01672"></a><span class="lineno"> 1672</span>         <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> channelev = <a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a7868800003996655b2e87b1293430cd1">channels</a>[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>]/<a class="code hl_variable" href="../../d7/d2f/namespacephysicalconstants.html#a3b6b084bee2f2d9da50526b722487f0e">physicalconstants::CHARGE</a>; <span class="comment">// in eV</span></div>
<div class="line"><a id="l01673" name="l01673"></a><span class="lineno"> 1673</span>         <span class="keywordflow">if</span>( vlsvWriter.writeParameter(<a class="code hl_variable" href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a6ab3d21b25488cd96f01fdf85b974c5e">popName</a>+<span class="stringliteral">&quot;_PrecipitationCentreEnergyLine&quot;</span>+std::to_string(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>), &amp;channelev) == <span class="keyword">false</span> ) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a id="l01674" name="l01674"></a><span class="lineno"> 1674</span>      }</div>
<div class="line"><a id="l01675" name="l01675"></a><span class="lineno"> 1675</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01676" name="l01676"></a><span class="lineno"> 1676</span>   }</div>
</div>
<div class="line"><a id="l01677" name="l01677"></a><span class="lineno"> 1677</span></div>
<div class="foldopen" id="foldopen01691" data-start="{" data-end="}">
<div class="line"><a id="l01691" name="l01691"></a><span class="lineno"><a class="line" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a922245027b409e3109a80253cabec4ba"> 1691</a></span>   <a class="code hl_function" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a922245027b409e3109a80253cabec4ba">VariableEnergyDensity::VariableEnergyDensity</a>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> _popID): <a class="code hl_function" href="../../de/d11/class_d_r_o_1_1_data_reduction_operator_has_parameters.html#afb4eb20318147a30a2a180bafc8d0edb">DataReductionOperatorHasParameters</a>(),<a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a267ee7737fe146f856e2012d413ecc83">popID</a>(_popID) {</div>
<div class="line"><a id="l01692" name="l01692"></a><span class="lineno"> 1692</span>      <a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#acbe1767c02aeb889554738b0aa852b46">popName</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a267ee7737fe146f856e2012d413ecc83">popID</a>].name;</div>
<div class="line"><a id="l01693" name="l01693"></a><span class="lineno"> 1693</span>      <span class="comment">// Store internally in SI units</span></div>
<div class="line"><a id="l01694" name="l01694"></a><span class="lineno"> 1694</span>      <a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a81ec9c7f0b7fb4a26b8193de110d28a0">solarwindenergy</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a267ee7737fe146f856e2012d413ecc83">popID</a>].SolarWindEnergy;</div>
<div class="line"><a id="l01695" name="l01695"></a><span class="lineno"> 1695</span>      <a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#ab9bc820a8798f416be718b8cc4cf5bd1">E1limit</a> = <a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a81ec9c7f0b7fb4a26b8193de110d28a0">solarwindenergy</a> * <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a267ee7737fe146f856e2012d413ecc83">popID</a>].EnergyDensityLimit1;</div>
<div class="line"><a id="l01696" name="l01696"></a><span class="lineno"> 1696</span>      <a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#ac2dbbf6431c653a355a3b900d742f247">E2limit</a> = <a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a81ec9c7f0b7fb4a26b8193de110d28a0">solarwindenergy</a> * <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a267ee7737fe146f856e2012d413ecc83">popID</a>].EnergyDensityLimit2;</div>
<div class="line"><a id="l01697" name="l01697"></a><span class="lineno"> 1697</span>   }</div>
</div>
<div class="line"><a id="l01698" name="l01698"></a><span class="lineno"><a class="line" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#aebe77e9ad521702336ee3925f2519aff"> 1698</a></span>   <a class="code hl_function" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#aebe77e9ad521702336ee3925f2519aff">VariableEnergyDensity::~VariableEnergyDensity</a>() { }</div>
<div class="line"><a id="l01699" name="l01699"></a><span class="lineno"> 1699</span> </div>
<div class="line"><a id="l01700" name="l01700"></a><span class="lineno"><a class="line" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a230c51cbe9c380ed8f1c6cce08449efe"> 1700</a></span>   std::string <a class="code hl_function" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a230c51cbe9c380ed8f1c6cce08449efe">VariableEnergyDensity::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#acbe1767c02aeb889554738b0aa852b46">popName</a> + <span class="stringliteral">&quot;/vg_energydensity&quot;</span>;}</div>
<div class="line"><a id="l01701" name="l01701"></a><span class="lineno"> 1701</span> </div>
<div class="foldopen" id="foldopen01702" data-start="{" data-end="}">
<div class="line"><a id="l01702" name="l01702"></a><span class="lineno"><a class="line" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#aff42009d8f489b992c6b6d955758f3b8"> 1702</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#aff42009d8f489b992c6b6d955758f3b8">VariableEnergyDensity::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01703" name="l01703"></a><span class="lineno"> 1703</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l01704" name="l01704"></a><span class="lineno"> 1704</span>      dataSize =  <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>);</div>
<div class="line"><a id="l01705" name="l01705"></a><span class="lineno"> 1705</span>      vectorSize = 3; <span class="comment">// This is not components, but rather total energy density, density over E1, and density over E2</span></div>
<div class="line"><a id="l01706" name="l01706"></a><span class="lineno"> 1706</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01707" name="l01707"></a><span class="lineno"> 1707</span>   }</div>
</div>
<div class="line"><a id="l01708" name="l01708"></a><span class="lineno"> 1708</span> </div>
<div class="foldopen" id="foldopen01709" data-start="{" data-end="}">
<div class="line"><a id="l01709" name="l01709"></a><span class="lineno"><a class="line" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#afaf7b171c44df092dcb2e7f9affe02ee"> 1709</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#afaf7b171c44df092dcb2e7f9affe02ee">VariableEnergyDensity::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l01710" name="l01710"></a><span class="lineno"> 1710</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a> = 0.5;</div>
<div class="line"><a id="l01711" name="l01711"></a><span class="lineno"> 1711</span><span class="preprocessor">      #ifdef USE_GPU</span></div>
<div class="line"><a id="l01712" name="l01712"></a><span class="lineno"> 1712</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ae0f93c317e351510eeaeaf8a57bf3f79">dev_get_velocity_blocks</a>(<a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a267ee7737fe146f856e2012d413ecc83">popID</a>);</div>
<div class="line"><a id="l01713" name="l01713"></a><span class="lineno"> 1713</span><span class="preprocessor">      #else</span></div>
<div class="line"><a id="l01714" name="l01714"></a><span class="lineno"> 1714</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a1dc25bb724906fa5d6dd76096cb7b9a4">get_velocity_blocks</a>(<a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a267ee7737fe146f856e2012d413ecc83">popID</a>);</div>
<div class="line"><a id="l01715" name="l01715"></a><span class="lineno"> 1715</span><span class="preprocessor">      #endif</span></div>
<div class="line"><a id="l01716" name="l01716"></a><span class="lineno"> 1716</span> </div>
<div class="line"><a id="l01717" name="l01717"></a><span class="lineno"> 1717</span>      <span class="comment">// ARCH interface includes OpenMP looping including critical regions for thread summation</span></div>
<div class="line"><a id="l01718" name="l01718"></a><span class="lineno"> 1718</span>      {</div>
<div class="line"><a id="l01719" name="l01719"></a><span class="lineno"> 1719</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> sum[3] = {0.0, 0.0, 0.0};</div>
<div class="line"><a id="l01720" name="l01720"></a><span class="lineno"> 1720</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> E1limitLocal = <a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#ab9bc820a8798f416be718b8cc4cf5bd1">E1limit</a>;</div>
<div class="line"><a id="l01721" name="l01721"></a><span class="lineno"> 1721</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> E2limitLocal = <a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#ac2dbbf6431c653a355a3b900d742f247">E2limit</a>;</div>
<div class="line"><a id="l01722" name="l01722"></a><span class="lineno"> 1722</span>         <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> mass = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a267ee7737fe146f856e2012d413ecc83">popID</a>].mass;</div>
<div class="line"><a id="l01723" name="l01723"></a><span class="lineno"> 1723</span> </div>
<div class="line"><a id="l01724" name="l01724"></a><span class="lineno"> 1724</span>         <span class="keywordflow">if</span> (cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(<a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a267ee7737fe146f856e2012d413ecc83">popID</a>) != 0)</div>
<div class="line"><a id="l01725" name="l01725"></a><span class="lineno"> 1725</span>         <a class="code hl_function" href="../../d9/d6a/namespacearch.html#a8b44f7f5126702d29110d539cdfbd7e8">arch::parallel_reduce&lt;arch::sum&gt;</a>({<a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, (uint)cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(<a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a267ee7737fe146f856e2012d413ecc83">popID</a>)},</div>
<div class="line"><a id="l01726" name="l01726"></a><span class="lineno"> 1726</span>                                          <a class="code hl_define" href="../../db/d79/arch__device__cuda_8h.html#abeccfbc804a98c6b06b7fc99c71dac5d">ARCH_LOOP_LAMBDA</a> (<span class="keyword">const</span> uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>, <span class="keyword">const</span> uint n, <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *lsum ) {</div>
<div class="line"><a id="l01727" name="l01727"></a><span class="lineno"> 1727</span> </div>
<div class="line"><a id="l01728" name="l01728"></a><span class="lineno"> 1728</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a6760bdacc1d8a5bb4c1a42e1103f0064">Realf</a> *block_data = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab577ace09cdc66074a7cdc3d79394cfb">getData</a>(n);</div>
<div class="line"><a id="l01729" name="l01729"></a><span class="lineno"> 1729</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *block_parameters = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab492eded4908cb97927ddc54a0f3d9d3">getParameters</a>(n);</div>
<div class="line"><a id="l01730" name="l01730"></a><span class="lineno"> 1730</span>                                             <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> DV3 = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>]</div>
<div class="line"><a id="l01731" name="l01731"></a><span class="lineno"> 1731</span>                                                * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>] * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"> 1732</span> </div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span>                                             <a class="code hl_define" href="../../dc/d9d/arch__device__api_8h.html#acf97310a30e30277ebe000e7e4ab6f53">ARCH_INNER_BODY</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>, n, lsum) {</div>
<div class="line"><a id="l01734" name="l01734"></a><span class="lineno"> 1734</span>                                                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856ace98fdb03651c50d1123499280fcb7ba">BlockParams::VXCRD</a>] + (<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>];</div>
<div class="line"><a id="l01735" name="l01735"></a><span class="lineno"> 1735</span>                                                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856addc5022ec6d36b0fc9a73d025cc14485">BlockParams::VYCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>];</div>
<div class="line"><a id="l01736" name="l01736"></a><span class="lineno"> 1736</span>                                                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aa4ae61e72bc15b4114a74faad6e64b07">BlockParams::VZCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l01737" name="l01737"></a><span class="lineno"> 1737</span>                                                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> ENERGY = (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a>*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> + <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a>*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> + <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>*<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a>) * <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a> * mass;</div>
<div class="line"><a id="l01738" name="l01738"></a><span class="lineno"> 1738</span>                                                lsum[0] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * ENERGY * DV3;</div>
<div class="line"><a id="l01739" name="l01739"></a><span class="lineno"> 1739</span>                                                <span class="keywordflow">if</span> (ENERGY &gt; E1limitLocal) lsum[1] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * ENERGY * DV3;</div>
<div class="line"><a id="l01740" name="l01740"></a><span class="lineno"> 1740</span>                                                <span class="keywordflow">if</span> (ENERGY &gt; E2limitLocal) lsum[2] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * ENERGY * DV3;</div>
<div class="line"><a id="l01741" name="l01741"></a><span class="lineno"> 1741</span>                                             };</div>
<div class="line"><a id="l01742" name="l01742"></a><span class="lineno"> 1742</span>                                          }, sum);</div>
<div class="line"><a id="l01743" name="l01743"></a><span class="lineno"> 1743</span> </div>
<div class="line"><a id="l01744" name="l01744"></a><span class="lineno"> 1744</span>         <a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a1beaf12103930269e8c356404fdb6e36">EDensity</a>[0] = sum[0];</div>
<div class="line"><a id="l01745" name="l01745"></a><span class="lineno"> 1745</span>         <a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a1beaf12103930269e8c356404fdb6e36">EDensity</a>[1] = sum[1];</div>
<div class="line"><a id="l01746" name="l01746"></a><span class="lineno"> 1746</span>         <a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a1beaf12103930269e8c356404fdb6e36">EDensity</a>[2] = sum[2];</div>
<div class="line"><a id="l01747" name="l01747"></a><span class="lineno"> 1747</span> </div>
<div class="line"><a id="l01748" name="l01748"></a><span class="lineno"> 1748</span>      }</div>
<div class="line"><a id="l01749" name="l01749"></a><span class="lineno"> 1749</span> </div>
<div class="line"><a id="l01750" name="l01750"></a><span class="lineno"> 1750</span>      <span class="comment">// Output energy density in units eV/cm^3 instead of Joules per m^3</span></div>
<div class="line"><a id="l01751" name="l01751"></a><span class="lineno"> 1751</span>      <a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a1beaf12103930269e8c356404fdb6e36">EDensity</a>[0] *= (1.0e-6)/<a class="code hl_variable" href="../../d7/d2f/namespacephysicalconstants.html#a3b6b084bee2f2d9da50526b722487f0e">physicalconstants::CHARGE</a>;</div>
<div class="line"><a id="l01752" name="l01752"></a><span class="lineno"> 1752</span>      <a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a1beaf12103930269e8c356404fdb6e36">EDensity</a>[1] *= (1.0e-6)/<a class="code hl_variable" href="../../d7/d2f/namespacephysicalconstants.html#a3b6b084bee2f2d9da50526b722487f0e">physicalconstants::CHARGE</a>;</div>
<div class="line"><a id="l01753" name="l01753"></a><span class="lineno"> 1753</span>      <a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a1beaf12103930269e8c356404fdb6e36">EDensity</a>[2] *= (1.0e-6)/<a class="code hl_variable" href="../../d7/d2f/namespacephysicalconstants.html#a3b6b084bee2f2d9da50526b722487f0e">physicalconstants::CHARGE</a>;</div>
<div class="line"><a id="l01754" name="l01754"></a><span class="lineno"> 1754</span> </div>
<div class="line"><a id="l01755" name="l01755"></a><span class="lineno"> 1755</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a1beaf12103930269e8c356404fdb6e36">EDensity</a>);</div>
<div class="line"><a id="l01756" name="l01756"></a><span class="lineno"> 1756</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; 3*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l01757" name="l01757"></a><span class="lineno"> 1757</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01758" name="l01758"></a><span class="lineno"> 1758</span>   }</div>
</div>
<div class="line"><a id="l01759" name="l01759"></a><span class="lineno"> 1759</span> </div>
<div class="foldopen" id="foldopen01760" data-start="{" data-end="}">
<div class="line"><a id="l01760" name="l01760"></a><span class="lineno"><a class="line" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a42d627340b0e896827461f2e14e988d0"> 1760</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a42d627340b0e896827461f2e14e988d0">VariableEnergyDensity::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l01761" name="l01761"></a><span class="lineno"> 1761</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; 3; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++) {</div>
<div class="line"><a id="l01762" name="l01762"></a><span class="lineno"> 1762</span>         <a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a1beaf12103930269e8c356404fdb6e36">EDensity</a>[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = 0.0;</div>
<div class="line"><a id="l01763" name="l01763"></a><span class="lineno"> 1763</span>      }</div>
<div class="line"><a id="l01764" name="l01764"></a><span class="lineno"> 1764</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01765" name="l01765"></a><span class="lineno"> 1765</span>   }</div>
</div>
<div class="line"><a id="l01766" name="l01766"></a><span class="lineno"> 1766</span> </div>
<div class="foldopen" id="foldopen01767" data-start="{" data-end="}">
<div class="line"><a id="l01767" name="l01767"></a><span class="lineno"><a class="line" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a39c89b548b451615566e01f95e202e79"> 1767</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a39c89b548b451615566e01f95e202e79">VariableEnergyDensity::writeParameters</a>(vlsv::Writer&amp; vlsvWriter) {</div>
<div class="line"><a id="l01768" name="l01768"></a><span class="lineno"> 1768</span>      <span class="comment">// Output solar wind energy in eV</span></div>
<div class="line"><a id="l01769" name="l01769"></a><span class="lineno"> 1769</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> swe = <a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a81ec9c7f0b7fb4a26b8193de110d28a0">solarwindenergy</a>/<a class="code hl_variable" href="../../d7/d2f/namespacephysicalconstants.html#a3b6b084bee2f2d9da50526b722487f0e">physicalconstants::CHARGE</a>;</div>
<div class="line"><a id="l01770" name="l01770"></a><span class="lineno"> 1770</span>      <span class="comment">// Output other bin limits as multipliers</span></div>
<div class="line"><a id="l01771" name="l01771"></a><span class="lineno"> 1771</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> e1l = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a267ee7737fe146f856e2012d413ecc83">popID</a>].EnergyDensityLimit1;</div>
<div class="line"><a id="l01772" name="l01772"></a><span class="lineno"> 1772</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> e2l = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a267ee7737fe146f856e2012d413ecc83">popID</a>].EnergyDensityLimit2;</div>
<div class="line"><a id="l01773" name="l01773"></a><span class="lineno"> 1773</span> </div>
<div class="line"><a id="l01774" name="l01774"></a><span class="lineno"> 1774</span>      <span class="keywordflow">if</span>( vlsvWriter.writeParameter(<a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#acbe1767c02aeb889554738b0aa852b46">popName</a>+<span class="stringliteral">&quot;_EnergyDensityESW&quot;</span>, &amp;swe) == <span class="keyword">false</span> ) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a id="l01775" name="l01775"></a><span class="lineno"> 1775</span>      <span class="keywordflow">if</span>( vlsvWriter.writeParameter(<a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#acbe1767c02aeb889554738b0aa852b46">popName</a>+<span class="stringliteral">&quot;_EnergyDensityELimit1&quot;</span>, &amp;e1l) == <span class="keyword">false</span> ) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a id="l01776" name="l01776"></a><span class="lineno"> 1776</span>      <span class="keywordflow">if</span>( vlsvWriter.writeParameter(<a class="code hl_variable" href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#acbe1767c02aeb889554738b0aa852b46">popName</a>+<span class="stringliteral">&quot;_EnergyDensityELimit2&quot;</span>, &amp;e2l) == <span class="keyword">false</span> ) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a id="l01777" name="l01777"></a><span class="lineno"> 1777</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01778" name="l01778"></a><span class="lineno"> 1778</span>   }</div>
</div>
<div class="line"><a id="l01779" name="l01779"></a><span class="lineno"> 1779</span> </div>
<div class="line"><a id="l01780" name="l01780"></a><span class="lineno"> 1780</span>   <span class="comment">// Heat flux density vector</span></div>
<div class="line"><a id="l01781" name="l01781"></a><span class="lineno"> 1781</span>   <span class="comment">// q_i = m/2 * integral((v - &lt;V&gt;)^2 (v - &lt;V&gt;)_i * f(r,v) dV)</span></div>
<div class="foldopen" id="foldopen01782" data-start="{" data-end="}">
<div class="line"><a id="l01782" name="l01782"></a><span class="lineno"><a class="line" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#ae46079af368557cc4f0bab7e1e04967b"> 1782</a></span>   <a class="code hl_function" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#ae46079af368557cc4f0bab7e1e04967b">VariableHeatFluxVector::VariableHeatFluxVector</a>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> _popID): <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DataReductionOperator</a>(),<a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a0725225936774a492c74e11c92337c73">popID</a>(_popID) {</div>
<div class="line"><a id="l01783" name="l01783"></a><span class="lineno"> 1783</span>      <a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#af8e68052e791fdbd4910c7c8fa4e9772">popName</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a0725225936774a492c74e11c92337c73">popID</a>].name;</div>
<div class="line"><a id="l01784" name="l01784"></a><span class="lineno"> 1784</span>   }</div>
</div>
<div class="line"><a id="l01785" name="l01785"></a><span class="lineno"><a class="line" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#ad6402458be71858e035136892292ce9d"> 1785</a></span>   <a class="code hl_function" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#ad6402458be71858e035136892292ce9d">VariableHeatFluxVector::~VariableHeatFluxVector</a>() { }</div>
<div class="line"><a id="l01786" name="l01786"></a><span class="lineno"> 1786</span> </div>
<div class="line"><a id="l01787" name="l01787"></a><span class="lineno"><a class="line" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a6d0e42845c3d187f37ed2d725335b7a7"> 1787</a></span>   std::string <a class="code hl_function" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a6d0e42845c3d187f37ed2d725335b7a7">VariableHeatFluxVector::getName</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#af8e68052e791fdbd4910c7c8fa4e9772">popName</a> + <span class="stringliteral">&quot;/vg_heatflux&quot;</span>;}</div>
<div class="line"><a id="l01788" name="l01788"></a><span class="lineno"> 1788</span> </div>
<div class="foldopen" id="foldopen01789" data-start="{" data-end="}">
<div class="line"><a id="l01789" name="l01789"></a><span class="lineno"><a class="line" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a83f2f50690584b22df04415172154bcf"> 1789</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a83f2f50690584b22df04415172154bcf">VariableHeatFluxVector::getDataVectorInfo</a>(std::string&amp; dataType,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01790" name="l01790"></a><span class="lineno"> 1790</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l01791" name="l01791"></a><span class="lineno"> 1791</span>      dataSize =  <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>);</div>
<div class="line"><a id="l01792" name="l01792"></a><span class="lineno"> 1792</span>      vectorSize = 3;</div>
<div class="line"><a id="l01793" name="l01793"></a><span class="lineno"> 1793</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"> 1794</span>   }</div>
</div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"> 1795</span> </div>
<div class="foldopen" id="foldopen01796" data-start="{" data-end="}">
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"><a class="line" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a757f682124a3be8ede1aed44a9b3942f"> 1796</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a757f682124a3be8ede1aed44a9b3942f">VariableHeatFluxVector::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell,<span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span> </div>
<div class="line"><a id="l01798" name="l01798"></a><span class="lineno"> 1798</span><span class="preprocessor">      #ifdef USE_GPU</span></div>
<div class="line"><a id="l01799" name="l01799"></a><span class="lineno"> 1799</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ae0f93c317e351510eeaeaf8a57bf3f79">dev_get_velocity_blocks</a>(<a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a0725225936774a492c74e11c92337c73">popID</a>);</div>
<div class="line"><a id="l01800" name="l01800"></a><span class="lineno"> 1800</span><span class="preprocessor">      #else</span></div>
<div class="line"><a id="l01801" name="l01801"></a><span class="lineno"> 1801</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a1dc25bb724906fa5d6dd76096cb7b9a4">get_velocity_blocks</a>(<a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a0725225936774a492c74e11c92337c73">popID</a>);</div>
<div class="line"><a id="l01802" name="l01802"></a><span class="lineno"> 1802</span><span class="preprocessor">      #endif</span></div>
<div class="line"><a id="l01803" name="l01803"></a><span class="lineno"> 1803</span> </div>
<div class="line"><a id="l01804" name="l01804"></a><span class="lineno"> 1804</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a> = 0.5;</div>
<div class="line"><a id="l01805" name="l01805"></a><span class="lineno"> 1805</span> </div>
<div class="line"><a id="l01806" name="l01806"></a><span class="lineno"> 1806</span>      <span class="comment">// ARCH interface includes OpenMP looping including critical regions for thread summation</span></div>
<div class="line"><a id="l01807" name="l01807"></a><span class="lineno"> 1807</span>      {</div>
<div class="line"><a id="l01808" name="l01808"></a><span class="lineno"> 1808</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> sum[3] = {0.0, 0.0, 0.0};</div>
<div class="line"><a id="l01809" name="l01809"></a><span class="lineno"> 1809</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#af33aabfe5743de0d77d6d8db8ad38346">averageVX</a> = this-&gt;averageVX, <a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#acecb621ac82a93190a3dfdb57597ace2">averageVY</a> = this-&gt;averageVY, <a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#ade404bd77e7e4f86217f6fcc5b2a6fdd">averageVZ</a> = this-&gt;averageVZ;</div>
<div class="line"><a id="l01810" name="l01810"></a><span class="lineno"> 1810</span>         <span class="keywordflow">if</span> (cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(<a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a0725225936774a492c74e11c92337c73">popID</a>) != 0)</div>
<div class="line"><a id="l01811" name="l01811"></a><span class="lineno"> 1811</span>         <a class="code hl_function" href="../../d9/d6a/namespacearch.html#a8b44f7f5126702d29110d539cdfbd7e8">arch::parallel_reduce&lt;arch::sum&gt;</a>({<a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, (uint)cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(<a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a0725225936774a492c74e11c92337c73">popID</a>)},</div>
<div class="line"><a id="l01812" name="l01812"></a><span class="lineno"> 1812</span>                                          <a class="code hl_define" href="../../db/d79/arch__device__cuda_8h.html#abeccfbc804a98c6b06b7fc99c71dac5d">ARCH_LOOP_LAMBDA</a>(<span class="keyword">const</span> uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>, <span class="keyword">const</span> uint n, <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *lsum ){</div>
<div class="line"><a id="l01813" name="l01813"></a><span class="lineno"> 1813</span>                          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a6760bdacc1d8a5bb4c1a42e1103f0064">Realf</a> *block_data = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab577ace09cdc66074a7cdc3d79394cfb">getData</a>(n);</div>
<div class="line"><a id="l01814" name="l01814"></a><span class="lineno"> 1814</span>                          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *block_parameters = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab492eded4908cb97927ddc54a0f3d9d3">getParameters</a>(n);</div>
<div class="line"><a id="l01815" name="l01815"></a><span class="lineno"> 1815</span>                          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856ace98fdb03651c50d1123499280fcb7ba">BlockParams::VXCRD</a>] + (<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>];</div>
<div class="line"><a id="l01816" name="l01816"></a><span class="lineno"> 1816</span>                          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856addc5022ec6d36b0fc9a73d025cc14485">BlockParams::VYCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>];</div>
<div class="line"><a id="l01817" name="l01817"></a><span class="lineno"> 1817</span>                          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aa4ae61e72bc15b4114a74faad6e64b07">BlockParams::VZCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l01818" name="l01818"></a><span class="lineno"> 1818</span>                          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> DV3 = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>]</div>
<div class="line"><a id="l01819" name="l01819"></a><span class="lineno"> 1819</span>                             * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>] * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l01820" name="l01820"></a><span class="lineno"> 1820</span>                          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> VSQ</div>
<div class="line"><a id="l01821" name="l01821"></a><span class="lineno"> 1821</span>                             = (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> - <a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#af33aabfe5743de0d77d6d8db8ad38346">averageVX</a>) * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> - <a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#af33aabfe5743de0d77d6d8db8ad38346">averageVX</a>)</div>
<div class="line"><a id="l01822" name="l01822"></a><span class="lineno"> 1822</span>                             + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> - <a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#acecb621ac82a93190a3dfdb57597ace2">averageVY</a>) * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> - <a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#acecb621ac82a93190a3dfdb57597ace2">averageVY</a>)</div>
<div class="line"><a id="l01823" name="l01823"></a><span class="lineno"> 1823</span>                             + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> - <a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#ade404bd77e7e4f86217f6fcc5b2a6fdd">averageVZ</a>) * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> - <a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#ade404bd77e7e4f86217f6fcc5b2a6fdd">averageVZ</a>);</div>
<div class="line"><a id="l01824" name="l01824"></a><span class="lineno"> 1824</span> </div>
<div class="line"><a id="l01825" name="l01825"></a><span class="lineno"> 1825</span>                     lsum[0] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * VSQ * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> - <a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#af33aabfe5743de0d77d6d8db8ad38346">averageVX</a>) * DV3;</div>
<div class="line"><a id="l01826" name="l01826"></a><span class="lineno"> 1826</span>                     lsum[1] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * VSQ * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> - <a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#acecb621ac82a93190a3dfdb57597ace2">averageVY</a>) * DV3;</div>
<div class="line"><a id="l01827" name="l01827"></a><span class="lineno"> 1827</span>                     lsum[2] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>,<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * VSQ * (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> - <a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#ade404bd77e7e4f86217f6fcc5b2a6fdd">averageVZ</a>) * DV3;</div>
<div class="line"><a id="l01828" name="l01828"></a><span class="lineno"> 1828</span>         }, sum);</div>
<div class="line"><a id="l01829" name="l01829"></a><span class="lineno"> 1829</span> </div>
<div class="line"><a id="l01830" name="l01830"></a><span class="lineno"> 1830</span>         <a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a2f1142e6c30a77b48b12d6858a8b147d">HeatFlux</a>[0] = sum[0] * <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a> * <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a0725225936774a492c74e11c92337c73">popID</a>].mass;</div>
<div class="line"><a id="l01831" name="l01831"></a><span class="lineno"> 1831</span>         <a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a2f1142e6c30a77b48b12d6858a8b147d">HeatFlux</a>[1] = sum[1] * <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a> * <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a0725225936774a492c74e11c92337c73">popID</a>].mass;</div>
<div class="line"><a id="l01832" name="l01832"></a><span class="lineno"> 1832</span>         <a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a2f1142e6c30a77b48b12d6858a8b147d">HeatFlux</a>[2] = sum[2] * <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a> * <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a0725225936774a492c74e11c92337c73">popID</a>].mass;</div>
<div class="line"><a id="l01833" name="l01833"></a><span class="lineno"> 1833</span>      }</div>
<div class="line"><a id="l01834" name="l01834"></a><span class="lineno"> 1834</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a2f1142e6c30a77b48b12d6858a8b147d">HeatFlux</a>);</div>
<div class="line"><a id="l01835" name="l01835"></a><span class="lineno"> 1835</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; 3*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>) buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l01836" name="l01836"></a><span class="lineno"> 1836</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01837" name="l01837"></a><span class="lineno"> 1837</span>   }</div>
</div>
<div class="line"><a id="l01838" name="l01838"></a><span class="lineno"> 1838</span> </div>
<div class="foldopen" id="foldopen01839" data-start="{" data-end="}">
<div class="line"><a id="l01839" name="l01839"></a><span class="lineno"><a class="line" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#af5e31ea8a3b05824c7271b2fc39bd7d3"> 1839</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#af5e31ea8a3b05824c7271b2fc39bd7d3">VariableHeatFluxVector::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l01840" name="l01840"></a><span class="lineno"> 1840</span>      <a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#af33aabfe5743de0d77d6d8db8ad38346">averageVX</a> = cell-&gt; parameters[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a75e41e45c0e401d091dad2e29dde4909">CellParams::VX</a>];</div>
<div class="line"><a id="l01841" name="l01841"></a><span class="lineno"> 1841</span>      <a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#acecb621ac82a93190a3dfdb57597ace2">averageVY</a> = cell-&gt; parameters[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840af916b65768e628165d616adb69c30441">CellParams::VY</a>];</div>
<div class="line"><a id="l01842" name="l01842"></a><span class="lineno"> 1842</span>      <a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#ade404bd77e7e4f86217f6fcc5b2a6fdd">averageVZ</a> = cell-&gt; parameters[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a2de546e2cd563cbb4d339f823c28fc7f">CellParams::VZ</a>];</div>
<div class="line"><a id="l01843" name="l01843"></a><span class="lineno"> 1843</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; 3; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>++) {</div>
<div class="line"><a id="l01844" name="l01844"></a><span class="lineno"> 1844</span>         <a class="code hl_variable" href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a2f1142e6c30a77b48b12d6858a8b147d">HeatFlux</a>[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = 0.0;</div>
<div class="line"><a id="l01845" name="l01845"></a><span class="lineno"> 1845</span>      }</div>
<div class="line"><a id="l01846" name="l01846"></a><span class="lineno"> 1846</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01847" name="l01847"></a><span class="lineno"> 1847</span>   }</div>
</div>
<div class="line"><a id="l01848" name="l01848"></a><span class="lineno"> 1848</span></div>
<div class="foldopen" id="foldopen01867" data-start="{" data-end="}">
<div class="line"><a id="l01867" name="l01867"></a><span class="lineno"><a class="line" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#af3b23b34569cbb13310862061d808b03"> 1867</a></span>   <a class="code hl_function" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#af3b23b34569cbb13310862061d808b03">VariableNonMaxwellianity::VariableNonMaxwellianity</a>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a> _popID) : <a class="code hl_function" href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DataReductionOperator</a>(), <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#acfd536cdda04c333cb9ab15cbc54bc7d">popID</a>(_popID) {</div>
<div class="line"><a id="l01868" name="l01868"></a><span class="lineno"> 1868</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a2d95a2ddb7b9711dc202abfdef04d281">popName</a> = <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#acfd536cdda04c333cb9ab15cbc54bc7d">popID</a>].name;</div>
<div class="line"><a id="l01869" name="l01869"></a><span class="lineno"> 1869</span>   }</div>
</div>
<div class="line"><a id="l01870" name="l01870"></a><span class="lineno"><a class="line" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a820e05d9a25e557283cdca0b5d3965ce"> 1870</a></span>   <a class="code hl_function" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a820e05d9a25e557283cdca0b5d3965ce">VariableNonMaxwellianity::~VariableNonMaxwellianity</a>() {}</div>
<div class="line"><a id="l01871" name="l01871"></a><span class="lineno"> 1871</span> </div>
<div class="line"><a id="l01872" name="l01872"></a><span class="lineno"><a class="line" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a8330c79701e860f305ee3545398d12aa"> 1872</a></span>   std::string <a class="code hl_function" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a8330c79701e860f305ee3545398d12aa">VariableNonMaxwellianity::getName</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a2d95a2ddb7b9711dc202abfdef04d281">popName</a> + <span class="stringliteral">&quot;/vg_nonmaxwellianity&quot;</span>; }</div>
<div class="line"><a id="l01873" name="l01873"></a><span class="lineno"> 1873</span> </div>
<div class="foldopen" id="foldopen01874" data-start="{" data-end="}">
<div class="line"><a id="l01874" name="l01874"></a><span class="lineno"><a class="line" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a928561fa89fb82003ce56e7bb07763b0"> 1874</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a928561fa89fb82003ce56e7bb07763b0">VariableNonMaxwellianity::getDataVectorInfo</a>(std::string&amp; dataType, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; dataSize,</div>
<div class="line"><a id="l01875" name="l01875"></a><span class="lineno"> 1875</span>                                                    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; vectorSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01876" name="l01876"></a><span class="lineno"> 1876</span>      dataType = <span class="stringliteral">&quot;float&quot;</span>;</div>
<div class="line"><a id="l01877" name="l01877"></a><span class="lineno"> 1877</span>      dataSize = <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>);</div>
<div class="line"><a id="l01878" name="l01878"></a><span class="lineno"> 1878</span>      vectorSize = 1;</div>
<div class="line"><a id="l01879" name="l01879"></a><span class="lineno"> 1879</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01880" name="l01880"></a><span class="lineno"> 1880</span>   }</div>
</div>
<div class="line"><a id="l01881" name="l01881"></a><span class="lineno"> 1881</span> </div>
<div class="foldopen" id="foldopen01882" data-start="{" data-end="}">
<div class="line"><a id="l01882" name="l01882"></a><span class="lineno"><a class="line" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ab022303e10bc89144e83952b581bb0ef"> 1882</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ab022303e10bc89144e83952b581bb0ef">VariableNonMaxwellianity::reduceData</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell, <span class="keywordtype">char</span>* buffer) {</div>
<div class="line"><a id="l01883" name="l01883"></a><span class="lineno"> 1883</span>      <span class="comment">// calculate something for epsilon here</span></div>
<div class="line"><a id="l01884" name="l01884"></a><span class="lineno"> 1884</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a> = 0.5;</div>
<div class="line"><a id="l01885" name="l01885"></a><span class="lineno"> 1885</span> </div>
<div class="line"><a id="l01886" name="l01886"></a><span class="lineno"> 1886</span>      <span class="comment">// thermal speed in parallel direction</span></div>
<div class="line"><a id="l01887" name="l01887"></a><span class="lineno"> 1887</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> V_par_th_sq = 2.0 * <a class="code hl_variable" href="../../d7/d2f/namespacephysicalconstants.html#aae884ab721eb17968526710ba72b0996">physicalconstants::K_B</a> * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a2ce521814abddd4030323fce546cf854">T_par</a> / <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#acfd536cdda04c333cb9ab15cbc54bc7d">popID</a>].mass;</div>
<div class="line"><a id="l01888" name="l01888"></a><span class="lineno"> 1888</span> </div>
<div class="line"><a id="l01889" name="l01889"></a><span class="lineno"> 1889</span><span class="preprocessor">      #ifdef USE_GPU</span></div>
<div class="line"><a id="l01890" name="l01890"></a><span class="lineno"> 1890</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ae0f93c317e351510eeaeaf8a57bf3f79">dev_get_velocity_blocks</a>(<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#acfd536cdda04c333cb9ab15cbc54bc7d">popID</a>);</div>
<div class="line"><a id="l01891" name="l01891"></a><span class="lineno"> 1891</span><span class="preprocessor">      #else</span></div>
<div class="line"><a id="l01892" name="l01892"></a><span class="lineno"> 1892</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a1dc25bb724906fa5d6dd76096cb7b9a4">get_velocity_blocks</a>(<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#acfd536cdda04c333cb9ab15cbc54bc7d">popID</a>);</div>
<div class="line"><a id="l01893" name="l01893"></a><span class="lineno"> 1893</span><span class="preprocessor">      #endif</span></div>
<div class="line"><a id="l01894" name="l01894"></a><span class="lineno"> 1894</span> </div>
<div class="line"><a id="l01895" name="l01895"></a><span class="lineno"> 1895</span>      <span class="comment">// ARCH interface includes OpenMP looping including critical regions for thread summation</span></div>
<div class="line"><a id="l01896" name="l01896"></a><span class="lineno"> 1896</span>      {</div>
<div class="line"><a id="l01897" name="l01897"></a><span class="lineno"> 1897</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> thread_epsilon_sum = 0.0;</div>
<div class="line"><a id="l01898" name="l01898"></a><span class="lineno"> 1898</span> </div>
<div class="line"><a id="l01899" name="l01899"></a><span class="lineno"> 1899</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> rho_local = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#aa0af9944d55f557b042ace096ccd1fe8">rho</a>;</div>
<div class="line"><a id="l01900" name="l01900"></a><span class="lineno"> 1900</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> VX0 = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ab3911fb2d37da0ccd13a0b5100c3fae8">V0</a>[0];</div>
<div class="line"><a id="l01901" name="l01901"></a><span class="lineno"> 1901</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> VY0 = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ab3911fb2d37da0ccd13a0b5100c3fae8">V0</a>[1];</div>
<div class="line"><a id="l01902" name="l01902"></a><span class="lineno"> 1902</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> VZ0 = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ab3911fb2d37da0ccd13a0b5100c3fae8">V0</a>[2];</div>
<div class="line"><a id="l01903" name="l01903"></a><span class="lineno"> 1903</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> b_parX = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[0];</div>
<div class="line"><a id="l01904" name="l01904"></a><span class="lineno"> 1904</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> b_parY = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[1];</div>
<div class="line"><a id="l01905" name="l01905"></a><span class="lineno"> 1905</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> b_parZ = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[2];</div>
<div class="line"><a id="l01906" name="l01906"></a><span class="lineno"> 1906</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> b_perp1X = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[0];</div>
<div class="line"><a id="l01907" name="l01907"></a><span class="lineno"> 1907</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> b_perp1Y = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[1];</div>
<div class="line"><a id="l01908" name="l01908"></a><span class="lineno"> 1908</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> b_perp1Z = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[2];</div>
<div class="line"><a id="l01909" name="l01909"></a><span class="lineno"> 1909</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> b_perp2X = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a42cf5ce0b8524b9637ede4ab80afe514">b_perp2</a>[0];</div>
<div class="line"><a id="l01910" name="l01910"></a><span class="lineno"> 1910</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> b_perp2Y = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a42cf5ce0b8524b9637ede4ab80afe514">b_perp2</a>[1];</div>
<div class="line"><a id="l01911" name="l01911"></a><span class="lineno"> 1911</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> b_perp2Z = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a42cf5ce0b8524b9637ede4ab80afe514">b_perp2</a>[2];</div>
<div class="line"><a id="l01912" name="l01912"></a><span class="lineno"> 1912</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> T_par_local = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a2ce521814abddd4030323fce546cf854">T_par</a>;</div>
<div class="line"><a id="l01913" name="l01913"></a><span class="lineno"> 1913</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> T_perp_local = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ae015b4bf0a6495d267fb86012ccca8d6">T_perp</a>;</div>
<div class="line"><a id="l01914" name="l01914"></a><span class="lineno"> 1914</span> </div>
<div class="line"><a id="l01915" name="l01915"></a><span class="lineno"> 1915</span>         <span class="keywordflow">if</span> (cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#acfd536cdda04c333cb9ab15cbc54bc7d">popID</a>) != 0)</div>
<div class="line"><a id="l01916" name="l01916"></a><span class="lineno"> 1916</span>         <a class="code hl_function" href="../../d9/d6a/namespacearch.html#a8b44f7f5126702d29110d539cdfbd7e8">arch::parallel_reduce&lt;arch::sum&gt;</a>({<a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, (uint)cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#acfd536cdda04c333cb9ab15cbc54bc7d">popID</a>)},</div>
<div class="line"><a id="l01917" name="l01917"></a><span class="lineno"> 1917</span>            <a class="code hl_define" href="../../db/d79/arch__device__cuda_8h.html#abeccfbc804a98c6b06b7fc99c71dac5d">ARCH_LOOP_LAMBDA</a>(<span class="keyword">const</span> uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>, <span class="keyword">const</span> uint n, <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *lthread_epsilon_sum ){</div>
<div class="line"><a id="l01918" name="l01918"></a><span class="lineno"> 1918</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a6760bdacc1d8a5bb4c1a42e1103f0064">Realf</a> *block_data = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab577ace09cdc66074a7cdc3d79394cfb">getData</a>(n);</div>
<div class="line"><a id="l01919" name="l01919"></a><span class="lineno"> 1919</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *block_parameters = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab492eded4908cb97927ddc54a0f3d9d3">getParameters</a>(n);</div>
<div class="line"><a id="l01920" name="l01920"></a><span class="lineno"> 1920</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856ace98fdb03651c50d1123499280fcb7ba">BlockParams::VXCRD</a>] + (<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>];</div>
<div class="line"><a id="l01921" name="l01921"></a><span class="lineno"> 1921</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856addc5022ec6d36b0fc9a73d025cc14485">BlockParams::VYCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>];</div>
<div class="line"><a id="l01922" name="l01922"></a><span class="lineno"> 1922</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aa4ae61e72bc15b4114a74faad6e64b07">BlockParams::VZCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l01923" name="l01923"></a><span class="lineno"> 1923</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> DV3 = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>]</div>
<div class="line"><a id="l01924" name="l01924"></a><span class="lineno"> 1924</span>                  * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>] * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l01925" name="l01925"></a><span class="lineno"> 1925</span> </div>
<div class="line"><a id="l01926" name="l01926"></a><span class="lineno"> 1926</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> V_par = (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> - VX0) * b_parX + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> - VY0) * b_parY + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> - VZ0) * b_parZ;</div>
<div class="line"><a id="l01927" name="l01927"></a><span class="lineno"> 1927</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> V_perp1 = (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> - VX0) * b_perp1X + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> - VY0) * b_perp1Y + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> - VZ0) * b_perp1Z;</div>
<div class="line"><a id="l01928" name="l01928"></a><span class="lineno"> 1928</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> V_perp2 = (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> - VX0) * b_perp2X + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> - VY0) * b_perp2Y + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> - VZ0) * b_perp2Z;</div>
<div class="line"><a id="l01929" name="l01929"></a><span class="lineno"> 1929</span> </div>
<div class="line"><a id="l01930" name="l01930"></a><span class="lineno"> 1930</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> bimaxwellian = rho_local / <a class="code hl_function" href="../../de/d31/_dispersion_8m.html#af276a2aede715061015c735080cf65df">sqrt</a>(M_PI * M_PI * M_PI * V_par_th_sq * V_par_th_sq * V_par_th_sq) *</div>
<div class="line"><a id="l01931" name="l01931"></a><span class="lineno"> 1931</span>                                         (T_par_local / T_perp_local) *</div>
<div class="line"><a id="l01932" name="l01932"></a><span class="lineno"> 1932</span>                                         exp(-(V_par * V_par) / V_par_th_sq -</div>
<div class="line"><a id="l01933" name="l01933"></a><span class="lineno"> 1933</span>                                             (V_perp1 * V_perp1 + V_perp2 * V_perp2) / (V_par_th_sq * T_perp_local / T_par_local));</div>
<div class="line"><a id="l01934" name="l01934"></a><span class="lineno"> 1934</span> </div>
<div class="line"><a id="l01935" name="l01935"></a><span class="lineno"> 1935</span>               lthread_epsilon_sum[0] +=</div>
<div class="line"><a id="l01936" name="l01936"></a><span class="lineno"> 1936</span>                  (<a class="code hl_function" href="../../d8/dbc/vectorclass__fallback_8h.html#ad1eccb49237393bcbb5b6b97556fa4e2">abs</a>(block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] - bimaxwellian) - bimaxwellian) * DV3;</div>
<div class="line"><a id="l01937" name="l01937"></a><span class="lineno"> 1937</span>         }, thread_epsilon_sum);</div>
<div class="line"><a id="l01938" name="l01938"></a><span class="lineno"> 1938</span> </div>
<div class="line"><a id="l01939" name="l01939"></a><span class="lineno"> 1939</span>         <span class="comment">// Epsilon is here the non-Maxwellianity</span></div>
<div class="line"><a id="l01940" name="l01940"></a><span class="lineno"> 1940</span>         <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a4930ebf4b3723e655ba21bc2ca7fe90c">epsilon</a> = thread_epsilon_sum;</div>
<div class="line"><a id="l01941" name="l01941"></a><span class="lineno"> 1941</span>      }</div>
<div class="line"><a id="l01942" name="l01942"></a><span class="lineno"> 1942</span> </div>
<div class="line"><a id="l01943" name="l01943"></a><span class="lineno"> 1943</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a4930ebf4b3723e655ba21bc2ca7fe90c">epsilon</a> *= <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a> / <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#aa0af9944d55f557b042ace096ccd1fe8">rho</a>;</div>
<div class="line"><a id="l01944" name="l01944"></a><span class="lineno"> 1944</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a4930ebf4b3723e655ba21bc2ca7fe90c">epsilon</a> += <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>;</div>
<div class="line"><a id="l01945" name="l01945"></a><span class="lineno"> 1945</span> </div>
<div class="line"><a id="l01946" name="l01946"></a><span class="lineno"> 1946</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a4930ebf4b3723e655ba21bc2ca7fe90c">epsilon</a>);</div>
<div class="line"><a id="l01947" name="l01947"></a><span class="lineno"> 1947</span>      <span class="keywordflow">for</span> (uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> = 0; <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> &lt; <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a>); ++<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>)</div>
<div class="line"><a id="l01948" name="l01948"></a><span class="lineno"> 1948</span>         buffer[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>] = ptr[<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>];</div>
<div class="line"><a id="l01949" name="l01949"></a><span class="lineno"> 1949</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01950" name="l01950"></a><span class="lineno"> 1950</span>   }</div>
</div>
<div class="line"><a id="l01951" name="l01951"></a><span class="lineno"> 1951</span> </div>
<div class="foldopen" id="foldopen01952" data-start="{" data-end="}">
<div class="line"><a id="l01952" name="l01952"></a><span class="lineno"><a class="line" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a20f1e60cb924583ad613fef221905dda"> 1952</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a20f1e60cb924583ad613fef221905dda">VariableNonMaxwellianity::setSpatialCell</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">SpatialCell</a>* cell) {</div>
<div class="line"><a id="l01953" name="l01953"></a><span class="lineno"> 1953</span>      <span class="comment">// calculate here parallel and perpendicular T for use in actual</span></div>
<div class="line"><a id="l01954" name="l01954"></a><span class="lineno"> 1954</span>      <span class="comment">// non-Maxwellianity calculation</span></div>
<div class="line"><a id="l01955" name="l01955"></a><span class="lineno"> 1955</span>      <span class="comment">// TODO: Consider if rotated saved moments would be enough? Data reductions take place</span></div>
<div class="line"><a id="l01956" name="l01956"></a><span class="lineno"> 1956</span>      <span class="comment">// as first action of main loop, so moments_V are the most recent ones.</span></div>
<div class="line"><a id="l01957" name="l01957"></a><span class="lineno"> 1957</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a4930ebf4b3723e655ba21bc2ca7fe90c">epsilon</a> = 0.0;</div>
<div class="line"><a id="l01958" name="l01958"></a><span class="lineno"> 1958</span> </div>
<div class="line"><a id="l01959" name="l01959"></a><span class="lineno"> 1959</span>      <span class="comment">// get rho and bulk speed</span></div>
<div class="line"><a id="l01960" name="l01960"></a><span class="lineno"> 1960</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#aa0af9944d55f557b042ace096ccd1fe8">rho</a> = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ac3e9c10c72c754b3ca8586d8811ad6d4">get_population</a>(<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#acfd536cdda04c333cb9ab15cbc54bc7d">popID</a>).<a class="code hl_variable" href="../../d5/d8c/structspatial__cell_1_1_population.html#a48307ec57a24640206bdc2b7659f66b1">RHO_V</a>;</div>
<div class="line"><a id="l01961" name="l01961"></a><span class="lineno"> 1961</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ab3911fb2d37da0ccd13a0b5100c3fae8">V0</a>[0] = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ac3e9c10c72c754b3ca8586d8811ad6d4">get_population</a>(<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#acfd536cdda04c333cb9ab15cbc54bc7d">popID</a>).<a class="code hl_variable" href="../../d5/d8c/structspatial__cell_1_1_population.html#a196a102b33d6f8d6fee1aff20c29197a">V_V</a>[0];</div>
<div class="line"><a id="l01962" name="l01962"></a><span class="lineno"> 1962</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ab3911fb2d37da0ccd13a0b5100c3fae8">V0</a>[1] = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ac3e9c10c72c754b3ca8586d8811ad6d4">get_population</a>(<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#acfd536cdda04c333cb9ab15cbc54bc7d">popID</a>).<a class="code hl_variable" href="../../d5/d8c/structspatial__cell_1_1_population.html#a196a102b33d6f8d6fee1aff20c29197a">V_V</a>[1];</div>
<div class="line"><a id="l01963" name="l01963"></a><span class="lineno"> 1963</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ab3911fb2d37da0ccd13a0b5100c3fae8">V0</a>[2] = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ac3e9c10c72c754b3ca8586d8811ad6d4">get_population</a>(<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#acfd536cdda04c333cb9ab15cbc54bc7d">popID</a>).<a class="code hl_variable" href="../../d5/d8c/structspatial__cell_1_1_population.html#a196a102b33d6f8d6fee1aff20c29197a">V_V</a>[2];</div>
<div class="line"><a id="l01964" name="l01964"></a><span class="lineno"> 1964</span> </div>
<div class="line"><a id="l01965" name="l01965"></a><span class="lineno"> 1965</span>      <span class="comment">// calculate temperature from the pressure tensor</span></div>
<div class="line"><a id="l01966" name="l01966"></a><span class="lineno"> 1966</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> PTensor[3] = {};</div>
<div class="line"><a id="l01967" name="l01967"></a><span class="lineno"> 1967</span> </div>
<div class="line"><a id="l01968" name="l01968"></a><span class="lineno"> 1968</span>      <span class="comment">// parallel unit vector (B)</span></div>
<div class="line"><a id="l01969" name="l01969"></a><span class="lineno"> 1969</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> BX = cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a50f3584d2fa8255ba2df24d8b01d8a83">CellParams::PERBXVOL</a>] + cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a0b14dcc916a785f309ca6c122d8acecb">CellParams::BGBXVOL</a>];</div>
<div class="line"><a id="l01970" name="l01970"></a><span class="lineno"> 1970</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> BY = cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840ac44a0b8ba721d489ba7f5d0e74c592ac">CellParams::PERBYVOL</a>] + cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840ae5c6d66d7d0c73858a1c8ca46f5952a5">CellParams::BGBYVOL</a>];</div>
<div class="line"><a id="l01971" name="l01971"></a><span class="lineno"> 1971</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> BZ = cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840ad9d470cda28e4d96059ae0a1335552e5">CellParams::PERBZVOL</a>] + cell-&gt;<a class="code hl_variable" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">parameters</a>[<a class="code hl_enumvalue" href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a8d84d511a8af5fc3860564fbf862845e">CellParams::BGBZVOL</a>];</div>
<div class="line"><a id="l01972" name="l01972"></a><span class="lineno"> 1972</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> norm_par = <a class="code hl_function" href="../../de/d31/_dispersion_8m.html#af276a2aede715061015c735080cf65df">sqrt</a>(BX * BX + BY * BY + BZ * BZ);</div>
<div class="line"><a id="l01973" name="l01973"></a><span class="lineno"> 1973</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[0] = BX / norm_par;</div>
<div class="line"><a id="l01974" name="l01974"></a><span class="lineno"> 1974</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[1] = BY / norm_par;</div>
<div class="line"><a id="l01975" name="l01975"></a><span class="lineno"> 1975</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[2] = BZ / norm_par;</div>
<div class="line"><a id="l01976" name="l01976"></a><span class="lineno"> 1976</span> </div>
<div class="line"><a id="l01977" name="l01977"></a><span class="lineno"> 1977</span>      <span class="comment">// perpendicular unit vector 1 (bulk velocity perpendicular to b)</span></div>
<div class="line"><a id="l01978" name="l01978"></a><span class="lineno"> 1978</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> BV0 = <a class="code hl_function" href="../../de/d31/_dispersion_8m.html#af276a2aede715061015c735080cf65df">sqrt</a>(<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[0] * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ab3911fb2d37da0ccd13a0b5100c3fae8">V0</a>[0] + <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[1] * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ab3911fb2d37da0ccd13a0b5100c3fae8">V0</a>[1] + <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[2] * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ab3911fb2d37da0ccd13a0b5100c3fae8">V0</a>[2]);</div>
<div class="line"><a id="l01979" name="l01979"></a><span class="lineno"> 1979</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[0] = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ab3911fb2d37da0ccd13a0b5100c3fae8">V0</a>[0] - BV0 * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[0];</div>
<div class="line"><a id="l01980" name="l01980"></a><span class="lineno"> 1980</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[1] = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ab3911fb2d37da0ccd13a0b5100c3fae8">V0</a>[1] - BV0 * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[1];</div>
<div class="line"><a id="l01981" name="l01981"></a><span class="lineno"> 1981</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[2] = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ab3911fb2d37da0ccd13a0b5100c3fae8">V0</a>[2] - BV0 * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[2];</div>
<div class="line"><a id="l01982" name="l01982"></a><span class="lineno"> 1982</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> norm_perp1 = <a class="code hl_function" href="../../de/d31/_dispersion_8m.html#af276a2aede715061015c735080cf65df">sqrt</a>(<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[0] * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[0] + <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[1] * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[1] + <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[2] * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[2]);</div>
<div class="line"><a id="l01983" name="l01983"></a><span class="lineno"> 1983</span>      <span class="keywordflow">if</span> (!(norm_perp1 &gt; 0.0)) {</div>
<div class="line"><a id="l01984" name="l01984"></a><span class="lineno"> 1984</span>         <span class="comment">// if V0 is aligned with b, take arbitrary perpendicular vector</span></div>
<div class="line"><a id="l01985" name="l01985"></a><span class="lineno"> 1985</span>         <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[0] = +<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[1] + <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[2];</div>
<div class="line"><a id="l01986" name="l01986"></a><span class="lineno"> 1986</span>         <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[1] = +<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[2] - <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[0];</div>
<div class="line"><a id="l01987" name="l01987"></a><span class="lineno"> 1987</span>         <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[2] = -<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[0] - <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[1];</div>
<div class="line"><a id="l01988" name="l01988"></a><span class="lineno"> 1988</span>         norm_perp1 = <a class="code hl_function" href="../../de/d31/_dispersion_8m.html#af276a2aede715061015c735080cf65df">sqrt</a>(<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[0] * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[0] + <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[1] * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[1] + <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[2] * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[2]);</div>
<div class="line"><a id="l01989" name="l01989"></a><span class="lineno"> 1989</span>      }</div>
<div class="line"><a id="l01990" name="l01990"></a><span class="lineno"> 1990</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[0] /= norm_perp1;</div>
<div class="line"><a id="l01991" name="l01991"></a><span class="lineno"> 1991</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[1] /= norm_perp1;</div>
<div class="line"><a id="l01992" name="l01992"></a><span class="lineno"> 1992</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[2] /= norm_perp1;</div>
<div class="line"><a id="l01993" name="l01993"></a><span class="lineno"> 1993</span> </div>
<div class="line"><a id="l01994" name="l01994"></a><span class="lineno"> 1994</span>      <span class="comment">// perpendicular unit vector 2 (b_par x b_perp1)</span></div>
<div class="line"><a id="l01995" name="l01995"></a><span class="lineno"> 1995</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a42cf5ce0b8524b9637ede4ab80afe514">b_perp2</a>[0] = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[1] * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[2] - <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[2] * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[1];</div>
<div class="line"><a id="l01996" name="l01996"></a><span class="lineno"> 1996</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a42cf5ce0b8524b9637ede4ab80afe514">b_perp2</a>[1] = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[2] * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[0] - <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[0] * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[2];</div>
<div class="line"><a id="l01997" name="l01997"></a><span class="lineno"> 1997</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a42cf5ce0b8524b9637ede4ab80afe514">b_perp2</a>[2] = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[0] * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[1] - <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[1] * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[0];</div>
<div class="line"><a id="l01998" name="l01998"></a><span class="lineno"> 1998</span>      <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> norm_perp2 = <a class="code hl_function" href="../../de/d31/_dispersion_8m.html#af276a2aede715061015c735080cf65df">sqrt</a>(<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a42cf5ce0b8524b9637ede4ab80afe514">b_perp2</a>[0] * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a42cf5ce0b8524b9637ede4ab80afe514">b_perp2</a>[0] + <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a42cf5ce0b8524b9637ede4ab80afe514">b_perp2</a>[1] * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a42cf5ce0b8524b9637ede4ab80afe514">b_perp2</a>[1] + <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a42cf5ce0b8524b9637ede4ab80afe514">b_perp2</a>[2] * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a42cf5ce0b8524b9637ede4ab80afe514">b_perp2</a>[2]);</div>
<div class="line"><a id="l01999" name="l01999"></a><span class="lineno"> 1999</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a42cf5ce0b8524b9637ede4ab80afe514">b_perp2</a>[0] /= norm_perp2;</div>
<div class="line"><a id="l02000" name="l02000"></a><span class="lineno"> 2000</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a42cf5ce0b8524b9637ede4ab80afe514">b_perp2</a>[1] /= norm_perp2;</div>
<div class="line"><a id="l02001" name="l02001"></a><span class="lineno"> 2001</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a42cf5ce0b8524b9637ede4ab80afe514">b_perp2</a>[2] /= norm_perp2;</div>
<div class="line"><a id="l02002" name="l02002"></a><span class="lineno"> 2002</span> </div>
<div class="line"><a id="l02003" name="l02003"></a><span class="lineno"> 2003</span>      <span class="comment">// below calculation is modified from VariablePTensorDiagonal</span></div>
<div class="line"><a id="l02004" name="l02004"></a><span class="lineno"> 2004</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a> = 0.5;</div>
<div class="line"><a id="l02005" name="l02005"></a><span class="lineno"> 2005</span> </div>
<div class="line"><a id="l02006" name="l02006"></a><span class="lineno"> 2006</span><span class="preprocessor">      #ifdef USE_GPU</span></div>
<div class="line"><a id="l02007" name="l02007"></a><span class="lineno"> 2007</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ae0f93c317e351510eeaeaf8a57bf3f79">dev_get_velocity_blocks</a>(<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#acfd536cdda04c333cb9ab15cbc54bc7d">popID</a>);</div>
<div class="line"><a id="l02008" name="l02008"></a><span class="lineno"> 2008</span><span class="preprocessor">      #else</span></div>
<div class="line"><a id="l02009" name="l02009"></a><span class="lineno"> 2009</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a>* VBC = cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a1dc25bb724906fa5d6dd76096cb7b9a4">get_velocity_blocks</a>(<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#acfd536cdda04c333cb9ab15cbc54bc7d">popID</a>);</div>
<div class="line"><a id="l02010" name="l02010"></a><span class="lineno"> 2010</span><span class="preprocessor">      #endif</span></div>
<div class="line"><a id="l02011" name="l02011"></a><span class="lineno"> 2011</span> </div>
<div class="line"><a id="l02012" name="l02012"></a><span class="lineno"> 2012</span>      <span class="comment">// ARCH interface includes OpenMP looping including critical regions for thread summation</span></div>
<div class="line"><a id="l02013" name="l02013"></a><span class="lineno"> 2013</span>      {</div>
<div class="line"><a id="l02014" name="l02014"></a><span class="lineno"> 2014</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> sum[3] = {0.0, 0.0, 0.0};</div>
<div class="line"><a id="l02015" name="l02015"></a><span class="lineno"> 2015</span> </div>
<div class="line"><a id="l02016" name="l02016"></a><span class="lineno"> 2016</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> VX0 = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ab3911fb2d37da0ccd13a0b5100c3fae8">V0</a>[0];</div>
<div class="line"><a id="l02017" name="l02017"></a><span class="lineno"> 2017</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> VY0 = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ab3911fb2d37da0ccd13a0b5100c3fae8">V0</a>[1];</div>
<div class="line"><a id="l02018" name="l02018"></a><span class="lineno"> 2018</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> VZ0 = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ab3911fb2d37da0ccd13a0b5100c3fae8">V0</a>[2];</div>
<div class="line"><a id="l02019" name="l02019"></a><span class="lineno"> 2019</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> b_parX = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[0];</div>
<div class="line"><a id="l02020" name="l02020"></a><span class="lineno"> 2020</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> b_parY = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[1];</div>
<div class="line"><a id="l02021" name="l02021"></a><span class="lineno"> 2021</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> b_parZ = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">b_par</a>[2];</div>
<div class="line"><a id="l02022" name="l02022"></a><span class="lineno"> 2022</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> b_perp1X = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[0];</div>
<div class="line"><a id="l02023" name="l02023"></a><span class="lineno"> 2023</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> b_perp1Y = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[1];</div>
<div class="line"><a id="l02024" name="l02024"></a><span class="lineno"> 2024</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> b_perp1Z = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">b_perp1</a>[2];</div>
<div class="line"><a id="l02025" name="l02025"></a><span class="lineno"> 2025</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> b_perp2X = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a42cf5ce0b8524b9637ede4ab80afe514">b_perp2</a>[0];</div>
<div class="line"><a id="l02026" name="l02026"></a><span class="lineno"> 2026</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> b_perp2Y = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a42cf5ce0b8524b9637ede4ab80afe514">b_perp2</a>[1];</div>
<div class="line"><a id="l02027" name="l02027"></a><span class="lineno"> 2027</span>         <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> b_perp2Z = <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a42cf5ce0b8524b9637ede4ab80afe514">b_perp2</a>[2];</div>
<div class="line"><a id="l02028" name="l02028"></a><span class="lineno"> 2028</span> </div>
<div class="line"><a id="l02029" name="l02029"></a><span class="lineno"> 2029</span>         <span class="keywordflow">if</span> (cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#acfd536cdda04c333cb9ab15cbc54bc7d">popID</a>) != 0)</div>
<div class="line"><a id="l02030" name="l02030"></a><span class="lineno"> 2030</span>         <a class="code hl_function" href="../../d9/d6a/namespacearch.html#a8b44f7f5126702d29110d539cdfbd7e8">arch::parallel_reduce&lt;arch::sum&gt;</a>({<a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, <a class="code hl_define" href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a>, (uint)cell-&gt;<a class="code hl_function" href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">get_number_of_velocity_blocks</a>(<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#acfd536cdda04c333cb9ab15cbc54bc7d">popID</a>)},</div>
<div class="line"><a id="l02031" name="l02031"></a><span class="lineno"> 2031</span>                                          <a class="code hl_define" href="../../db/d79/arch__device__cuda_8h.html#abeccfbc804a98c6b06b7fc99c71dac5d">ARCH_LOOP_LAMBDA</a>(<span class="keyword">const</span> uint <a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <span class="keyword">const</span> uint <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>, <span class="keyword">const</span> uint n, <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *lsum ){</div>
<div class="line"><a id="l02032" name="l02032"></a><span class="lineno"> 2032</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a6760bdacc1d8a5bb4c1a42e1103f0064">Realf</a> *block_data = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab577ace09cdc66074a7cdc3d79394cfb">getData</a>(n);</div>
<div class="line"><a id="l02033" name="l02033"></a><span class="lineno"> 2033</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> *block_parameters = VBC-&gt;<a class="code hl_function" href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab492eded4908cb97927ddc54a0f3d9d3">getParameters</a>(n);</div>
<div class="line"><a id="l02034" name="l02034"></a><span class="lineno"> 2034</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856ace98fdb03651c50d1123499280fcb7ba">BlockParams::VXCRD</a>] + (<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>];</div>
<div class="line"><a id="l02035" name="l02035"></a><span class="lineno"> 2035</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856addc5022ec6d36b0fc9a73d025cc14485">BlockParams::VYCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>];</div>
<div class="line"><a id="l02036" name="l02036"></a><span class="lineno"> 2036</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aa4ae61e72bc15b4114a74faad6e64b07">BlockParams::VZCRD</a>] + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a> + <a class="code hl_variable" href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a>)*block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l02037" name="l02037"></a><span class="lineno"> 2037</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> DV3 = block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a>]</div>
<div class="line"><a id="l02038" name="l02038"></a><span class="lineno"> 2038</span>             * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a>] * block_parameters[<a class="code hl_enumvalue" href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a>];</div>
<div class="line"><a id="l02039" name="l02039"></a><span class="lineno"> 2039</span> </div>
<div class="line"><a id="l02040" name="l02040"></a><span class="lineno"> 2040</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> V_par = (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> - VX0) * b_parX + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> - VY0) * b_parY + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> - VZ0) * b_parZ;</div>
<div class="line"><a id="l02041" name="l02041"></a><span class="lineno"> 2041</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> V_perp1 = (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> - VX0) * b_perp1X + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> - VY0) * b_perp1Y + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> - VZ0) * b_perp1Z;</div>
<div class="line"><a id="l02042" name="l02042"></a><span class="lineno"> 2042</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a> V_perp2 = (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a> - VX0) * b_perp2X + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a> - VY0) * b_perp2Y + (<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a> - VZ0) * b_perp2Z;</div>
<div class="line"><a id="l02043" name="l02043"></a><span class="lineno"> 2043</span> </div>
<div class="line"><a id="l02044" name="l02044"></a><span class="lineno"> 2044</span>          lsum[0] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * V_par * V_par * DV3;</div>
<div class="line"><a id="l02045" name="l02045"></a><span class="lineno"> 2045</span>          lsum[1] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * V_perp1 * V_perp1 * DV3;</div>
<div class="line"><a id="l02046" name="l02046"></a><span class="lineno"> 2046</span>          lsum[2] += block_data[<a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a>(<a class="code hl_variable" href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a>, <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a>, <a class="code hl_variable" href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a>)] * V_perp2 * V_perp2 * DV3;</div>
<div class="line"><a id="l02047" name="l02047"></a><span class="lineno"> 2047</span>         }, sum);</div>
<div class="line"><a id="l02048" name="l02048"></a><span class="lineno"> 2048</span> </div>
<div class="line"><a id="l02049" name="l02049"></a><span class="lineno"> 2049</span>         PTensor[0] = sum[0] * <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#acfd536cdda04c333cb9ab15cbc54bc7d">popID</a>].mass;</div>
<div class="line"><a id="l02050" name="l02050"></a><span class="lineno"> 2050</span>         PTensor[1] = sum[1] * <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#acfd536cdda04c333cb9ab15cbc54bc7d">popID</a>].mass;</div>
<div class="line"><a id="l02051" name="l02051"></a><span class="lineno"> 2051</span>         PTensor[2] = sum[2] * <a class="code hl_function" href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a>().<a class="code hl_variable" href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">particleSpecies</a>[<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#acfd536cdda04c333cb9ab15cbc54bc7d">popID</a>].mass;</div>
<div class="line"><a id="l02052" name="l02052"></a><span class="lineno"> 2052</span>      }</div>
<div class="line"><a id="l02053" name="l02053"></a><span class="lineno"> 2053</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a2ce521814abddd4030323fce546cf854">T_par</a> = (PTensor[0]) / (<a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#aa0af9944d55f557b042ace096ccd1fe8">rho</a> * <a class="code hl_variable" href="../../d7/d2f/namespacephysicalconstants.html#aae884ab721eb17968526710ba72b0996">physicalconstants::K_B</a>);</div>
<div class="line"><a id="l02054" name="l02054"></a><span class="lineno"> 2054</span>      <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ae015b4bf0a6495d267fb86012ccca8d6">T_perp</a> = (PTensor[1] + PTensor[2]) / (2.0 * <a class="code hl_variable" href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#aa0af9944d55f557b042ace096ccd1fe8">rho</a> * <a class="code hl_variable" href="../../d7/d2f/namespacephysicalconstants.html#aae884ab721eb17968526710ba72b0996">physicalconstants::K_B</a>);</div>
<div class="line"><a id="l02055" name="l02055"></a><span class="lineno"> 2055</span> </div>
<div class="line"><a id="l02056" name="l02056"></a><span class="lineno"> 2056</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l02057" name="l02057"></a><span class="lineno"> 2057</span>   }</div>
</div>
<div class="line"><a id="l02058" name="l02058"></a><span class="lineno"> 2058</span> </div>
<div class="line"><a id="l02059" name="l02059"></a><span class="lineno"> 2059</span>} <span class="comment">// namespace DRO</span></div>
</div>
<div class="ttc" id="a_dispersion_8m_html_a516e79afaff41160487af846f7360b3d"><div class="ttname"><a href="../../de/d31/_dispersion_8m.html#a516e79afaff41160487af846f7360b3d">i</a></div><div class="ttdeci">for i</div><div class="ttdef"><b>Definition</b> <a href="../../de/d31/_dispersion_8m_source.html#l00024">Dispersion.m:24</a></div></div>
<div class="ttc" id="a_dispersion_8m_html_a5f42793d54b63dd49eb6e5df11348743"><div class="ttname"><a href="../../de/d31/_dispersion_8m.html#a5f42793d54b63dd49eb6e5df11348743">V</a></div><div class="ttdeci">Numerical propagation V</div><div class="ttdef"><b>Definition</b> <a href="../../de/d31/_dispersion_8m_source.html#l00098">Dispersion.m:98</a></div></div>
<div class="ttc" id="a_dispersion_8m_html_a90ad4bd5b920bf33a857dacf0ff8f520"><div class="ttname"><a href="../../de/d31/_dispersion_8m.html#a90ad4bd5b920bf33a857dacf0ff8f520">B0</a></div><div class="ttdeci">B0</div><div class="ttdef"><b>Definition</b> <a href="../../de/d31/_dispersion_8m_source.html#l00041">Dispersion.m:41</a></div></div>
<div class="ttc" id="a_dispersion_8m_html_af276a2aede715061015c735080cf65df"><div class="ttname"><a href="../../de/d31/_dispersion_8m.html#af276a2aede715061015c735080cf65df">sqrt</a></div><div class="ttdeci">sqrt(1.0+vA *vA/(c *c))) % Ion-acoustic wave cS</div></div>
<div class="ttc" id="aarch__device__api_8h_html_acf97310a30e30277ebe000e7e4ab6f53"><div class="ttname"><a href="../../dc/d9d/arch__device__api_8h.html#acf97310a30e30277ebe000e7e4ab6f53">ARCH_INNER_BODY</a></div><div class="ttdeci">#define ARCH_INNER_BODY(...)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d9d/arch__device__api_8h_source.html#l00033">arch_device_api.h:33</a></div></div>
<div class="ttc" id="aarch__device__cuda_8h_html_abeccfbc804a98c6b06b7fc99c71dac5d"><div class="ttname"><a href="../../db/d79/arch__device__cuda_8h.html#abeccfbc804a98c6b06b7fc99c71dac5d">ARCH_LOOP_LAMBDA</a></div><div class="ttdeci">#define ARCH_LOOP_LAMBDA</div><div class="ttdef"><b>Definition</b> <a href="../../db/d79/arch__device__cuda_8h_source.html#l00099">arch_device_cuda.h:99</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_blocks_html_a19bf681aa623db7b4671f8f24295517e"><div class="ttname"><a href="../../d3/d01/class_d_r_o_1_1_blocks.html#a19bf681aa623db7b4671f8f24295517e">DRO::Blocks::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l00541">datareductionoperator.cpp:541</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_blocks_html_a2e8c2ed9994775c41394f50642111ccf"><div class="ttname"><a href="../../d3/d01/class_d_r_o_1_1_blocks.html#a2e8c2ed9994775c41394f50642111ccf">DRO::Blocks::popID</a></div><div class="ttdeci">uint popID</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00291">datareductionoperator.h:291</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_blocks_html_a391685268c5cbd962e5a223a7669e995"><div class="ttname"><a href="../../d3/d01/class_d_r_o_1_1_blocks.html#a391685268c5cbd962e5a223a7669e995">DRO::Blocks::Blocks</a></div><div class="ttdeci">Blocks(cuint popID)</div><div class="ttdef"><b>Definition</b> <a href="#l00527">datareductionoperator.cpp:527</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_blocks_html_a3cc8adfc76d5294e756cfb629a1cd5ac"><div class="ttname"><a href="../../d3/d01/class_d_r_o_1_1_blocks.html#a3cc8adfc76d5294e756cfb629a1cd5ac">DRO::Blocks::~Blocks</a></div><div class="ttdeci">virtual ~Blocks()</div><div class="ttdef"><b>Definition</b> <a href="#l00530">datareductionoperator.cpp:530</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_blocks_html_a5465be6d6e9d3a104707273f47373b3a"><div class="ttname"><a href="../../d3/d01/class_d_r_o_1_1_blocks.html#a5465be6d6e9d3a104707273f47373b3a">DRO::Blocks::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l00552">datareductionoperator.cpp:552</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_blocks_html_a5d9e565132dc6ef7313f3f80b3f98170"><div class="ttname"><a href="../../d3/d01/class_d_r_o_1_1_blocks.html#a5d9e565132dc6ef7313f3f80b3f98170">DRO::Blocks::popName</a></div><div class="ttdeci">std::string popName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00292">datareductionoperator.h:292</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_blocks_html_a61792a99b05a5b243909d20f72b70ecc"><div class="ttname"><a href="../../d3/d01/class_d_r_o_1_1_blocks.html#a61792a99b05a5b243909d20f72b70ecc">DRO::Blocks::nBlocks</a></div><div class="ttdeci">uint nBlocks</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00290">datareductionoperator.h:290</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_blocks_html_a63069e1c883d1f2b6e337028848afdf9"><div class="ttname"><a href="../../d3/d01/class_d_r_o_1_1_blocks.html#a63069e1c883d1f2b6e337028848afdf9">DRO::Blocks::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l00539">datareductionoperator.cpp:539</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_blocks_html_a69f39ab1719cdce2288e97a4067e4985"><div class="ttname"><a href="../../d3/d01/class_d_r_o_1_1_blocks.html#a69f39ab1719cdce2288e97a4067e4985">DRO::Blocks::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l00532">datareductionoperator.cpp:532</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_blocks_html_a6aa12046d3164f336d5443b6b3531e16"><div class="ttname"><a href="../../d3/d01/class_d_r_o_1_1_blocks.html#a6aa12046d3164f336d5443b6b3531e16">DRO::Blocks::reduceDiagnostic</a></div><div class="ttdeci">virtual bool reduceDiagnostic(const SpatialCell *cell, Real *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l00547">datareductionoperator.cpp:547</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_boundary_layer_html_a0bcab88f7bde6a4fdda6c69b84d8447d"><div class="ttname"><a href="../../dd/d6a/class_d_r_o_1_1_boundary_layer.html#a0bcab88f7bde6a4fdda6c69b84d8447d">DRO::BoundaryLayer::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l00513">datareductionoperator.cpp:513</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_boundary_layer_html_a2961338ff1d55e306e4dd3a37d2fd62b"><div class="ttname"><a href="../../dd/d6a/class_d_r_o_1_1_boundary_layer.html#a2961338ff1d55e306e4dd3a37d2fd62b">DRO::BoundaryLayer::~BoundaryLayer</a></div><div class="ttdeci">virtual ~BoundaryLayer()</div><div class="ttdef"><b>Definition</b> <a href="#l00504">datareductionoperator.cpp:504</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_boundary_layer_html_a83250105c43d994772631b81defd27eb"><div class="ttname"><a href="../../dd/d6a/class_d_r_o_1_1_boundary_layer.html#a83250105c43d994772631b81defd27eb">DRO::BoundaryLayer::boundaryLayer</a></div><div class="ttdeci">int boundaryLayer</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00275">datareductionoperator.h:275</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_boundary_layer_html_a9ea1e552794124fd7f3d18e4e55b199a"><div class="ttname"><a href="../../dd/d6a/class_d_r_o_1_1_boundary_layer.html#a9ea1e552794124fd7f3d18e4e55b199a">DRO::BoundaryLayer::BoundaryLayer</a></div><div class="ttdeci">BoundaryLayer()</div><div class="ttdef"><b>Definition</b> <a href="#l00503">datareductionoperator.cpp:503</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_boundary_layer_html_aa0fe98dc7525bd950c577385352c04da"><div class="ttname"><a href="../../dd/d6a/class_d_r_o_1_1_boundary_layer.html#aa0fe98dc7525bd950c577385352c04da">DRO::BoundaryLayer::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l00515">datareductionoperator.cpp:515</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_boundary_layer_html_ad3457c63916d86889ba0e3ef20d4dcf4"><div class="ttname"><a href="../../dd/d6a/class_d_r_o_1_1_boundary_layer.html#ad3457c63916d86889ba0e3ef20d4dcf4">DRO::BoundaryLayer::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l00521">datareductionoperator.cpp:521</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_boundary_layer_html_ae83c57180a5520c2a93af238f5397662"><div class="ttname"><a href="../../dd/d6a/class_d_r_o_1_1_boundary_layer.html#ae83c57180a5520c2a93af238f5397662">DRO::BoundaryLayer::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l00506">datareductionoperator.cpp:506</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_boundary_type_html_a12844eb2ae0b2d52a22bfe93529047b2"><div class="ttname"><a href="../../d0/d19/class_d_r_o_1_1_boundary_type.html#a12844eb2ae0b2d52a22bfe93529047b2">DRO::BoundaryType::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l00481">datareductionoperator.cpp:481</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_boundary_type_html_a39026d936d51972bb25aa66a73665db3"><div class="ttname"><a href="../../d0/d19/class_d_r_o_1_1_boundary_type.html#a39026d936d51972bb25aa66a73665db3">DRO::BoundaryType::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l00490">datareductionoperator.cpp:490</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_boundary_type_html_a4063bc0cbea1c31eefffc1d5319222d6"><div class="ttname"><a href="../../d0/d19/class_d_r_o_1_1_boundary_type.html#a4063bc0cbea1c31eefffc1d5319222d6">DRO::BoundaryType::BoundaryType</a></div><div class="ttdeci">BoundaryType()</div><div class="ttdef"><b>Definition</b> <a href="#l00478">datareductionoperator.cpp:478</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_boundary_type_html_a4c64d55d82c639a6e906885d0ddc91af"><div class="ttname"><a href="../../d0/d19/class_d_r_o_1_1_boundary_type.html#a4c64d55d82c639a6e906885d0ddc91af">DRO::BoundaryType::~BoundaryType</a></div><div class="ttdeci">virtual ~BoundaryType()</div><div class="ttdef"><b>Definition</b> <a href="#l00479">datareductionoperator.cpp:479</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_boundary_type_html_a6777577e973086d5df7208e07c8a633f"><div class="ttname"><a href="../../d0/d19/class_d_r_o_1_1_boundary_type.html#a6777577e973086d5df7208e07c8a633f">DRO::BoundaryType::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l00488">datareductionoperator.cpp:488</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_boundary_type_html_a80af9cd08b7c1e4b4350e6c951cfb441"><div class="ttname"><a href="../../d0/d19/class_d_r_o_1_1_boundary_type.html#a80af9cd08b7c1e4b4350e6c951cfb441">DRO::BoundaryType::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l00496">datareductionoperator.cpp:496</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_boundary_type_html_ac372ed619934e86fdf47075060470e68"><div class="ttname"><a href="../../d0/d19/class_d_r_o_1_1_boundary_type.html#ac372ed619934e86fdf47075060470e68">DRO::BoundaryType::boundaryType</a></div><div class="ttdeci">int boundaryType</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00261">datareductionoperator.h:261</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_b_v_o_l_derivatives_html_a184d43f7eabbe63ce043cf7cf523aade"><div class="ttname"><a href="../../d8/d46/class_d_r_o_1_1_data_reduction_operator_b_v_o_l_derivatives.html#a184d43f7eabbe63ce043cf7cf523aade">DRO::DataReductionOperatorBVOLDerivatives::DataReductionOperatorBVOLDerivatives</a></div><div class="ttdeci">DataReductionOperatorBVOLDerivatives(const std::string &amp;name, const unsigned int parameterIndex, const unsigned int vectorSize)</div><div class="ttdef"><b>Definition</b> <a href="#l00408">datareductionoperator.cpp:408</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_b_v_o_l_derivatives_html_a8ed699bd920697c276604dde7a68593e"><div class="ttname"><a href="../../d8/d46/class_d_r_o_1_1_data_reduction_operator_b_v_o_l_derivatives.html#a8ed699bd920697c276604dde7a68593e">DRO::DataReductionOperatorBVOLDerivatives::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l00413">datareductionoperator.cpp:413</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_cell_params_html_a13a2940a5b472af0ee678e73823a4327"><div class="ttname"><a href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a13a2940a5b472af0ee678e73823a4327">DRO::DataReductionOperatorCellParams::data</a></div><div class="ttdeci">const Real * data</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00220">datareductionoperator.h:220</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_cell_params_html_a1bdf365d6ead48011a0220a231e8bced"><div class="ttname"><a href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a1bdf365d6ead48011a0220a231e8bced">DRO::DataReductionOperatorCellParams::DataReductionOperatorCellParams</a></div><div class="ttdeci">DataReductionOperatorCellParams(const std::string &amp;name, const unsigned int parameterIndex, const unsigned int vectorSize)</div><div class="ttdef"><b>Definition</b> <a href="#l00074">datareductionoperator.cpp:74</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_cell_params_html_a4fdec3fbb1461f812ac68904e9dfb042"><div class="ttname"><a href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a4fdec3fbb1461f812ac68904e9dfb042">DRO::DataReductionOperatorCellParams::_parameterIndex</a></div><div class="ttdeci">uint _parameterIndex</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00217">datareductionoperator.h:217</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_cell_params_html_a7ed040bcc0f67439fcfbf506aa985cd3"><div class="ttname"><a href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a7ed040bcc0f67439fcfbf506aa985cd3">DRO::DataReductionOperatorCellParams::vectorSize</a></div><div class="ttdeci">uint vectorSize</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00218">datareductionoperator.h:218</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_cell_params_html_a91f83e19ec9f3e8a5032ace9e642a377"><div class="ttname"><a href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#a91f83e19ec9f3e8a5032ace9e642a377">DRO::DataReductionOperatorCellParams::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l00100">datareductionoperator.cpp:100</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_cell_params_html_aa9ef742818e75c507a7af251492c0ed8"><div class="ttname"><a href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#aa9ef742818e75c507a7af251492c0ed8">DRO::DataReductionOperatorCellParams::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l00085">datareductionoperator.cpp:85</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_cell_params_html_ae41d76025b42eebccb33ee7ee46589ed"><div class="ttname"><a href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#ae41d76025b42eebccb33ee7ee46589ed">DRO::DataReductionOperatorCellParams::variableName</a></div><div class="ttdeci">std::string variableName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00219">datareductionoperator.h:219</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_cell_params_html_ae944611dd23023f88109f7155db7a71d"><div class="ttname"><a href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#ae944611dd23023f88109f7155db7a71d">DRO::DataReductionOperatorCellParams::~DataReductionOperatorCellParams</a></div><div class="ttdeci">virtual ~DataReductionOperatorCellParams()</div><div class="ttdef"><b>Definition</b> <a href="#l00076">datareductionoperator.cpp:76</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_cell_params_html_af4942b658c4c57f5f67f2de5a066261b"><div class="ttname"><a href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#af4942b658c4c57f5f67f2de5a066261b">DRO::DataReductionOperatorCellParams::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l00087">datareductionoperator.cpp:87</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_cell_params_html_af4ed33850c9cf656c1067248df268e44"><div class="ttname"><a href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#af4ed33850c9cf656c1067248df268e44">DRO::DataReductionOperatorCellParams::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l00078">datareductionoperator.cpp:78</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_cell_params_html_af6d2b0fc71f6e6817bbd31dc2290e5b9"><div class="ttname"><a href="../../dc/dc0/class_d_r_o_1_1_data_reduction_operator_cell_params.html#af6d2b0fc71f6e6817bbd31dc2290e5b9">DRO::DataReductionOperatorCellParams::reduceDiagnostic</a></div><div class="ttdeci">virtual bool reduceDiagnostic(const SpatialCell *cell, Real *result)</div><div class="ttdef"><b>Definition</b> <a href="#l00095">datareductionoperator.cpp:95</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_fs_grid_html_a0f8eb40cf188a4e3275afbdf64055ee4"><div class="ttname"><a href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#a0f8eb40cf188a4e3275afbdf64055ee4">DRO::DataReductionOperatorFsGrid::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l00112">datareductionoperator.cpp:112</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_fs_grid_html_a15803e7139cde5eccbf184eb26946d35"><div class="ttname"><a href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#a15803e7139cde5eccbf184eb26946d35">DRO::DataReductionOperatorFsGrid::reduceDiagnostic</a></div><div class="ttdeci">virtual bool reduceDiagnostic(const SpatialCell *cell, Real *result)</div><div class="ttdef"><b>Definition</b> <a href="#l00123">datareductionoperator.cpp:123</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_fs_grid_html_a1a2b9f25cd16bc28506d7f9df1a80022"><div class="ttname"><a href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#a1a2b9f25cd16bc28506d7f9df1a80022">DRO::DataReductionOperatorFsGrid::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l00126">datareductionoperator.cpp:126</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_fs_grid_html_a3195a8dc79a32f93b27a1c06f08026e2"><div class="ttname"><a href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#a3195a8dc79a32f93b27a1c06f08026e2">DRO::DataReductionOperatorFsGrid::lambda</a></div><div class="ttdeci">ReductionLambda lambda</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00108">datareductionoperator.h:108</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_fs_grid_html_a42f058d9ae5fcbfa23c8857472073a44"><div class="ttname"><a href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#a42f058d9ae5fcbfa23c8857472073a44">DRO::DataReductionOperatorFsGrid::variableName</a></div><div class="ttdeci">std::string variableName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00109">datareductionoperator.h:109</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_fs_grid_html_a524e76c5e5c165287e35a0a8df1c97d1"><div class="ttname"><a href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#a524e76c5e5c165287e35a0a8df1c97d1">DRO::DataReductionOperatorFsGrid::writeFsGridData</a></div><div class="ttdeci">virtual bool writeFsGridData(FsGrid&lt; std::array&lt; Real, fsgrids::bfield::N_BFIELD &gt;, FS_STENCIL_WIDTH &gt; &amp;perBGrid, FsGrid&lt; std::array&lt; Real, fsgrids::efield::N_EFIELD &gt;, FS_STENCIL_WIDTH &gt; &amp;EGrid, FsGrid&lt; std::array&lt; Real, fsgrids::ehall::N_EHALL &gt;, FS_STENCIL_WIDTH &gt; &amp;EHallGrid, FsGrid&lt; std::array&lt; Real, fsgrids::egradpe::N_EGRADPE &gt;, FS_STENCIL_WIDTH &gt; &amp;EGradPeGrid, FsGrid&lt; std::array&lt; Real, fsgrids::moments::N_MOMENTS &gt;, FS_STENCIL_WIDTH &gt; &amp;momentsGrid, FsGrid&lt; std::array&lt; Real, fsgrids::dperb::N_DPERB &gt;, FS_STENCIL_WIDTH &gt; &amp;dPerBGrid, FsGrid&lt; std::array&lt; Real, fsgrids::dmoments::N_DMOMENTS &gt;, FS_STENCIL_WIDTH &gt; &amp;dMomentsGrid, FsGrid&lt; std::array&lt; Real, fsgrids::bgbfield::N_BGB &gt;, FS_STENCIL_WIDTH &gt; &amp;BgBGrid, FsGrid&lt; std::array&lt; Real, fsgrids::volfields::N_VOL &gt;, FS_STENCIL_WIDTH &gt; &amp;volGrid, FsGrid&lt; fsgrids::technical, FS_STENCIL_WIDTH &gt; &amp;technicalGrid, const std::string &amp;meshName, vlsv::Writer &amp;vlsvWriter, const bool writeAsFloat=false)</div><div class="ttdef"><b>Definition</b> <a href="#l00130">datareductionoperator.cpp:130</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_fs_grid_html_af9cf391de86c667488a5768dfcb9159a"><div class="ttname"><a href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#af9cf391de86c667488a5768dfcb9159a">DRO::DataReductionOperatorFsGrid::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l00111">datareductionoperator.cpp:111</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_fs_grid_html_afccfc26d02f0f58676130bce64571cf7"><div class="ttname"><a href="../../da/dea/class_d_r_o_1_1_data_reduction_operator_fs_grid.html#afccfc26d02f0f58676130bce64571cf7">DRO::DataReductionOperatorFsGrid::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l00119">datareductionoperator.cpp:119</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_has_parameters_html_afb4eb20318147a30a2a180bafc8d0edb"><div class="ttname"><a href="../../de/d11/class_d_r_o_1_1_data_reduction_operator_has_parameters.html#afb4eb20318147a30a2a180bafc8d0edb">DRO::DataReductionOperatorHasParameters::DataReductionOperatorHasParameters</a></div><div class="ttdeci">DataReductionOperatorHasParameters()</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00089">datareductionoperator.h:89</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_html_a259404d49d13bfb267f42dde226b726a"><div class="ttname"><a href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a259404d49d13bfb267f42dde226b726a">DRO::DataReductionOperator::reduceDiagnostic</a></div><div class="ttdeci">virtual bool reduceDiagnostic(const SpatialCell *cell, Real *result)</div><div class="ttdef"><b>Definition</b> <a href="#l00067">datareductionoperator.cpp:67</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_html_a44aceedc6dca48c9418184d260336202"><div class="ttname"><a href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a44aceedc6dca48c9418184d260336202">DRO::DataReductionOperator::getName</a></div><div class="ttdeci">virtual std::string getName() const =0</div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_html_a4a6ff6ab3eb4e17176c247765946b359"><div class="ttname"><a href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a4a6ff6ab3eb4e17176c247765946b359">DRO::DataReductionOperator::variableLaTeX</a></div><div class="ttdeci">std::string variableLaTeX</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00082">datareductionoperator.h:82</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_html_a4d77da3882b685fb30efef6fe94ed144"><div class="ttname"><a href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a4d77da3882b685fb30efef6fe94ed144">DRO::DataReductionOperator::~DataReductionOperator</a></div><div class="ttdeci">virtual ~DataReductionOperator()</div><div class="ttdef"><b>Definition</b> <a href="#l00046">datareductionoperator.cpp:46</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_html_a4ed1e17513da860dde24bfe63cac9119"><div class="ttname"><a href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a4ed1e17513da860dde24bfe63cac9119">DRO::DataReductionOperator::unit</a></div><div class="ttdeci">std::string unit</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00080">datareductionoperator.h:80</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_html_a6007d65b072f39e9a107c88cc127dec7"><div class="ttname"><a href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a6007d65b072f39e9a107c88cc127dec7">DRO::DataReductionOperator::unitConversion</a></div><div class="ttdeci">std::string unitConversion</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00083">datareductionoperator.h:83</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_html_a6761dbf578f0feb9027706a9976df633"><div class="ttname"><a href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#a6761dbf578f0feb9027706a9976df633">DRO::DataReductionOperator::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l00053">datareductionoperator.cpp:53</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_html_aaebd0bc08738eb2cd7e031096ee58d7d"><div class="ttname"><a href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#aaebd0bc08738eb2cd7e031096ee58d7d">DRO::DataReductionOperator::DataReductionOperator</a></div><div class="ttdeci">DataReductionOperator()</div><div class="ttdef"><b>Definition</b> <a href="#l00043">datareductionoperator.cpp:43</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_html_afe311d7be08842eb5d77c1af2010095d"><div class="ttname"><a href="../../d4/d52/class_d_r_o_1_1_data_reduction_operator.html#afe311d7be08842eb5d77c1af2010095d">DRO::DataReductionOperator::unitLaTeX</a></div><div class="ttdeci">std::string unitLaTeX</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00081">datareductionoperator.h:81</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_element_html_a3441e39b208d8f119a70bf351e7d1bc2"><div class="ttname"><a href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#a3441e39b208d8f119a70bf351e7d1bc2">DRO::DataReductionOperatorIonosphereElement::writeIonosphereData</a></div><div class="ttdeci">virtual bool writeIonosphereData(SBC::SphericalTriGrid &amp;grid, vlsv::Writer &amp;vlsvWriter)</div><div class="ttdef"><b>Definition</b> <a href="#l00202">datareductionoperator.cpp:202</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_element_html_a49481337596135604c98f7634c83fd25"><div class="ttname"><a href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#a49481337596135604c98f7634c83fd25">DRO::DataReductionOperatorIonosphereElement::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l00199">datareductionoperator.cpp:199</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_element_html_a4d0c18fde92c4d39bf327c6ae9a2821f"><div class="ttname"><a href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#a4d0c18fde92c4d39bf327c6ae9a2821f">DRO::DataReductionOperatorIonosphereElement::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l00192">datareductionoperator.cpp:192</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_element_html_a5cb0fc845273134ba3c2f0c7ac2fa78a"><div class="ttname"><a href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#a5cb0fc845273134ba3c2f0c7ac2fa78a">DRO::DataReductionOperatorIonosphereElement::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l00185">datareductionoperator.cpp:185</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_element_html_a8a704a92e2085d244b8c18bd4e8197cc"><div class="ttname"><a href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#a8a704a92e2085d244b8c18bd4e8197cc">DRO::DataReductionOperatorIonosphereElement::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l00186">datareductionoperator.cpp:186</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_element_html_a908c0d85fe9c2f0f666cfef475f0dd72"><div class="ttname"><a href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#a908c0d85fe9c2f0f666cfef475f0dd72">DRO::DataReductionOperatorIonosphereElement::reduceDiagnostic</a></div><div class="ttdeci">virtual bool reduceDiagnostic(const SpatialCell *cell, Real *result)</div><div class="ttdef"><b>Definition</b> <a href="#l00196">datareductionoperator.cpp:196</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_element_html_aaa713c54badca1df3919466df8f65837"><div class="ttname"><a href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#aaa713c54badca1df3919466df8f65837">DRO::DataReductionOperatorIonosphereElement::lambda</a></div><div class="ttdeci">ReductionLambda lambda</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00138">datareductionoperator.h:138</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_element_html_aff8b8161c47f4e970f19ab53696b084a"><div class="ttname"><a href="../../d1/dba/class_d_r_o_1_1_data_reduction_operator_ionosphere_element.html#aff8b8161c47f4e970f19ab53696b084a">DRO::DataReductionOperatorIonosphereElement::variableName</a></div><div class="ttdeci">std::string variableName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00139">datareductionoperator.h:139</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_node_html_a03425a64095d72e23c8afa40dd0ef52a"><div class="ttname"><a href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#a03425a64095d72e23c8afa40dd0ef52a">DRO::DataReductionOperatorIonosphereNode::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l00264">datareductionoperator.cpp:264</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_node_html_a0f8e2d83b51826e8559f44450a3bfca2"><div class="ttname"><a href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#a0f8e2d83b51826e8559f44450a3bfca2">DRO::DataReductionOperatorIonosphereNode::lambda</a></div><div class="ttdeci">ReductionLambda lambda</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00156">datareductionoperator.h:156</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_node_html_a1101a5ac929d6458f505036858f1d87a"><div class="ttname"><a href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#a1101a5ac929d6458f505036858f1d87a">DRO::DataReductionOperatorIonosphereNode::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l00250">datareductionoperator.cpp:250</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_node_html_a17096855535a40bd803fca99eb92ce51"><div class="ttname"><a href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#a17096855535a40bd803fca99eb92ce51">DRO::DataReductionOperatorIonosphereNode::variableName</a></div><div class="ttdeci">std::string variableName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00157">datareductionoperator.h:157</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_node_html_a63bce8b284f6d1d383c3dc6c8fcaeea7"><div class="ttname"><a href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#a63bce8b284f6d1d383c3dc6c8fcaeea7">DRO::DataReductionOperatorIonosphereNode::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l00252">datareductionoperator.cpp:252</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_node_html_a88268f5df6b9d0ee575512db1f0476cf"><div class="ttname"><a href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#a88268f5df6b9d0ee575512db1f0476cf">DRO::DataReductionOperatorIonosphereNode::reduceDiagnostic</a></div><div class="ttdeci">virtual bool reduceDiagnostic(const SpatialCell *cell, Real *result)</div><div class="ttdef"><b>Definition</b> <a href="#l00272">datareductionoperator.cpp:272</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_node_html_aaacfe407045230a8340f72ac831cf3f9"><div class="ttname"><a href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#aaacfe407045230a8340f72ac831cf3f9">DRO::DataReductionOperatorIonosphereNode::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l00278">datareductionoperator.cpp:278</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_node_html_ad77dfc604690ce0b16c9eecf2f93254c"><div class="ttname"><a href="../../d5/d14/class_d_r_o_1_1_data_reduction_operator_ionosphere_node.html#ad77dfc604690ce0b16c9eecf2f93254c">DRO::DataReductionOperatorIonosphereNode::writeIonosphereData</a></div><div class="ttdeci">virtual bool writeIonosphereData(SBC::SphericalTriGrid &amp;grid, vlsv::Writer &amp;vlsvWriter)</div><div class="ttdef"><b>Definition</b> <a href="#l00284">datareductionoperator.cpp:284</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_node_int_html_a1904ab3384e807a777d35ffd6f7b155d"><div class="ttname"><a href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#a1904ab3384e807a777d35ffd6f7b155d">DRO::DataReductionOperatorIonosphereNodeInt::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l00251">datareductionoperator.cpp:251</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_node_int_html_a31b4106dc212b48af50ffd6c72a83d46"><div class="ttname"><a href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#a31b4106dc212b48af50ffd6c72a83d46">DRO::DataReductionOperatorIonosphereNodeInt::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l00268">datareductionoperator.cpp:268</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_node_int_html_a463f0867355fcc9eb7ebc670975b345b"><div class="ttname"><a href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#a463f0867355fcc9eb7ebc670975b345b">DRO::DataReductionOperatorIonosphereNodeInt::lambda</a></div><div class="ttdeci">ReductionLambda lambda</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00174">datareductionoperator.h:174</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_node_int_html_a4d3071ee26e3c7988b8e4f50c1401f64"><div class="ttname"><a href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#a4d3071ee26e3c7988b8e4f50c1401f64">DRO::DataReductionOperatorIonosphereNodeInt::variableName</a></div><div class="ttdeci">std::string variableName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00175">datareductionoperator.h:175</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_node_int_html_a50192064a88fc78228bfd037ab436a0a"><div class="ttname"><a href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#a50192064a88fc78228bfd037ab436a0a">DRO::DataReductionOperatorIonosphereNodeInt::reduceDiagnostic</a></div><div class="ttdeci">virtual bool reduceDiagnostic(const SpatialCell *cell, Real *result)</div><div class="ttdef"><b>Definition</b> <a href="#l00275">datareductionoperator.cpp:275</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_node_int_html_ac000989aab649780a3220e516984b5af"><div class="ttname"><a href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#ac000989aab649780a3220e516984b5af">DRO::DataReductionOperatorIonosphereNodeInt::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l00281">datareductionoperator.cpp:281</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_node_int_html_ac46d14a5b3fc6d7a7ab2b84efb561efd"><div class="ttname"><a href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#ac46d14a5b3fc6d7a7ab2b84efb561efd">DRO::DataReductionOperatorIonosphereNodeInt::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l00258">datareductionoperator.cpp:258</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_ionosphere_node_int_html_aeb057cf741f068054af2b81dced6c12f"><div class="ttname"><a href="../../d3/dfd/class_d_r_o_1_1_data_reduction_operator_ionosphere_node_int.html#aeb057cf741f068054af2b81dced6c12f">DRO::DataReductionOperatorIonosphereNodeInt::writeIonosphereData</a></div><div class="ttdeci">virtual bool writeIonosphereData(SBC::SphericalTriGrid &amp;grid, vlsv::Writer &amp;vlsvWriter)</div><div class="ttdef"><b>Definition</b> <a href="#l00337">datareductionoperator.cpp:337</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell_html_a0c74463de50aade2194e4952b6ac74db"><div class="ttname"><a href="../../d4/d27/class_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell.html#a0c74463de50aade2194e4952b6ac74db">DRO::DataReductionOperatorMPIGridCell::lambda</a></div><div class="ttdeci">ReductionLambda lambda</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00192">datareductionoperator.h:192</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell_html_a842401743a6b4b7f18f0e33c614578ef"><div class="ttname"><a href="../../d4/d27/class_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell.html#a842401743a6b4b7f18f0e33c614578ef">DRO::DataReductionOperatorMPIGridCell::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l00389">datareductionoperator.cpp:389</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell_html_aac2029b6995661def0c0665d6dde97af"><div class="ttname"><a href="../../d4/d27/class_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell.html#aac2029b6995661def0c0665d6dde97af">DRO::DataReductionOperatorMPIGridCell::variableName</a></div><div class="ttdeci">std::string variableName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00194">datareductionoperator.h:194</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell_html_ac430d3907fce7d8bd34f7c7e2b42287f"><div class="ttname"><a href="../../d4/d27/class_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell.html#ac430d3907fce7d8bd34f7c7e2b42287f">DRO::DataReductionOperatorMPIGridCell::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l00396">datareductionoperator.cpp:396</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell_html_ade082787d525ad7aea31eb3a2f565e67"><div class="ttname"><a href="../../d4/d27/class_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell.html#ade082787d525ad7aea31eb3a2f565e67">DRO::DataReductionOperatorMPIGridCell::numFloats</a></div><div class="ttdeci">int numFloats</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00193">datareductionoperator.h:193</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell_html_af38cb676f9de20bacc980269d2be92ec"><div class="ttname"><a href="../../d4/d27/class_d_r_o_1_1_data_reduction_operator_m_p_i_grid_cell.html#af38cb676f9de20bacc980269d2be92ec">DRO::DataReductionOperatorMPIGridCell::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l00390">datareductionoperator.cpp:390</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_m_p_irank_html_a22ca4af2f1648c4f153514b86294f66d"><div class="ttname"><a href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#a22ca4af2f1648c4f153514b86294f66d">DRO::MPIrank::MPIrank</a></div><div class="ttdeci">MPIrank()</div><div class="ttdef"><b>Definition</b> <a href="#l00451">datareductionoperator.cpp:451</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_m_p_irank_html_a454a1fbbb19e0123ddae1d5d640d39db"><div class="ttname"><a href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#a454a1fbbb19e0123ddae1d5d640d39db">DRO::MPIrank::mpiRank</a></div><div class="ttdeci">int mpiRank</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00247">datareductionoperator.h:247</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_m_p_irank_html_a66edf7f65fb3212d893bbf40ea79c8b1"><div class="ttname"><a href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#a66edf7f65fb3212d893bbf40ea79c8b1">DRO::MPIrank::~MPIrank</a></div><div class="ttdeci">virtual ~MPIrank()</div><div class="ttdef"><b>Definition</b> <a href="#l00452">datareductionoperator.cpp:452</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_m_p_irank_html_a9093dab4accb71b990e0dcd56645fbf1"><div class="ttname"><a href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#a9093dab4accb71b990e0dcd56645fbf1">DRO::MPIrank::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l00454">datareductionoperator.cpp:454</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_m_p_irank_html_a9e4da3de3d0fa09a84eb41950a4a31b4"><div class="ttname"><a href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#a9e4da3de3d0fa09a84eb41950a4a31b4">DRO::MPIrank::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l00461">datareductionoperator.cpp:461</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_m_p_irank_html_acabf3d55d433c19d082b74781b7eadee"><div class="ttname"><a href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#acabf3d55d433c19d082b74781b7eadee">DRO::MPIrank::rank</a></div><div class="ttdeci">Real rank</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00246">datareductionoperator.h:246</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_m_p_irank_html_ae4fcfb573466ae5dead8253e0414bea1"><div class="ttname"><a href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#ae4fcfb573466ae5dead8253e0414bea1">DRO::MPIrank::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l00469">datareductionoperator.cpp:469</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_m_p_irank_html_ae7636f61a3871c2e2ab5c189fa031bc9"><div class="ttname"><a href="../../d3/d69/class_d_r_o_1_1_m_p_irank.html#ae7636f61a3871c2e2ab5c189fa031bc9">DRO::MPIrank::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l00463">datareductionoperator.cpp:463</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_b_vol_html_a5fc41696f8747856047d825e38468eef"><div class="ttname"><a href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#a5fc41696f8747856047d825e38468eef">DRO::VariableBVol::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l00439">datareductionoperator.cpp:439</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_b_vol_html_a6d6b48efa6881b91d664f6e55973de1a"><div class="ttname"><a href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#a6d6b48efa6881b91d664f6e55973de1a">DRO::VariableBVol::VariableBVol</a></div><div class="ttdeci">VariableBVol()</div><div class="ttdef"><b>Definition</b> <a href="#l00421">datareductionoperator.cpp:421</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_b_vol_html_a78b1cb0a1fb3eaf19e92a3a4a753f0d9"><div class="ttname"><a href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#a78b1cb0a1fb3eaf19e92a3a4a753f0d9">DRO::VariableBVol::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l00433">datareductionoperator.cpp:433</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_b_vol_html_a85720351528aab235b37a96142084fcf"><div class="ttname"><a href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#a85720351528aab235b37a96142084fcf">DRO::VariableBVol::~VariableBVol</a></div><div class="ttdeci">virtual ~VariableBVol()</div><div class="ttdef"><b>Definition</b> <a href="#l00422">datareductionoperator.cpp:422</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_b_vol_html_a9bde5c19e6f1c99b1ccef8a95c54a205"><div class="ttname"><a href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#a9bde5c19e6f1c99b1ccef8a95c54a205">DRO::VariableBVol::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l00424">datareductionoperator.cpp:424</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_b_vol_html_ac53326ababd7b786a467e9e359ea7587"><div class="ttname"><a href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#ac53326ababd7b786a467e9e359ea7587">DRO::VariableBVol::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l00431">datareductionoperator.cpp:431</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_b_vol_html_aeea1047ee5db36eda3ca9d764a273694"><div class="ttname"><a href="../../d0/d19/class_d_r_o_1_1_variable_b_vol.html#aeea1047ee5db36eda3ca9d764a273694">DRO::VariableBVol::B</a></div><div class="ttdeci">Real B[3]</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00306">datareductionoperator.h:306</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_effective_sparsity_threshold_html_a0b544b39aedbeff809ace0c3434b4ded"><div class="ttname"><a href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a0b544b39aedbeff809ace0c3434b4ded">DRO::VariableEffectiveSparsityThreshold::reduceDiagnostic</a></div><div class="ttdeci">virtual bool reduceDiagnostic(const spatial_cell::SpatialCell *cell, Real *result)</div><div class="ttdef"><b>Definition</b> <a href="#l01316">datareductionoperator.cpp:1316</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_effective_sparsity_threshold_html_a582a47b58cfc35951842e0b2d32e1d56"><div class="ttname"><a href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a582a47b58cfc35951842e0b2d32e1d56">DRO::VariableEffectiveSparsityThreshold::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l01321">datareductionoperator.cpp:1321</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_effective_sparsity_threshold_html_a63fade3f84a863e1746a1d504dc4ca5b"><div class="ttname"><a href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a63fade3f84a863e1746a1d504dc4ca5b">DRO::VariableEffectiveSparsityThreshold::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l01299">datareductionoperator.cpp:1299</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_effective_sparsity_threshold_html_a8353c1e8993bf75c147d5606bfab30eb"><div class="ttname"><a href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a8353c1e8993bf75c147d5606bfab30eb">DRO::VariableEffectiveSparsityThreshold::~VariableEffectiveSparsityThreshold</a></div><div class="ttdeci">virtual ~VariableEffectiveSparsityThreshold()</div><div class="ttdef"><b>Definition</b> <a href="#l01297">datareductionoperator.cpp:1297</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_effective_sparsity_threshold_html_a837b688e0d981fb89c3ca147f2daff24"><div class="ttname"><a href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a837b688e0d981fb89c3ca147f2daff24">DRO::VariableEffectiveSparsityThreshold::VariableEffectiveSparsityThreshold</a></div><div class="ttdeci">VariableEffectiveSparsityThreshold(cuint popID)</div><div class="ttdef"><b>Definition</b> <a href="#l01294">datareductionoperator.cpp:1294</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_effective_sparsity_threshold_html_a87efdb59ed07ac401d134ec41655f3fc"><div class="ttname"><a href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a87efdb59ed07ac401d134ec41655f3fc">DRO::VariableEffectiveSparsityThreshold::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l01308">datareductionoperator.cpp:1308</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_effective_sparsity_threshold_html_a9e4af3bae5027f2e963a9efd5ccb2299"><div class="ttname"><a href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#a9e4af3bae5027f2e963a9efd5ccb2299">DRO::VariableEffectiveSparsityThreshold::popName</a></div><div class="ttdeci">std::string popName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00539">datareductionoperator.h:539</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_effective_sparsity_threshold_html_ab118dd930ae3b930b3d094aa4bf21ac1"><div class="ttname"><a href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#ab118dd930ae3b930b3d094aa4bf21ac1">DRO::VariableEffectiveSparsityThreshold::popID</a></div><div class="ttdeci">uint popID</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00538">datareductionoperator.h:538</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_effective_sparsity_threshold_html_ad1abf6e695eacca7eaed524ecde30a62"><div class="ttname"><a href="../../da/ddf/class_d_r_o_1_1_variable_effective_sparsity_threshold.html#ad1abf6e695eacca7eaed524ecde30a62">DRO::VariableEffectiveSparsityThreshold::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l01306">datareductionoperator.cpp:1306</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_energy_density_html_a1beaf12103930269e8c356404fdb6e36"><div class="ttname"><a href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a1beaf12103930269e8c356404fdb6e36">DRO::VariableEnergyDensity::EDensity</a></div><div class="ttdeci">Real EDensity[3]</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00556">datareductionoperator.h:556</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_energy_density_html_a230c51cbe9c380ed8f1c6cce08449efe"><div class="ttname"><a href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a230c51cbe9c380ed8f1c6cce08449efe">DRO::VariableEnergyDensity::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l01700">datareductionoperator.cpp:1700</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_energy_density_html_a267ee7737fe146f856e2012d413ecc83"><div class="ttname"><a href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a267ee7737fe146f856e2012d413ecc83">DRO::VariableEnergyDensity::popID</a></div><div class="ttdeci">uint popID</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00554">datareductionoperator.h:554</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_energy_density_html_a39c89b548b451615566e01f95e202e79"><div class="ttname"><a href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a39c89b548b451615566e01f95e202e79">DRO::VariableEnergyDensity::writeParameters</a></div><div class="ttdeci">virtual bool writeParameters(vlsv::Writer &amp;vlsvWriter)</div><div class="ttdef"><b>Definition</b> <a href="#l01767">datareductionoperator.cpp:1767</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_energy_density_html_a42d627340b0e896827461f2e14e988d0"><div class="ttname"><a href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a42d627340b0e896827461f2e14e988d0">DRO::VariableEnergyDensity::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l01760">datareductionoperator.cpp:1760</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_energy_density_html_a81ec9c7f0b7fb4a26b8193de110d28a0"><div class="ttname"><a href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a81ec9c7f0b7fb4a26b8193de110d28a0">DRO::VariableEnergyDensity::solarwindenergy</a></div><div class="ttdeci">Real solarwindenergy</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00557">datareductionoperator.h:557</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_energy_density_html_a922245027b409e3109a80253cabec4ba"><div class="ttname"><a href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#a922245027b409e3109a80253cabec4ba">DRO::VariableEnergyDensity::VariableEnergyDensity</a></div><div class="ttdeci">VariableEnergyDensity(cuint popID)</div><div class="ttdoc">Energy density Calculates the energy density of particles in three bins: total energy density,...</div><div class="ttdef"><b>Definition</b> <a href="#l01691">datareductionoperator.cpp:1691</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_energy_density_html_ab9bc820a8798f416be718b8cc4cf5bd1"><div class="ttname"><a href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#ab9bc820a8798f416be718b8cc4cf5bd1">DRO::VariableEnergyDensity::E1limit</a></div><div class="ttdeci">Real E1limit</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00558">datareductionoperator.h:558</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_energy_density_html_ac2dbbf6431c653a355a3b900d742f247"><div class="ttname"><a href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#ac2dbbf6431c653a355a3b900d742f247">DRO::VariableEnergyDensity::E2limit</a></div><div class="ttdeci">Real E2limit</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00559">datareductionoperator.h:559</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_energy_density_html_acbe1767c02aeb889554738b0aa852b46"><div class="ttname"><a href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#acbe1767c02aeb889554738b0aa852b46">DRO::VariableEnergyDensity::popName</a></div><div class="ttdeci">std::string popName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00555">datareductionoperator.h:555</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_energy_density_html_aebe77e9ad521702336ee3925f2519aff"><div class="ttname"><a href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#aebe77e9ad521702336ee3925f2519aff">DRO::VariableEnergyDensity::~VariableEnergyDensity</a></div><div class="ttdeci">virtual ~VariableEnergyDensity()</div><div class="ttdef"><b>Definition</b> <a href="#l01698">datareductionoperator.cpp:1698</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_energy_density_html_afaf7b171c44df092dcb2e7f9affe02ee"><div class="ttname"><a href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#afaf7b171c44df092dcb2e7f9affe02ee">DRO::VariableEnergyDensity::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l01709">datareductionoperator.cpp:1709</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_energy_density_html_aff42009d8f489b992c6b6d955758f3b8"><div class="ttname"><a href="../../de/db3/class_d_r_o_1_1_variable_energy_density.html#aff42009d8f489b992c6b6d955758f3b8">DRO::VariableEnergyDensity::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l01702">datareductionoperator.cpp:1702</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_heat_flux_vector_html_a0725225936774a492c74e11c92337c73"><div class="ttname"><a href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a0725225936774a492c74e11c92337c73">DRO::VariableHeatFluxVector::popID</a></div><div class="ttdeci">uint popID</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00635">datareductionoperator.h:635</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_heat_flux_vector_html_a2f1142e6c30a77b48b12d6858a8b147d"><div class="ttname"><a href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a2f1142e6c30a77b48b12d6858a8b147d">DRO::VariableHeatFluxVector::HeatFlux</a></div><div class="ttdeci">Real HeatFlux[3]</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00634">datareductionoperator.h:634</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_heat_flux_vector_html_a6d0e42845c3d187f37ed2d725335b7a7"><div class="ttname"><a href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a6d0e42845c3d187f37ed2d725335b7a7">DRO::VariableHeatFluxVector::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l01787">datareductionoperator.cpp:1787</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_heat_flux_vector_html_a757f682124a3be8ede1aed44a9b3942f"><div class="ttname"><a href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a757f682124a3be8ede1aed44a9b3942f">DRO::VariableHeatFluxVector::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l01796">datareductionoperator.cpp:1796</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_heat_flux_vector_html_a83f2f50690584b22df04415172154bcf"><div class="ttname"><a href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#a83f2f50690584b22df04415172154bcf">DRO::VariableHeatFluxVector::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l01789">datareductionoperator.cpp:1789</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_heat_flux_vector_html_acecb621ac82a93190a3dfdb57597ace2"><div class="ttname"><a href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#acecb621ac82a93190a3dfdb57597ace2">DRO::VariableHeatFluxVector::averageVY</a></div><div class="ttdeci">Real averageVY</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00633">datareductionoperator.h:633</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_heat_flux_vector_html_ad6402458be71858e035136892292ce9d"><div class="ttname"><a href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#ad6402458be71858e035136892292ce9d">DRO::VariableHeatFluxVector::~VariableHeatFluxVector</a></div><div class="ttdeci">virtual ~VariableHeatFluxVector()</div><div class="ttdef"><b>Definition</b> <a href="#l01785">datareductionoperator.cpp:1785</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_heat_flux_vector_html_ade404bd77e7e4f86217f6fcc5b2a6fdd"><div class="ttname"><a href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#ade404bd77e7e4f86217f6fcc5b2a6fdd">DRO::VariableHeatFluxVector::averageVZ</a></div><div class="ttdeci">Real averageVZ</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00633">datareductionoperator.h:633</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_heat_flux_vector_html_ae46079af368557cc4f0bab7e1e04967b"><div class="ttname"><a href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#ae46079af368557cc4f0bab7e1e04967b">DRO::VariableHeatFluxVector::VariableHeatFluxVector</a></div><div class="ttdeci">VariableHeatFluxVector(cuint popID)</div><div class="ttdef"><b>Definition</b> <a href="#l01782">datareductionoperator.cpp:1782</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_heat_flux_vector_html_af33aabfe5743de0d77d6d8db8ad38346"><div class="ttname"><a href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#af33aabfe5743de0d77d6d8db8ad38346">DRO::VariableHeatFluxVector::averageVX</a></div><div class="ttdeci">Real averageVX</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00633">datareductionoperator.h:633</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_heat_flux_vector_html_af5e31ea8a3b05824c7271b2fc39bd7d3"><div class="ttname"><a href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#af5e31ea8a3b05824c7271b2fc39bd7d3">DRO::VariableHeatFluxVector::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l01839">datareductionoperator.cpp:1839</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_heat_flux_vector_html_af8e68052e791fdbd4910c7c8fa4e9772"><div class="ttname"><a href="../../d9/d02/class_d_r_o_1_1_variable_heat_flux_vector.html#af8e68052e791fdbd4910c7c8fa4e9772">DRO::VariableHeatFluxVector::popName</a></div><div class="ttdeci">std::string popName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00636">datareductionoperator.h:636</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_mu_space_html_a01226a729d7933f37ac4c86a9093624a"><div class="ttname"><a href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a01226a729d7933f37ac4c86a9093624a">DRO::VariableMuSpace::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l01465">datareductionoperator.cpp:1465</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_mu_space_html_a057a53fbbce95d4cedd400f0c5a6b705"><div class="ttname"><a href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a057a53fbbce95d4cedd400f0c5a6b705">DRO::VariableMuSpace::popName</a></div><div class="ttdeci">std::string popName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00598">datareductionoperator.h:598</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_mu_space_html_a347fbd097e5c7af798233a8fc503d5fb"><div class="ttname"><a href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a347fbd097e5c7af798233a8fc503d5fb">DRO::VariableMuSpace::VariableMuSpace</a></div><div class="ttdeci">VariableMuSpace(cuint popID)</div><div class="ttdoc">V-space flatten into 1D mu distribution.</div><div class="ttdef"><b>Definition</b> <a href="#l01459">datareductionoperator.cpp:1459</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_mu_space_html_a3a7b647f76f584053946b33790694a00"><div class="ttname"><a href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a3a7b647f76f584053946b33790694a00">DRO::VariableMuSpace::popID</a></div><div class="ttdeci">uint popID</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00597">datareductionoperator.h:597</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_mu_space_html_a4a0dc6ab33464086c84d02f3a9d975e9"><div class="ttname"><a href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a4a0dc6ab33464086c84d02f3a9d975e9">DRO::VariableMuSpace::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l01531">datareductionoperator.cpp:1531</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_mu_space_html_a51ea6a193661bd98a33e84d5ddbdcf06"><div class="ttname"><a href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a51ea6a193661bd98a33e84d5ddbdcf06">DRO::VariableMuSpace::~VariableMuSpace</a></div><div class="ttdeci">virtual ~VariableMuSpace()</div><div class="ttdef"><b>Definition</b> <a href="#l01463">datareductionoperator.cpp:1463</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_mu_space_html_a6428de05a5d75559e5731c55e0b5fdc9"><div class="ttname"><a href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a6428de05a5d75559e5731c55e0b5fdc9">DRO::VariableMuSpace::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l01474">datareductionoperator.cpp:1474</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_mu_space_html_a993f219e3d1ff6c830a3c6421e254a29"><div class="ttname"><a href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#a993f219e3d1ff6c830a3c6421e254a29">DRO::VariableMuSpace::nBins</a></div><div class="ttdeci">int nBins</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00599">datareductionoperator.h:599</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_mu_space_html_aaebcf60db3207f08e2fbf0c17bf9e83e"><div class="ttname"><a href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#aaebcf60db3207f08e2fbf0c17bf9e83e">DRO::VariableMuSpace::writeParameters</a></div><div class="ttdeci">virtual bool writeParameters(vlsv::Writer &amp;vlsvWriter)</div><div class="ttdef"><b>Definition</b> <a href="#l01535">datareductionoperator.cpp:1535</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_mu_space_html_af7a7225b04d7ddacd1a8e0681ced4d8f"><div class="ttname"><a href="../../d5/dc9/class_d_r_o_1_1_variable_mu_space.html#af7a7225b04d7ddacd1a8e0681ced4d8f">DRO::VariableMuSpace::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l01467">datareductionoperator.cpp:1467</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_non_maxwellianity_html_a196ed7a4fc42822fd7972975b7572184"><div class="ttname"><a href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a196ed7a4fc42822fd7972975b7572184">DRO::VariableNonMaxwellianity::b_perp1</a></div><div class="ttdeci">Real b_perp1[3]</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00654">datareductionoperator.h:654</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_non_maxwellianity_html_a20f1e60cb924583ad613fef221905dda"><div class="ttname"><a href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a20f1e60cb924583ad613fef221905dda">DRO::VariableNonMaxwellianity::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l01952">datareductionoperator.cpp:1952</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_non_maxwellianity_html_a2ce521814abddd4030323fce546cf854"><div class="ttname"><a href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a2ce521814abddd4030323fce546cf854">DRO::VariableNonMaxwellianity::T_par</a></div><div class="ttdeci">Real T_par</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00656">datareductionoperator.h:656</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_non_maxwellianity_html_a2d95a2ddb7b9711dc202abfdef04d281"><div class="ttname"><a href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a2d95a2ddb7b9711dc202abfdef04d281">DRO::VariableNonMaxwellianity::popName</a></div><div class="ttdeci">std::string popName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00660">datareductionoperator.h:660</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_non_maxwellianity_html_a42cf5ce0b8524b9637ede4ab80afe514"><div class="ttname"><a href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a42cf5ce0b8524b9637ede4ab80afe514">DRO::VariableNonMaxwellianity::b_perp2</a></div><div class="ttdeci">Real b_perp2[3]</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00655">datareductionoperator.h:655</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_non_maxwellianity_html_a4930ebf4b3723e655ba21bc2ca7fe90c"><div class="ttname"><a href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a4930ebf4b3723e655ba21bc2ca7fe90c">DRO::VariableNonMaxwellianity::epsilon</a></div><div class="ttdeci">Real epsilon</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00658">datareductionoperator.h:658</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_non_maxwellianity_html_a820e05d9a25e557283cdca0b5d3965ce"><div class="ttname"><a href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a820e05d9a25e557283cdca0b5d3965ce">DRO::VariableNonMaxwellianity::~VariableNonMaxwellianity</a></div><div class="ttdeci">virtual ~VariableNonMaxwellianity()</div><div class="ttdef"><b>Definition</b> <a href="#l01870">datareductionoperator.cpp:1870</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_non_maxwellianity_html_a8330c79701e860f305ee3545398d12aa"><div class="ttname"><a href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a8330c79701e860f305ee3545398d12aa">DRO::VariableNonMaxwellianity::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l01872">datareductionoperator.cpp:1872</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_non_maxwellianity_html_a928561fa89fb82003ce56e7bb07763b0"><div class="ttname"><a href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#a928561fa89fb82003ce56e7bb07763b0">DRO::VariableNonMaxwellianity::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l01874">datareductionoperator.cpp:1874</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_non_maxwellianity_html_aa0af9944d55f557b042ace096ccd1fe8"><div class="ttname"><a href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#aa0af9944d55f557b042ace096ccd1fe8">DRO::VariableNonMaxwellianity::rho</a></div><div class="ttdeci">Real rho</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00651">datareductionoperator.h:651</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_non_maxwellianity_html_ab022303e10bc89144e83952b581bb0ef"><div class="ttname"><a href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ab022303e10bc89144e83952b581bb0ef">DRO::VariableNonMaxwellianity::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l01882">datareductionoperator.cpp:1882</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_non_maxwellianity_html_ab3911fb2d37da0ccd13a0b5100c3fae8"><div class="ttname"><a href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ab3911fb2d37da0ccd13a0b5100c3fae8">DRO::VariableNonMaxwellianity::V0</a></div><div class="ttdeci">Real V0[3]</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00652">datareductionoperator.h:652</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_non_maxwellianity_html_abaa8fb7fdb3f91ea2f820afcdf680f6a"><div class="ttname"><a href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#abaa8fb7fdb3f91ea2f820afcdf680f6a">DRO::VariableNonMaxwellianity::b_par</a></div><div class="ttdeci">Real b_par[3]</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00653">datareductionoperator.h:653</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_non_maxwellianity_html_acfd536cdda04c333cb9ab15cbc54bc7d"><div class="ttname"><a href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#acfd536cdda04c333cb9ab15cbc54bc7d">DRO::VariableNonMaxwellianity::popID</a></div><div class="ttdeci">uint popID</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00659">datareductionoperator.h:659</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_non_maxwellianity_html_ae015b4bf0a6495d267fb86012ccca8d6"><div class="ttname"><a href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#ae015b4bf0a6495d267fb86012ccca8d6">DRO::VariableNonMaxwellianity::T_perp</a></div><div class="ttdeci">Real T_perp</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00657">datareductionoperator.h:657</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_non_maxwellianity_html_af3b23b34569cbb13310862061d808b03"><div class="ttname"><a href="../../db/d16/class_d_r_o_1_1_variable_non_maxwellianity.html#af3b23b34569cbb13310862061d808b03">DRO::VariableNonMaxwellianity::VariableNonMaxwellianity</a></div><div class="ttdeci">VariableNonMaxwellianity(cuint popID)</div><div class="ttdoc">Non-Maxwellianity Calculates for a population the dimensionless parameter defined by Graham et al....</div><div class="ttdef"><b>Definition</b> <a href="#l01867">datareductionoperator.cpp:1867</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_diagonal_html_a1a2f574e6c0979aa8816694f509fb305"><div class="ttname"><a href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a1a2f574e6c0979aa8816694f509fb305">DRO::VariablePTensorDiagonal::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l00641">datareductionoperator.cpp:641</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_diagonal_html_a256bc92ab8e6737cca2b70dc81708700"><div class="ttname"><a href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a256bc92ab8e6737cca2b70dc81708700">DRO::VariablePTensorDiagonal::PTensor</a></div><div class="ttdeci">Real PTensor[3]</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00336">datareductionoperator.h:336</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_diagonal_html_a36656ec9d41a50f7a9c3d795438a2f1d"><div class="ttname"><a href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a36656ec9d41a50f7a9c3d795438a2f1d">DRO::VariablePTensorDiagonal::popName</a></div><div class="ttdeci">std::string popName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00338">datareductionoperator.h:338</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_diagonal_html_a3b4f8f038178eb30e30aa0232bb374ab"><div class="ttname"><a href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a3b4f8f038178eb30e30aa0232bb374ab">DRO::VariablePTensorDiagonal::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l00594">datareductionoperator.cpp:594</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_diagonal_html_a49ffb829d7478815c3c65e5600a45bd4"><div class="ttname"><a href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a49ffb829d7478815c3c65e5600a45bd4">DRO::VariablePTensorDiagonal::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l00592">datareductionoperator.cpp:592</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_diagonal_html_a576feac0afcf3d416ccd684d46da7f8d"><div class="ttname"><a href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a576feac0afcf3d416ccd684d46da7f8d">DRO::VariablePTensorDiagonal::popID</a></div><div class="ttdeci">uint popID</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00337">datareductionoperator.h:337</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_diagonal_html_a577f183622516a1ad3f96cc7421821fc"><div class="ttname"><a href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a577f183622516a1ad3f96cc7421821fc">DRO::VariablePTensorDiagonal::~VariablePTensorDiagonal</a></div><div class="ttdeci">virtual ~VariablePTensorDiagonal()</div><div class="ttdef"><b>Definition</b> <a href="#l00590">datareductionoperator.cpp:590</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_diagonal_html_a5f8c127b61116e821e5ea39e03608116"><div class="ttname"><a href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a5f8c127b61116e821e5ea39e03608116">DRO::VariablePTensorDiagonal::averageVY</a></div><div class="ttdeci">Real averageVY</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00335">datareductionoperator.h:335</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_diagonal_html_a859f532973b32c3d2f56bb8256395e2c"><div class="ttname"><a href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#a859f532973b32c3d2f56bb8256395e2c">DRO::VariablePTensorDiagonal::averageVZ</a></div><div class="ttdeci">Real averageVZ</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00335">datareductionoperator.h:335</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_diagonal_html_aa15257d3bb97e6324d14208620f088ce"><div class="ttname"><a href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#aa15257d3bb97e6324d14208620f088ce">DRO::VariablePTensorDiagonal::averageVX</a></div><div class="ttdeci">Real averageVX</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00335">datareductionoperator.h:335</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_diagonal_html_ad1a2db2e02752d3b2692ae3dd7e88cef"><div class="ttname"><a href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#ad1a2db2e02752d3b2692ae3dd7e88cef">DRO::VariablePTensorDiagonal::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l00601">datareductionoperator.cpp:601</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_diagonal_html_af5a8f2f47daf18177a8d0822cfc18bc3"><div class="ttname"><a href="../../de/dfd/class_d_r_o_1_1_variable_p_tensor_diagonal.html#af5a8f2f47daf18177a8d0822cfc18bc3">DRO::VariablePTensorDiagonal::VariablePTensorDiagonal</a></div><div class="ttdeci">VariablePTensorDiagonal(cuint popID)</div><div class="ttdef"><b>Definition</b> <a href="#l00587">datareductionoperator.cpp:587</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal_html_a12b79665c139384a797e0c95a57bff40"><div class="ttname"><a href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a12b79665c139384a797e0c95a57bff40">DRO::VariablePTensorNonthermalDiagonal::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l01130">datareductionoperator.cpp:1130</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal_html_a30ae26b2317786ec419f1d752798b03f"><div class="ttname"><a href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a30ae26b2317786ec419f1d752798b03f">DRO::VariablePTensorNonthermalDiagonal::popName</a></div><div class="ttdeci">std::string popName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00486">datareductionoperator.h:486</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal_html_a3d552c3144ead72eab8a08797e50c8e1"><div class="ttname"><a href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a3d552c3144ead72eab8a08797e50c8e1">DRO::VariablePTensorNonthermalDiagonal::averageVY</a></div><div class="ttdeci">Real averageVY</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00483">datareductionoperator.h:483</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal_html_a58f68fd5d361ad30c92ab3d56e0168c1"><div class="ttname"><a href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a58f68fd5d361ad30c92ab3d56e0168c1">DRO::VariablePTensorNonthermalDiagonal::doSkip</a></div><div class="ttdeci">bool doSkip</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00487">datareductionoperator.h:487</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal_html_a5c6df6835c7b5a3e34139e78a9e974e0"><div class="ttname"><a href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a5c6df6835c7b5a3e34139e78a9e974e0">DRO::VariablePTensorNonthermalDiagonal::averageVX</a></div><div class="ttdeci">Real averageVX</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00483">datareductionoperator.h:483</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal_html_a6dd13c3030a1869205c1771afd0d7b39"><div class="ttname"><a href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a6dd13c3030a1869205c1771afd0d7b39">DRO::VariablePTensorNonthermalDiagonal::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l01121">datareductionoperator.cpp:1121</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal_html_a9316ea8410fbf7e6444dd620acd22a18"><div class="ttname"><a href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a9316ea8410fbf7e6444dd620acd22a18">DRO::VariablePTensorNonthermalDiagonal::popID</a></div><div class="ttdeci">uint popID</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00485">datareductionoperator.h:485</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal_html_a995d71d08684d83bbe4ce410918b0b0e"><div class="ttname"><a href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#a995d71d08684d83bbe4ce410918b0b0e">DRO::VariablePTensorNonthermalDiagonal::VariablePTensorNonthermalDiagonal</a></div><div class="ttdeci">VariablePTensorNonthermalDiagonal(cuint popID)</div><div class="ttdef"><b>Definition</b> <a href="#l01115">datareductionoperator.cpp:1115</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal_html_aae1a358d68bb9b959ee358447bc3dd88"><div class="ttname"><a href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#aae1a358d68bb9b959ee358447bc3dd88">DRO::VariablePTensorNonthermalDiagonal::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l01123">datareductionoperator.cpp:1123</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal_html_ac0a02f0976c18fa7f6439931193f8d05"><div class="ttname"><a href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#ac0a02f0976c18fa7f6439931193f8d05">DRO::VariablePTensorNonthermalDiagonal::~VariablePTensorNonthermalDiagonal</a></div><div class="ttdeci">virtual ~VariablePTensorNonthermalDiagonal()</div><div class="ttdef"><b>Definition</b> <a href="#l01119">datareductionoperator.cpp:1119</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal_html_aeb1bf23342fcdeb511c7fd249e889793"><div class="ttname"><a href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#aeb1bf23342fcdeb511c7fd249e889793">DRO::VariablePTensorNonthermalDiagonal::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l01141">datareductionoperator.cpp:1141</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal_html_af36b30a302e6a6234a96c38e25d8facd"><div class="ttname"><a href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#af36b30a302e6a6234a96c38e25d8facd">DRO::VariablePTensorNonthermalDiagonal::averageVZ</a></div><div class="ttdeci">Real averageVZ</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00483">datareductionoperator.h:483</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal_html_afeb9ca274b319bccf1338ccb7320e985"><div class="ttname"><a href="../../de/dd1/class_d_r_o_1_1_variable_p_tensor_nonthermal_diagonal.html#afeb9ca274b319bccf1338ccb7320e985">DRO::VariablePTensorNonthermalDiagonal::PTensor</a></div><div class="ttdeci">Real PTensor[3]</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00484">datareductionoperator.h:484</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal_html_a09255a9c48776fcc8db0e68a0425d884"><div class="ttname"><a href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a09255a9c48776fcc8db0e68a0425d884">DRO::VariablePTensorNonthermalOffDiagonal::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l01234">datareductionoperator.cpp:1234</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal_html_a0991dd8d4929942c7a04cf5ddb198959"><div class="ttname"><a href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a0991dd8d4929942c7a04cf5ddb198959">DRO::VariablePTensorNonthermalOffDiagonal::PTensor</a></div><div class="ttdeci">Real PTensor[3]</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00520">datareductionoperator.h:520</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal_html_a0a4e5ad4ac08f01b712069632e33a9a9"><div class="ttname"><a href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a0a4e5ad4ac08f01b712069632e33a9a9">DRO::VariablePTensorNonthermalOffDiagonal::averageVX</a></div><div class="ttdeci">Real averageVX</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00519">datareductionoperator.h:519</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal_html_a18537446bcbb7221c14125199afaaf0c"><div class="ttname"><a href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a18537446bcbb7221c14125199afaaf0c">DRO::VariablePTensorNonthermalOffDiagonal::averageVZ</a></div><div class="ttdeci">Real averageVZ</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00519">datareductionoperator.h:519</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal_html_a1d93106e4d9e964429f560d4b4582974"><div class="ttname"><a href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a1d93106e4d9e964429f560d4b4582974">DRO::VariablePTensorNonthermalOffDiagonal::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l01211">datareductionoperator.cpp:1211</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal_html_a43347c376a93bcf6ea5f7b183ca2dab2"><div class="ttname"><a href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a43347c376a93bcf6ea5f7b183ca2dab2">DRO::VariablePTensorNonthermalOffDiagonal::doSkip</a></div><div class="ttdeci">bool doSkip</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00523">datareductionoperator.h:523</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal_html_a4f087d80e4f2743ea1cfe63879472a83"><div class="ttname"><a href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a4f087d80e4f2743ea1cfe63879472a83">DRO::VariablePTensorNonthermalOffDiagonal::popID</a></div><div class="ttdeci">uint popID</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00521">datareductionoperator.h:521</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal_html_a636c26a7b70ed417bd4ddb673c7cf150"><div class="ttname"><a href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a636c26a7b70ed417bd4ddb673c7cf150">DRO::VariablePTensorNonthermalOffDiagonal::VariablePTensorNonthermalOffDiagonal</a></div><div class="ttdeci">VariablePTensorNonthermalOffDiagonal(cuint popID)</div><div class="ttdef"><b>Definition</b> <a href="#l01205">datareductionoperator.cpp:1205</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal_html_a7c73c46b3d0d33c05776432ca3a3c040"><div class="ttname"><a href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a7c73c46b3d0d33c05776432ca3a3c040">DRO::VariablePTensorNonthermalOffDiagonal::popName</a></div><div class="ttdeci">std::string popName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00522">datareductionoperator.h:522</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal_html_a7dcb58b9932d8ae54233657d898a2206"><div class="ttname"><a href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#a7dcb58b9932d8ae54233657d898a2206">DRO::VariablePTensorNonthermalOffDiagonal::averageVY</a></div><div class="ttdeci">Real averageVY</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00519">datareductionoperator.h:519</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal_html_aa1c7d07e73c56e2e434b2388de6c7406"><div class="ttname"><a href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#aa1c7d07e73c56e2e434b2388de6c7406">DRO::VariablePTensorNonthermalOffDiagonal::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l01220">datareductionoperator.cpp:1220</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal_html_abf09ba1c432d0622cfe7a4e61a0d890f"><div class="ttname"><a href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#abf09ba1c432d0622cfe7a4e61a0d890f">DRO::VariablePTensorNonthermalOffDiagonal::~VariablePTensorNonthermalOffDiagonal</a></div><div class="ttdeci">virtual ~VariablePTensorNonthermalOffDiagonal()</div><div class="ttdef"><b>Definition</b> <a href="#l01209">datareductionoperator.cpp:1209</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal_html_afa8419f2b016496d58742ca6fee9cc77"><div class="ttname"><a href="../../d1/de4/class_d_r_o_1_1_variable_p_tensor_nonthermal_off_diagonal.html#afa8419f2b016496d58742ca6fee9cc77">DRO::VariablePTensorNonthermalOffDiagonal::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l01213">datareductionoperator.cpp:1213</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_off_diagonal_html_a0581e11beeca2b0ce1ca359aa043e13e"><div class="ttname"><a href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a0581e11beeca2b0ce1ca359aa043e13e">DRO::VariablePTensorOffDiagonal::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l00665">datareductionoperator.cpp:665</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_off_diagonal_html_a44319ec8f1d10c2c52563dac5c643fc1"><div class="ttname"><a href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a44319ec8f1d10c2c52563dac5c643fc1">DRO::VariablePTensorOffDiagonal::VariablePTensorOffDiagonal</a></div><div class="ttdeci">VariablePTensorOffDiagonal(cuint popID)</div><div class="ttdef"><b>Definition</b> <a href="#l00651">datareductionoperator.cpp:651</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_off_diagonal_html_a51844b71a2319e2975b315423310afed"><div class="ttname"><a href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a51844b71a2319e2975b315423310afed">DRO::VariablePTensorOffDiagonal::~VariablePTensorOffDiagonal</a></div><div class="ttdeci">virtual ~VariablePTensorOffDiagonal()</div><div class="ttdef"><b>Definition</b> <a href="#l00654">datareductionoperator.cpp:654</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_off_diagonal_html_a57dd22bbfbd474a4f51db129981e2901"><div class="ttname"><a href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a57dd22bbfbd474a4f51db129981e2901">DRO::VariablePTensorOffDiagonal::popID</a></div><div class="ttdeci">uint popID</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00354">datareductionoperator.h:354</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_off_diagonal_html_a5b14d5cd348e69987e08315df544865d"><div class="ttname"><a href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a5b14d5cd348e69987e08315df544865d">DRO::VariablePTensorOffDiagonal::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l00704">datareductionoperator.cpp:704</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_off_diagonal_html_a5f2e0b86241ee62adee64ca874e70749"><div class="ttname"><a href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#a5f2e0b86241ee62adee64ca874e70749">DRO::VariablePTensorOffDiagonal::PTensor</a></div><div class="ttdeci">Real PTensor[3]</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00353">datareductionoperator.h:353</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_off_diagonal_html_ac575804d5b7d1f3872b89306314c2c8e"><div class="ttname"><a href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#ac575804d5b7d1f3872b89306314c2c8e">DRO::VariablePTensorOffDiagonal::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l00656">datareductionoperator.cpp:656</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_off_diagonal_html_ae7b6c008f6f7ee3ffaaa049132ae0a35"><div class="ttname"><a href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#ae7b6c008f6f7ee3ffaaa049132ae0a35">DRO::VariablePTensorOffDiagonal::averageVX</a></div><div class="ttdeci">Real averageVX</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00352">datareductionoperator.h:352</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_off_diagonal_html_af51d0b0cbf9d05243c6612aba1b77319"><div class="ttname"><a href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#af51d0b0cbf9d05243c6612aba1b77319">DRO::VariablePTensorOffDiagonal::popName</a></div><div class="ttdeci">std::string popName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00355">datareductionoperator.h:355</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_off_diagonal_html_af75174b28e1d77cbc477fb188a40f781"><div class="ttname"><a href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#af75174b28e1d77cbc477fb188a40f781">DRO::VariablePTensorOffDiagonal::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l00658">datareductionoperator.cpp:658</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_off_diagonal_html_afa2cb559da09b99f49d0b444bb3855a2"><div class="ttname"><a href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#afa2cb559da09b99f49d0b444bb3855a2">DRO::VariablePTensorOffDiagonal::averageVZ</a></div><div class="ttdeci">Real averageVZ</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00352">datareductionoperator.h:352</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_off_diagonal_html_afc53c9d4596f525ce7731657fed7377a"><div class="ttname"><a href="../../d1/d43/class_d_r_o_1_1_variable_p_tensor_off_diagonal.html#afc53c9d4596f525ce7731657fed7377a">DRO::VariablePTensorOffDiagonal::averageVY</a></div><div class="ttdeci">Real averageVY</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00352">datareductionoperator.h:352</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_diagonal_html_a43763c25deb35c8fde46b0589c92684c"><div class="ttname"><a href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#a43763c25deb35c8fde46b0589c92684c">DRO::VariablePTensorThermalDiagonal::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l01171">datareductionoperator.cpp:1171</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_diagonal_html_a7d7bd7c7c683802cfb779547c808c9dc"><div class="ttname"><a href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#a7d7bd7c7c683802cfb779547c808c9dc">DRO::VariablePTensorThermalDiagonal::doSkip</a></div><div class="ttdeci">bool doSkip</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00469">datareductionoperator.h:469</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_diagonal_html_a7d93ea81a699a4b66e92e0436c4b2d61"><div class="ttname"><a href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#a7d93ea81a699a4b66e92e0436c4b2d61">DRO::VariablePTensorThermalDiagonal::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l01169">datareductionoperator.cpp:1169</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_diagonal_html_a86b1f715975e6222b6367e0916aaa9e1"><div class="ttname"><a href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#a86b1f715975e6222b6367e0916aaa9e1">DRO::VariablePTensorThermalDiagonal::VariablePTensorThermalDiagonal</a></div><div class="ttdeci">VariablePTensorThermalDiagonal(cuint popID)</div><div class="ttdef"><b>Definition</b> <a href="#l01163">datareductionoperator.cpp:1163</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_diagonal_html_a9a6656698db627f541d118692624c5e4"><div class="ttname"><a href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#a9a6656698db627f541d118692624c5e4">DRO::VariablePTensorThermalDiagonal::averageVY</a></div><div class="ttdeci">Real averageVY</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00465">datareductionoperator.h:465</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_diagonal_html_a9eb21a26e54dc0729b8772dffa228ffa"><div class="ttname"><a href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#a9eb21a26e54dc0729b8772dffa228ffa">DRO::VariablePTensorThermalDiagonal::averageVX</a></div><div class="ttdeci">Real averageVX</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00465">datareductionoperator.h:465</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_diagonal_html_a9fc98f5e8da0e87079da2c329e99a95d"><div class="ttname"><a href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#a9fc98f5e8da0e87079da2c329e99a95d">DRO::VariablePTensorThermalDiagonal::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l01178">datareductionoperator.cpp:1178</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_diagonal_html_aae95094f294f5a90933141367078e42c"><div class="ttname"><a href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#aae95094f294f5a90933141367078e42c">DRO::VariablePTensorThermalDiagonal::PTensor</a></div><div class="ttdeci">Real PTensor[3]</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00466">datareductionoperator.h:466</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_diagonal_html_ab83f7f09a40d88eb216e228cfa866fb5"><div class="ttname"><a href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#ab83f7f09a40d88eb216e228cfa866fb5">DRO::VariablePTensorThermalDiagonal::popID</a></div><div class="ttdeci">uint popID</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00467">datareductionoperator.h:467</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_diagonal_html_ac4f3ad08111b62709c4f1ad0b4770d4a"><div class="ttname"><a href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#ac4f3ad08111b62709c4f1ad0b4770d4a">DRO::VariablePTensorThermalDiagonal::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l01189">datareductionoperator.cpp:1189</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_diagonal_html_ae0d78dfbd648310610281924cefbf292"><div class="ttname"><a href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#ae0d78dfbd648310610281924cefbf292">DRO::VariablePTensorThermalDiagonal::~VariablePTensorThermalDiagonal</a></div><div class="ttdeci">virtual ~VariablePTensorThermalDiagonal()</div><div class="ttdef"><b>Definition</b> <a href="#l01167">datareductionoperator.cpp:1167</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_diagonal_html_aec577889c883303cf41f9a69f5aa8bad"><div class="ttname"><a href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#aec577889c883303cf41f9a69f5aa8bad">DRO::VariablePTensorThermalDiagonal::popName</a></div><div class="ttdeci">std::string popName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00468">datareductionoperator.h:468</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_diagonal_html_af2e017c1b98e0a219e68b035d2839616"><div class="ttname"><a href="../../d0/dc0/class_d_r_o_1_1_variable_p_tensor_thermal_diagonal.html#af2e017c1b98e0a219e68b035d2839616">DRO::VariablePTensorThermalDiagonal::averageVZ</a></div><div class="ttdeci">Real averageVZ</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00465">datareductionoperator.h:465</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal_html_a1dda849ee3044d59d13a1be237cc2c15"><div class="ttname"><a href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a1dda849ee3044d59d13a1be237cc2c15">DRO::VariablePTensorThermalOffDiagonal::~VariablePTensorThermalOffDiagonal</a></div><div class="ttdeci">virtual ~VariablePTensorThermalOffDiagonal()</div><div class="ttdef"><b>Definition</b> <a href="#l01253">datareductionoperator.cpp:1253</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal_html_a383dda2255f8c5372d8e752ab36db8d8"><div class="ttname"><a href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a383dda2255f8c5372d8e752ab36db8d8">DRO::VariablePTensorThermalOffDiagonal::doSkip</a></div><div class="ttdeci">bool doSkip</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00505">datareductionoperator.h:505</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal_html_a3b7db01778382478d2b01b8c1847877a"><div class="ttname"><a href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a3b7db01778382478d2b01b8c1847877a">DRO::VariablePTensorThermalOffDiagonal::averageVY</a></div><div class="ttdeci">Real averageVY</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00501">datareductionoperator.h:501</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal_html_a3bd55ffced2c5d0eaaca36d1f3202904"><div class="ttname"><a href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a3bd55ffced2c5d0eaaca36d1f3202904">DRO::VariablePTensorThermalOffDiagonal::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l01278">datareductionoperator.cpp:1278</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal_html_a55cc4bb926a981087ea75c04fd29934a"><div class="ttname"><a href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a55cc4bb926a981087ea75c04fd29934a">DRO::VariablePTensorThermalOffDiagonal::popID</a></div><div class="ttdeci">uint popID</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00503">datareductionoperator.h:503</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal_html_a57735c40b14c08ce5faf6fdce774905d"><div class="ttname"><a href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a57735c40b14c08ce5faf6fdce774905d">DRO::VariablePTensorThermalOffDiagonal::VariablePTensorThermalOffDiagonal</a></div><div class="ttdeci">VariablePTensorThermalOffDiagonal(cuint popID)</div><div class="ttdef"><b>Definition</b> <a href="#l01249">datareductionoperator.cpp:1249</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal_html_a686661ccca4ec8a67db837dde49d0e52"><div class="ttname"><a href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#a686661ccca4ec8a67db837dde49d0e52">DRO::VariablePTensorThermalOffDiagonal::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l01257">datareductionoperator.cpp:1257</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal_html_aab5199172396fa9b1b7c058231a0b61c"><div class="ttname"><a href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#aab5199172396fa9b1b7c058231a0b61c">DRO::VariablePTensorThermalOffDiagonal::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l01255">datareductionoperator.cpp:1255</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal_html_aaf0ad6d93e2b89abad47d71ff88cfa0b"><div class="ttname"><a href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#aaf0ad6d93e2b89abad47d71ff88cfa0b">DRO::VariablePTensorThermalOffDiagonal::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l01264">datareductionoperator.cpp:1264</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal_html_abc9338897137c19e50f493f991f345be"><div class="ttname"><a href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#abc9338897137c19e50f493f991f345be">DRO::VariablePTensorThermalOffDiagonal::popName</a></div><div class="ttdeci">std::string popName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00504">datareductionoperator.h:504</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal_html_acc8fc9e94197e9d6a61c83d767222d34"><div class="ttname"><a href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#acc8fc9e94197e9d6a61c83d767222d34">DRO::VariablePTensorThermalOffDiagonal::PTensor</a></div><div class="ttdeci">Real PTensor[3]</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00502">datareductionoperator.h:502</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal_html_ad777597108ab514d7d8ea2e82c5aa9ba"><div class="ttname"><a href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#ad777597108ab514d7d8ea2e82c5aa9ba">DRO::VariablePTensorThermalOffDiagonal::averageVZ</a></div><div class="ttdeci">Real averageVZ</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00501">datareductionoperator.h:501</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal_html_af26d404db73374c229016f510e4c1e58"><div class="ttname"><a href="../../d1/de8/class_d_r_o_1_1_variable_p_tensor_thermal_off_diagonal.html#af26d404db73374c229016f510e4c1e58">DRO::VariablePTensorThermalOffDiagonal::averageVX</a></div><div class="ttdeci">Real averageVX</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00501">datareductionoperator.h:501</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_diff_flux_html_a0766447359b57dc5727154ca296f9d76"><div class="ttname"><a href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a0766447359b57dc5727154ca296f9d76">DRO::VariablePrecipitationDiffFlux::popID</a></div><div class="ttdeci">uint popID</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00575">datareductionoperator.h:575</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_diff_flux_html_a2dc9aea62424a7ebd0c9499ea4f8fb85"><div class="ttname"><a href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a2dc9aea62424a7ebd0c9499ea4f8fb85">DRO::VariablePrecipitationDiffFlux::writeParameters</a></div><div class="ttdeci">virtual bool writeParameters(vlsv::Writer &amp;vlsvWriter)</div><div class="ttdef"><b>Definition</b> <a href="#l01448">datareductionoperator.cpp:1448</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_diff_flux_html_a4205814de8a8fa94bb31b95c925cbc06"><div class="ttname"><a href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a4205814de8a8fa94bb31b95c925cbc06">DRO::VariablePrecipitationDiffFlux::popName</a></div><div class="ttdeci">std::string popName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00576">datareductionoperator.h:576</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_diff_flux_html_a4ca76516a9d661f46668e251e926543e"><div class="ttname"><a href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a4ca76516a9d661f46668e251e926543e">DRO::VariablePrecipitationDiffFlux::emin</a></div><div class="ttdeci">Real emin</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00578">datareductionoperator.h:578</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_diff_flux_html_a5a0a25b1de510ac22d9654462152a977"><div class="ttname"><a href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a5a0a25b1de510ac22d9654462152a977">DRO::VariablePrecipitationDiffFlux::nChannels</a></div><div class="ttdeci">int nChannels</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00577">datareductionoperator.h:577</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_diff_flux_html_a688406b498318337fed03ad079c4d186"><div class="ttname"><a href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a688406b498318337fed03ad079c4d186">DRO::VariablePrecipitationDiffFlux::channels</a></div><div class="ttdeci">std::vector&lt; Real &gt; channels</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00580">datareductionoperator.h:580</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_diff_flux_html_a72af7649d7dc163fc913542c1b84f6c2"><div class="ttname"><a href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a72af7649d7dc163fc913542c1b84f6c2">DRO::VariablePrecipitationDiffFlux::emax</a></div><div class="ttdeci">Real emax</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00578">datareductionoperator.h:578</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_diff_flux_html_a845b8ff3136cb26783219ab9f6b723dd"><div class="ttname"><a href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a845b8ff3136cb26783219ab9f6b723dd">DRO::VariablePrecipitationDiffFlux::dataDiffFlux</a></div><div class="ttdeci">std::vector&lt; Real &gt; dataDiffFlux</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00580">datareductionoperator.h:580</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_diff_flux_html_a958c6b3a402f9b695ba6577febb05c86"><div class="ttname"><a href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#a958c6b3a402f9b695ba6577febb05c86">DRO::VariablePrecipitationDiffFlux::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l01444">datareductionoperator.cpp:1444</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_diff_flux_html_ab0e1d102168746834989a2bef3d8d76f"><div class="ttname"><a href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#ab0e1d102168746834989a2bef3d8d76f">DRO::VariablePrecipitationDiffFlux::VariablePrecipitationDiffFlux</a></div><div class="ttdeci">VariablePrecipitationDiffFlux(cuint popID)</div><div class="ttdoc">Precipitation directional differential number flux (within loss cone) Evaluation of the precipitating...</div><div class="ttdef"><b>Definition</b> <a href="#l01334">datareductionoperator.cpp:1334</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_diff_flux_html_ab149bfa4c732ee30f1e042c9b09728f2"><div class="ttname"><a href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#ab149bfa4c732ee30f1e042c9b09728f2">DRO::VariablePrecipitationDiffFlux::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l01348">datareductionoperator.cpp:1348</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_diff_flux_html_ab15c09a7f743cea10da3dbe12dab7a32"><div class="ttname"><a href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#ab15c09a7f743cea10da3dbe12dab7a32">DRO::VariablePrecipitationDiffFlux::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l01346">datareductionoperator.cpp:1346</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_diff_flux_html_ab196e65f7820268554e89a1614c82b7b"><div class="ttname"><a href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#ab196e65f7820268554e89a1614c82b7b">DRO::VariablePrecipitationDiffFlux::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l01355">datareductionoperator.cpp:1355</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_diff_flux_html_ac2a5b3429c5762a8da06d90ee1237190"><div class="ttname"><a href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#ac2a5b3429c5762a8da06d90ee1237190">DRO::VariablePrecipitationDiffFlux::lossConeAngle</a></div><div class="ttdeci">Real lossConeAngle</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00579">datareductionoperator.h:579</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_diff_flux_html_af0b83624796b6396a78dbec18f9329a4"><div class="ttname"><a href="../../dd/d55/class_d_r_o_1_1_variable_precipitation_diff_flux.html#af0b83624796b6396a78dbec18f9329a4">DRO::VariablePrecipitationDiffFlux::~VariablePrecipitationDiffFlux</a></div><div class="ttdeci">virtual ~VariablePrecipitationDiffFlux()</div><div class="ttdef"><b>Definition</b> <a href="#l01344">datareductionoperator.cpp:1344</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_line_diff_flux_html_a09113b265dfbde206eefea5674fc49b0"><div class="ttname"><a href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a09113b265dfbde206eefea5674fc49b0">DRO::VariablePrecipitationLineDiffFlux::emax</a></div><div class="ttdeci">Real emax</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00617">datareductionoperator.h:617</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_line_diff_flux_html_a30e178bf1427555c158796a3b07a1168"><div class="ttname"><a href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a30e178bf1427555c158796a3b07a1168">DRO::VariablePrecipitationLineDiffFlux::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l01559">datareductionoperator.cpp:1559</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_line_diff_flux_html_a54b5f9dc2c38818b559f88ab9bef9f2e"><div class="ttname"><a href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a54b5f9dc2c38818b559f88ab9bef9f2e">DRO::VariablePrecipitationLineDiffFlux::nChannels</a></div><div class="ttdeci">int nChannels</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00616">datareductionoperator.h:616</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_line_diff_flux_html_a6ab3d21b25488cd96f01fdf85b974c5e"><div class="ttname"><a href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a6ab3d21b25488cd96f01fdf85b974c5e">DRO::VariablePrecipitationLineDiffFlux::popName</a></div><div class="ttdeci">std::string popName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00615">datareductionoperator.h:615</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_line_diff_flux_html_a7868800003996655b2e87b1293430cd1"><div class="ttname"><a href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a7868800003996655b2e87b1293430cd1">DRO::VariablePrecipitationLineDiffFlux::channels</a></div><div class="ttdeci">std::vector&lt; Real &gt; channels</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00618">datareductionoperator.h:618</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_line_diff_flux_html_a93cfd229d05b1e0c0b3673bd4409deaa"><div class="ttname"><a href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#a93cfd229d05b1e0c0b3673bd4409deaa">DRO::VariablePrecipitationLineDiffFlux::~VariablePrecipitationLineDiffFlux</a></div><div class="ttdeci">virtual ~VariablePrecipitationLineDiffFlux()</div><div class="ttdef"><b>Definition</b> <a href="#l01557">datareductionoperator.cpp:1557</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_line_diff_flux_html_aa4d3b4a525d0238b47c89d7697374856"><div class="ttname"><a href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#aa4d3b4a525d0238b47c89d7697374856">DRO::VariablePrecipitationLineDiffFlux::emin</a></div><div class="ttdeci">Real emin</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00617">datareductionoperator.h:617</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_line_diff_flux_html_abaad43f6701f4158e0423cceca255089"><div class="ttname"><a href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#abaad43f6701f4158e0423cceca255089">DRO::VariablePrecipitationLineDiffFlux::popID</a></div><div class="ttdeci">uint popID</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00614">datareductionoperator.h:614</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_line_diff_flux_html_ac14b3c3918e051eb5e42a2797ef69a07"><div class="ttname"><a href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#ac14b3c3918e051eb5e42a2797ef69a07">DRO::VariablePrecipitationLineDiffFlux::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l01666">datareductionoperator.cpp:1666</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_line_diff_flux_html_acc2c214e6e1776407df9c44fef234bbc"><div class="ttname"><a href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#acc2c214e6e1776407df9c44fef234bbc">DRO::VariablePrecipitationLineDiffFlux::dataLineDiffFlux</a></div><div class="ttdeci">std::vector&lt; Real &gt; dataLineDiffFlux</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00618">datareductionoperator.h:618</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_line_diff_flux_html_ace1f4e97f711f0c2077147ae8c594175"><div class="ttname"><a href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#ace1f4e97f711f0c2077147ae8c594175">DRO::VariablePrecipitationLineDiffFlux::VariablePrecipitationLineDiffFlux</a></div><div class="ttdeci">VariablePrecipitationLineDiffFlux(cuint popID)</div><div class="ttdoc">Precipitation directional differential number flux (along line) Evaluation of the precipitating diffe...</div><div class="ttdef"><b>Definition</b> <a href="#l01548">datareductionoperator.cpp:1548</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_line_diff_flux_html_ae5c7d89896343fd468d98a980a08576a"><div class="ttname"><a href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#ae5c7d89896343fd468d98a980a08576a">DRO::VariablePrecipitationLineDiffFlux::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l01561">datareductionoperator.cpp:1561</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_line_diff_flux_html_af93f48e206bc3ea61dc1d10490cd5539"><div class="ttname"><a href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#af93f48e206bc3ea61dc1d10490cd5539">DRO::VariablePrecipitationLineDiffFlux::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l01568">datareductionoperator.cpp:1568</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_precipitation_line_diff_flux_html_afa2dcee8f3b0f97231b9fc29495862d5"><div class="ttname"><a href="../../db/d62/class_d_r_o_1_1_variable_precipitation_line_diff_flux.html#afa2dcee8f3b0f97231b9fc29495862d5">DRO::VariablePrecipitationLineDiffFlux::writeParameters</a></div><div class="ttdeci">virtual bool writeParameters(vlsv::Writer &amp;vlsvWriter)</div><div class="ttdef"><b>Definition</b> <a href="#l01670">datareductionoperator.cpp:1670</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_pressure_solver_html_aa061cccab2f075d9721d828dd3b880b8"><div class="ttname"><a href="../../d6/d9e/class_d_r_o_1_1_variable_pressure_solver.html#aa061cccab2f075d9721d828dd3b880b8">DRO::VariablePressureSolver::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l00561">datareductionoperator.cpp:561</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_pressure_solver_html_aa5d843947ebd793a98c953207f0bbaa6"><div class="ttname"><a href="../../d6/d9e/class_d_r_o_1_1_variable_pressure_solver.html#aa5d843947ebd793a98c953207f0bbaa6">DRO::VariablePressureSolver::~VariablePressureSolver</a></div><div class="ttdeci">virtual ~VariablePressureSolver()</div><div class="ttdef"><b>Definition</b> <a href="#l00559">datareductionoperator.cpp:559</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_pressure_solver_html_ab131be4b23ca54d7f5709b40788f2d2d"><div class="ttname"><a href="../../d6/d9e/class_d_r_o_1_1_variable_pressure_solver.html#ab131be4b23ca54d7f5709b40788f2d2d">DRO::VariablePressureSolver::VariablePressureSolver</a></div><div class="ttdeci">VariablePressureSolver()</div><div class="ttdef"><b>Definition</b> <a href="#l00558">datareductionoperator.cpp:558</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_pressure_solver_html_ab8a6bb2206bfac9513ae40ea18e3302b"><div class="ttname"><a href="../../d6/d9e/class_d_r_o_1_1_variable_pressure_solver.html#ab8a6bb2206bfac9513ae40ea18e3302b">DRO::VariablePressureSolver::Pressure</a></div><div class="ttdeci">Real Pressure</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00321">datareductionoperator.h:321</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_pressure_solver_html_acb54d09fcbacc03be938d4653aef5b7f"><div class="ttname"><a href="../../d6/d9e/class_d_r_o_1_1_variable_pressure_solver.html#acb54d09fcbacc03be938d4653aef5b7f">DRO::VariablePressureSolver::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l00570">datareductionoperator.cpp:570</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_pressure_solver_html_acbb88158769b837d3af825a6f40b55c3"><div class="ttname"><a href="../../d6/d9e/class_d_r_o_1_1_variable_pressure_solver.html#acbb88158769b837d3af825a6f40b55c3">DRO::VariablePressureSolver::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l00576">datareductionoperator.cpp:576</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_pressure_solver_html_aeffd3a116a0fb33af0ae324a4fb8b4d0"><div class="ttname"><a href="../../d6/d9e/class_d_r_o_1_1_variable_pressure_solver.html#aeffd3a116a0fb33af0ae324a4fb8b4d0">DRO::VariablePressureSolver::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l00563">datareductionoperator.cpp:563</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_rho_nonthermal_html_a0cd4d9c16cd360a30461396ed53776e3"><div class="ttname"><a href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a0cd4d9c16cd360a30461396ed53776e3">DRO::VariableRhoNonthermal::VariableRhoNonthermal</a></div><div class="ttdeci">VariableRhoNonthermal(cuint popID)</div><div class="ttdef"><b>Definition</b> <a href="#l00984">datareductionoperator.cpp:984</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_rho_nonthermal_html_a12bae96561440553fa08c3c8d5065d0d"><div class="ttname"><a href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a12bae96561440553fa08c3c8d5065d0d">DRO::VariableRhoNonthermal::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l00999">datareductionoperator.cpp:999</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_rho_nonthermal_html_a1f45a2cf6b2d9ebbb374ae998a9b98f6"><div class="ttname"><a href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a1f45a2cf6b2d9ebbb374ae998a9b98f6">DRO::VariableRhoNonthermal::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l01007">datareductionoperator.cpp:1007</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_rho_nonthermal_html_a4184f7dc704423fff41dc2484f4d71ac"><div class="ttname"><a href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a4184f7dc704423fff41dc2484f4d71ac">DRO::VariableRhoNonthermal::RhoNonthermal</a></div><div class="ttdeci">Real RhoNonthermal</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00414">datareductionoperator.h:414</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_rho_nonthermal_html_a508c82c938bb37d3e282df4cac3d3f7c"><div class="ttname"><a href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a508c82c938bb37d3e282df4cac3d3f7c">DRO::VariableRhoNonthermal::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l00990">datareductionoperator.cpp:990</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_rho_nonthermal_html_a534526c4a3b49b9713817d14ba3da9ba"><div class="ttname"><a href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a534526c4a3b49b9713817d14ba3da9ba">DRO::VariableRhoNonthermal::doSkip</a></div><div class="ttdeci">bool doSkip</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00417">datareductionoperator.h:417</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_rho_nonthermal_html_a77dc54c6d4afa91205d800e2c83f7d8f"><div class="ttname"><a href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a77dc54c6d4afa91205d800e2c83f7d8f">DRO::VariableRhoNonthermal::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l00992">datareductionoperator.cpp:992</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_rho_nonthermal_html_a85c4e08160038fe6398edf3aedfdaa40"><div class="ttname"><a href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a85c4e08160038fe6398edf3aedfdaa40">DRO::VariableRhoNonthermal::~VariableRhoNonthermal</a></div><div class="ttdeci">virtual ~VariableRhoNonthermal()</div><div class="ttdef"><b>Definition</b> <a href="#l00988">datareductionoperator.cpp:988</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_rho_nonthermal_html_a936685050cd690311caa49a9f750ec8a"><div class="ttname"><a href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#a936685050cd690311caa49a9f750ec8a">DRO::VariableRhoNonthermal::popID</a></div><div class="ttdeci">uint popID</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00415">datareductionoperator.h:415</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_rho_nonthermal_html_aec45b2e2297bad42783d6353c8ab71d6"><div class="ttname"><a href="../../dc/dab/class_d_r_o_1_1_variable_rho_nonthermal.html#aec45b2e2297bad42783d6353c8ab71d6">DRO::VariableRhoNonthermal::popName</a></div><div class="ttdeci">std::string popName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00416">datareductionoperator.h:416</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_rho_thermal_html_a08e78b8800c932c47a1d3a83f5d2ff8b"><div class="ttname"><a href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#a08e78b8800c932c47a1d3a83f5d2ff8b">DRO::VariableRhoThermal::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l01036">datareductionoperator.cpp:1036</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_rho_thermal_html_a2a61e44572c1daf13dc4ef8050b0fba0"><div class="ttname"><a href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#a2a61e44572c1daf13dc4ef8050b0fba0">DRO::VariableRhoThermal::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l01019">datareductionoperator.cpp:1019</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_rho_thermal_html_a7c58f833c8c06c57882ea080fb2e87ef"><div class="ttname"><a href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#a7c58f833c8c06c57882ea080fb2e87ef">DRO::VariableRhoThermal::doSkip</a></div><div class="ttdeci">bool doSkip</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00400">datareductionoperator.h:400</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_rho_thermal_html_a8295a49e15ece1374a1a852339cdcf30"><div class="ttname"><a href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#a8295a49e15ece1374a1a852339cdcf30">DRO::VariableRhoThermal::~VariableRhoThermal</a></div><div class="ttdeci">virtual ~VariableRhoThermal()</div><div class="ttdef"><b>Definition</b> <a href="#l01017">datareductionoperator.cpp:1017</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_rho_thermal_html_ab1a8888230933588bc46b6a7dcb48c84"><div class="ttname"><a href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#ab1a8888230933588bc46b6a7dcb48c84">DRO::VariableRhoThermal::popID</a></div><div class="ttdeci">uint popID</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00398">datareductionoperator.h:398</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_rho_thermal_html_abb453ba8ca5bca39034e0b1494381876"><div class="ttname"><a href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#abb453ba8ca5bca39034e0b1494381876">DRO::VariableRhoThermal::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l01021">datareductionoperator.cpp:1021</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_rho_thermal_html_abcca0868d1ab5d27af63f9700cd4a469"><div class="ttname"><a href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#abcca0868d1ab5d27af63f9700cd4a469">DRO::VariableRhoThermal::VariableRhoThermal</a></div><div class="ttdeci">VariableRhoThermal(cuint popID)</div><div class="ttdef"><b>Definition</b> <a href="#l01013">datareductionoperator.cpp:1013</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_rho_thermal_html_ad5a1e79a15059c7629f234ff61ea36be"><div class="ttname"><a href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#ad5a1e79a15059c7629f234ff61ea36be">DRO::VariableRhoThermal::RhoThermal</a></div><div class="ttdeci">Real RhoThermal</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00397">datareductionoperator.h:397</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_rho_thermal_html_ae2ebb9e970d0c84dbe539159761f613c"><div class="ttname"><a href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#ae2ebb9e970d0c84dbe539159761f613c">DRO::VariableRhoThermal::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l01028">datareductionoperator.cpp:1028</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_rho_thermal_html_af7008095e60f00a2837c6f3aeaa31876"><div class="ttname"><a href="../../d9/d24/class_d_r_o_1_1_variable_rho_thermal.html#af7008095e60f00a2837c6f3aeaa31876">DRO::VariableRhoThermal::popName</a></div><div class="ttdeci">std::string popName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00399">datareductionoperator.h:399</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_v_nonthermal_html_a0d0a7b80819c4f495cad8f593db00503"><div class="ttname"><a href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a0d0a7b80819c4f495cad8f593db00503">DRO::VariableVNonthermal::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l01067">datareductionoperator.cpp:1067</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_v_nonthermal_html_a2b10001b4dc64d20576ade0f6ccf1c68"><div class="ttname"><a href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a2b10001b4dc64d20576ade0f6ccf1c68">DRO::VariableVNonthermal::doSkip</a></div><div class="ttdeci">bool doSkip</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00451">datareductionoperator.h:451</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_v_nonthermal_html_a568581bac9f9fae801398fd53bd57c62"><div class="ttname"><a href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a568581bac9f9fae801398fd53bd57c62">DRO::VariableVNonthermal::popName</a></div><div class="ttdeci">std::string popName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00450">datareductionoperator.h:450</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_v_nonthermal_html_a58aebb4a4153d0687ed70a6b7a634968"><div class="ttname"><a href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a58aebb4a4153d0687ed70a6b7a634968">DRO::VariableVNonthermal::~VariableVNonthermal</a></div><div class="ttdeci">virtual ~VariableVNonthermal()</div><div class="ttdef"><b>Definition</b> <a href="#l01046">datareductionoperator.cpp:1046</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_v_nonthermal_html_a605433709438fcaf6dab8efb9b3a34f7"><div class="ttname"><a href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a605433709438fcaf6dab8efb9b3a34f7">DRO::VariableVNonthermal::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l01050">datareductionoperator.cpp:1050</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_v_nonthermal_html_a67f18a5a4ba4b5a4fee996cb040f34c2"><div class="ttname"><a href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a67f18a5a4ba4b5a4fee996cb040f34c2">DRO::VariableVNonthermal::VNonthermal</a></div><div class="ttdeci">Real VNonthermal[3]</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00448">datareductionoperator.h:448</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_v_nonthermal_html_a8e30f5392a95f998ca7f5af7d1b642cc"><div class="ttname"><a href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a8e30f5392a95f998ca7f5af7d1b642cc">DRO::VariableVNonthermal::VariableVNonthermal</a></div><div class="ttdeci">VariableVNonthermal(cuint popID)</div><div class="ttdef"><b>Definition</b> <a href="#l01042">datareductionoperator.cpp:1042</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_v_nonthermal_html_a90b6519c3dca2d589942b178e84d2c91"><div class="ttname"><a href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#a90b6519c3dca2d589942b178e84d2c91">DRO::VariableVNonthermal::popID</a></div><div class="ttdeci">uint popID</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00449">datareductionoperator.h:449</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_v_nonthermal_html_aa6d4f037292e18c33ccd846ddda7ec0d"><div class="ttname"><a href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#aa6d4f037292e18c33ccd846ddda7ec0d">DRO::VariableVNonthermal::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l01057">datareductionoperator.cpp:1057</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_v_nonthermal_html_aa7719605ef25e3ee7f5810443f33790e"><div class="ttname"><a href="../../d6/d5d/class_d_r_o_1_1_variable_v_nonthermal.html#aa7719605ef25e3ee7f5810443f33790e">DRO::VariableVNonthermal::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l01048">datareductionoperator.cpp:1048</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_v_thermal_html_a26031c22122753d147fb040d9dd0e235"><div class="ttname"><a href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a26031c22122753d147fb040d9dd0e235">DRO::VariableVThermal::getDataVectorInfo</a></div><div class="ttdeci">virtual bool getDataVectorInfo(std::string &amp;dataType, unsigned int &amp;dataSize, unsigned int &amp;vectorSize) const</div><div class="ttdef"><b>Definition</b> <a href="#l01084">datareductionoperator.cpp:1084</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_v_thermal_html_a376ed6459d60024ca6c743fda27e8e41"><div class="ttname"><a href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a376ed6459d60024ca6c743fda27e8e41">DRO::VariableVThermal::getName</a></div><div class="ttdeci">virtual std::string getName() const</div><div class="ttdef"><b>Definition</b> <a href="#l01082">datareductionoperator.cpp:1082</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_v_thermal_html_a39fafb68508d0d6ebc9fb55d282f863f"><div class="ttname"><a href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a39fafb68508d0d6ebc9fb55d282f863f">DRO::VariableVThermal::reduceData</a></div><div class="ttdeci">virtual bool reduceData(const SpatialCell *cell, char *buffer)</div><div class="ttdef"><b>Definition</b> <a href="#l01091">datareductionoperator.cpp:1091</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_v_thermal_html_a3ef25f47cf736289eb1d482893357edd"><div class="ttname"><a href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a3ef25f47cf736289eb1d482893357edd">DRO::VariableVThermal::~VariableVThermal</a></div><div class="ttdeci">virtual ~VariableVThermal()</div><div class="ttdef"><b>Definition</b> <a href="#l01080">datareductionoperator.cpp:1080</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_v_thermal_html_a4c39e866a9fa96bdeaf1b25d5faaf859"><div class="ttname"><a href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a4c39e866a9fa96bdeaf1b25d5faaf859">DRO::VariableVThermal::popName</a></div><div class="ttdeci">std::string popName</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00433">datareductionoperator.h:433</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_v_thermal_html_a4cad8f13db3aee52df71fb3323306e99"><div class="ttname"><a href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a4cad8f13db3aee52df71fb3323306e99">DRO::VariableVThermal::setSpatialCell</a></div><div class="ttdeci">virtual bool setSpatialCell(const SpatialCell *cell)</div><div class="ttdef"><b>Definition</b> <a href="#l01101">datareductionoperator.cpp:1101</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_v_thermal_html_a74d9c131419676f72737b9f7623805e1"><div class="ttname"><a href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a74d9c131419676f72737b9f7623805e1">DRO::VariableVThermal::VThermal</a></div><div class="ttdeci">Real VThermal[3]</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00431">datareductionoperator.h:431</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_v_thermal_html_a807ae3c03c380d71decc64da31f1cdab"><div class="ttname"><a href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a807ae3c03c380d71decc64da31f1cdab">DRO::VariableVThermal::VariableVThermal</a></div><div class="ttdeci">VariableVThermal(cuint popID)</div><div class="ttdef"><b>Definition</b> <a href="#l01076">datareductionoperator.cpp:1076</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_v_thermal_html_a8b065291564d47bdb4a26d081f84368e"><div class="ttname"><a href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a8b065291564d47bdb4a26d081f84368e">DRO::VariableVThermal::doSkip</a></div><div class="ttdeci">bool doSkip</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00434">datareductionoperator.h:434</a></div></div>
<div class="ttc" id="aclass_d_r_o_1_1_variable_v_thermal_html_a945385991b44cf9659ab95f274084ca0"><div class="ttname"><a href="../../d0/d75/class_d_r_o_1_1_variable_v_thermal.html#a945385991b44cf9659ab95f274084ca0">DRO::VariableVThermal::popID</a></div><div class="ttdeci">uint popID</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4f/datareductionoperator_8h_source.html#l00432">datareductionoperator.h:432</a></div></div>
<div class="ttc" id="aclassspatial__cell_1_1_spatial_cell_html"><div class="ttname"><a href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html">spatial_cell::SpatialCell</a></div><div class="ttdef"><b>Definition</b> <a href="../../d0/deb/spatial__cell__cpu_8hpp_source.html#l00232">spatial_cell_cpu.hpp:232</a></div></div>
<div class="ttc" id="aclassspatial__cell_1_1_spatial_cell_html_a0a70ad5e1571d0fec973183d1b236682"><div class="ttname"><a href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a0a70ad5e1571d0fec973183d1b236682">spatial_cell::SpatialCell::get_number_of_velocity_blocks</a></div><div class="ttdeci">vmesh::LocalID get_number_of_velocity_blocks(const uint popID) const</div><div class="ttdef"><b>Definition</b> <a href="../../d0/deb/spatial__cell__cpu_8hpp_source.html#l00473">spatial_cell_cpu.hpp:473</a></div></div>
<div class="ttc" id="aclassspatial__cell_1_1_spatial_cell_html_a1dc25bb724906fa5d6dd76096cb7b9a4"><div class="ttname"><a href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a1dc25bb724906fa5d6dd76096cb7b9a4">spatial_cell::SpatialCell::get_velocity_blocks</a></div><div class="ttdeci">vmesh::VelocityBlockContainer * get_velocity_blocks(const size_t &amp;popID)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/deb/spatial__cell__cpu_8hpp_source.html#l00675">spatial_cell_cpu.hpp:675</a></div></div>
<div class="ttc" id="aclassspatial__cell_1_1_spatial_cell_html_a4d5096aa8cc677e97d6e1ff92df7e62e"><div class="ttname"><a href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a4d5096aa8cc677e97d6e1ff92df7e62e">spatial_cell::SpatialCell::sysBoundaryLayer</a></div><div class="ttdeci">uint sysBoundaryLayer</div><div class="ttdef"><b>Definition</b> <a href="../../d0/deb/spatial__cell__cpu_8hpp_source.html#l00369">spatial_cell_cpu.hpp:369</a></div></div>
<div class="ttc" id="aclassspatial__cell_1_1_spatial_cell_html_a5ac5e609f6acb3f06bf4853436a7aef7"><div class="ttname"><a href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#a5ac5e609f6acb3f06bf4853436a7aef7">spatial_cell::SpatialCell::getVelocityBlockMinValue</a></div><div class="ttdeci">Real getVelocityBlockMinValue(const uint popID) const</div><div class="ttdef"><b>Definition</b> <a href="../../da/d31/spatial__cell__cpu_8cpp_source.html#l00592">spatial_cell_cpu.cpp:592</a></div></div>
<div class="ttc" id="aclassspatial__cell_1_1_spatial_cell_html_ab748ab53cfa53a48978a1ed8b6f16e54"><div class="ttname"><a href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ab748ab53cfa53a48978a1ed8b6f16e54">spatial_cell::SpatialCell::derivativesBVOL</a></div><div class="ttdeci">std::array&lt; Real, bvolderivatives::N_BVOL_DERIVATIVES &gt; derivativesBVOL</div><div class="ttdef"><b>Definition</b> <a href="../../d0/deb/spatial__cell__cpu_8hpp_source.html#l00356">spatial_cell_cpu.hpp:356</a></div></div>
<div class="ttc" id="aclassspatial__cell_1_1_spatial_cell_html_ac3e9c10c72c754b3ca8586d8811ad6d4"><div class="ttname"><a href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ac3e9c10c72c754b3ca8586d8811ad6d4">spatial_cell::SpatialCell::get_population</a></div><div class="ttdeci">Population &amp; get_population(const uint popID)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/deb/spatial__cell__cpu_8hpp_source.html#l00492">spatial_cell_cpu.hpp:492</a></div></div>
<div class="ttc" id="aclassspatial__cell_1_1_spatial_cell_html_ad22bb014571653f719c9af2428e765d9"><div class="ttname"><a href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad22bb014571653f719c9af2428e765d9">spatial_cell::SpatialCell::parameters</a></div><div class="ttdeci">std::array&lt; Real, CellParams::N_SPATIAL_CELL_PARAMS &gt; parameters</div><div class="ttdef"><b>Definition</b> <a href="../../d0/deb/spatial__cell__cpu_8hpp_source.html#l00358">spatial_cell_cpu.hpp:358</a></div></div>
<div class="ttc" id="aclassspatial__cell_1_1_spatial_cell_html_ad51ae9a217adf8a65c6b316b1959f95d"><div class="ttname"><a href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ad51ae9a217adf8a65c6b316b1959f95d">spatial_cell::SpatialCell::sysBoundaryFlag</a></div><div class="ttdeci">uint sysBoundaryFlag</div><div class="ttdef"><b>Definition</b> <a href="../../d0/deb/spatial__cell__cpu_8hpp_source.html#l00367">spatial_cell_cpu.hpp:367</a></div></div>
<div class="ttc" id="aclassspatial__cell_1_1_spatial_cell_html_ae0f93c317e351510eeaeaf8a57bf3f79"><div class="ttname"><a href="../../d1/d3f/classspatial__cell_1_1_spatial_cell.html#ae0f93c317e351510eeaeaf8a57bf3f79">spatial_cell::SpatialCell::dev_get_velocity_blocks</a></div><div class="ttdeci">vmesh::VelocityBlockContainer * dev_get_velocity_blocks(const size_t &amp;popID)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d56/spatial__cell__gpu_8hpp_source.html#l01071">spatial_cell_gpu.hpp:1071</a></div></div>
<div class="ttc" id="aclassvmesh_1_1_velocity_block_container_html"><div class="ttname"><a href="../../dd/df7/classvmesh_1_1_velocity_block_container.html">vmesh::VelocityBlockContainer</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/d43/velocity__block__container_8h_source.html#l00059">velocity_block_container.h:59</a></div></div>
<div class="ttc" id="aclassvmesh_1_1_velocity_block_container_html_ab492eded4908cb97927ddc54a0f3d9d3"><div class="ttname"><a href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab492eded4908cb97927ddc54a0f3d9d3">vmesh::VelocityBlockContainer::getParameters</a></div><div class="ttdeci">ARCH_HOSTDEV Real * getParameters()</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d43/velocity__block__container_8h_source.html#l00370">velocity_block_container.h:370</a></div></div>
<div class="ttc" id="aclassvmesh_1_1_velocity_block_container_html_ab577ace09cdc66074a7cdc3d79394cfb"><div class="ttname"><a href="../../dd/df7/classvmesh_1_1_velocity_block_container.html#ab577ace09cdc66074a7cdc3d79394cfb">vmesh::VelocityBlockContainer::getData</a></div><div class="ttdeci">ARCH_HOSTDEV Realf * getData()</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d43/velocity__block__container_8h_source.html#l00330">velocity_block_container.h:330</a></div></div>
<div class="ttc" id="acommon_8cpp_html_a6167b9f510c4eef8b16fa67bf3d5566e"><div class="ttname"><a href="../../d9/df9/common_8cpp.html#a6167b9f510c4eef8b16fa67bf3d5566e">bailout</a></div><div class="ttdeci">void bailout(const bool condition, const std::string &amp;message, const char *const file, const int line)</div><div class="ttdoc">A function to stop the simulation if the boolean condition is true. Raises a flag which gets MPI_Redu...</div><div class="ttdef"><b>Definition</b> <a href="../../d9/df9/common_8cpp_source.html#l00036">common.cpp:36</a></div></div>
<div class="ttc" id="acommon_8h_html_a35eae9266093cf5bc8cfd5925c2ea3e0"><div class="ttname"><a href="../../dc/d54/common_8h.html#a35eae9266093cf5bc8cfd5925c2ea3e0">WID</a></div><div class="ttdeci">#define WID</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00506">common.h:506</a></div></div>
<div class="ttc" id="adatareductionoperator_8cpp_html_a4fb833d220f3704421810d2f70ffbd0d"><div class="ttname"><a href="../../d4/d30/datareductionoperator_8cpp.html#a4fb833d220f3704421810d2f70ffbd0d">P</a></div><div class="ttdeci">Parameters P</div><div class="ttdef"><b>Definition</b> <a href="#l00034">datareductionoperator.cpp:34</a></div></div>
<div class="ttc" id="adatareductionoperator_8h_html"><div class="ttname"><a href="../../d0/d4f/datareductionoperator_8h.html">datareductionoperator.h</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a12a80f52d6e94bfb0add801be63754f3"><div class="ttname"><a href="../../d6/dc2/definitions_8h.html#a12a80f52d6e94bfb0add801be63754f3">cuint</a></div><div class="ttdeci">const uint32_t cuint</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dc2/definitions_8h_source.html#l00050">definitions.h:50</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a17198c9c8dd69af81b358659eeda5a07"><div class="ttname"><a href="../../d6/dc2/definitions_8h.html#a17198c9c8dd69af81b358659eeda5a07">Real</a></div><div class="ttdeci">float Real</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dc2/definitions_8h_source.html#l00041">definitions.h:41</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a65ab62fb58204a4baa2fb83894a20d8a"><div class="ttname"><a href="../../d6/dc2/definitions_8h.html#a65ab62fb58204a4baa2fb83894a20d8a">FS_STENCIL_WIDTH</a></div><div class="ttdeci">#define FS_STENCIL_WIDTH</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dc2/definitions_8h_source.html#l00073">definitions.h:73</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6760bdacc1d8a5bb4c1a42e1103f0064"><div class="ttname"><a href="../../d6/dc2/definitions_8h.html#a6760bdacc1d8a5bb4c1a42e1103f0064">Realf</a></div><div class="ttdeci">float Realf</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dc2/definitions_8h_source.html#l00033">definitions.h:33</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add503fc20115bd5669fb3e0fe4fd344f"><div class="ttname"><a href="../../d6/dc2/definitions_8h.html#add503fc20115bd5669fb3e0fe4fd344f">creal</a></div><div class="ttdeci">const float creal</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dc2/definitions_8h_source.html#l00042">definitions.h:42</a></div></div>
<div class="ttc" id="afs__common_8h_html_a68c0d58de491c8a9c960a96d9b5ed52e"><div class="ttname"><a href="../../d0/d2f/fs__common_8h.html#a68c0d58de491c8a9c960a96d9b5ed52e">HALF</a></div><div class="ttdeci">const Real HALF</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d2f/fs__common_8h_source.html#l00049">fs_common.h:49</a></div></div>
<div class="ttc" id="agpu__pitch__angle__diffusion_8cpp_html_a0e9c72286a5f21231495bac793aa94ba"><div class="ttname"><a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a0e9c72286a5f21231495bac793aa94ba">VY</a></div><div class="ttdeci">const Real VY</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp_source.html#l00069">gpu_pitch_angle_diffusion.cpp:69</a></div></div>
<div class="ttc" id="agpu__pitch__angle__diffusion_8cpp_html_a4d50c87f20e327a2879cb368ebe14a48"><div class="ttname"><a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a4d50c87f20e327a2879cb368ebe14a48">VplasmaZ</a></div><div class="ttdeci">const Real VplasmaZ</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp_source.html#l00074">gpu_pitch_angle_diffusion.cpp:74</a></div></div>
<div class="ttc" id="agpu__pitch__angle__diffusion_8cpp_html_a6040775a62badb3287320f921e52aac0"><div class="ttname"><a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a6040775a62badb3287320f921e52aac0">mu</a></div><div class="ttdeci">const Real mu</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp_source.html#l00078">gpu_pitch_angle_diffusion.cpp:78</a></div></div>
<div class="ttc" id="agpu__pitch__angle__diffusion_8cpp_html_a81874eae0012af6e53e97218e4e4a15f"><div class="ttname"><a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#a81874eae0012af6e53e97218e4e4a15f">VplasmaY</a></div><div class="ttdeci">const Real VplasmaY</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp_source.html#l00073">gpu_pitch_angle_diffusion.cpp:73</a></div></div>
<div class="ttc" id="agpu__pitch__angle__diffusion_8cpp_html_aa516981a6e37a1d3e88478e289d085c9"><div class="ttname"><a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aa516981a6e37a1d3e88478e289d085c9">dmubins</a></div><div class="ttdeci">__global__ void size_t const vmesh::VelocityBlockContainer *__restrict__ const Real Real Real Real Realf int Real const Real dmubins</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp_source.html#l00052">gpu_pitch_angle_diffusion.cpp:52</a></div></div>
<div class="ttc" id="agpu__pitch__angle__diffusion_8cpp_html_abfa9553f301f5f29fe26a8d8f19a20da"><div class="ttname"><a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#abfa9553f301f5f29fe26a8d8f19a20da">muindex</a></div><div class="ttdeci">int muindex</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp_source.html#l00082">gpu_pitch_angle_diffusion.cpp:82</a></div></div>
<div class="ttc" id="agpu__pitch__angle__diffusion_8cpp_html_ac46a17c4331f41374ce5f93f1044923b"><div class="ttname"><a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ac46a17c4331f41374ce5f93f1044923b">VplasmaX</a></div><div class="ttdeci">const Real VplasmaX</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp_source.html#l00072">gpu_pitch_angle_diffusion.cpp:72</a></div></div>
<div class="ttc" id="agpu__pitch__angle__diffusion_8cpp_html_ad20e28ffa1007cb80bd9ac6a30315352"><div class="ttname"><a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad20e28ffa1007cb80bd9ac6a30315352">VZ</a></div><div class="ttdeci">const Real VZ</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp_source.html#l00070">gpu_pitch_angle_diffusion.cpp:70</a></div></div>
<div class="ttc" id="agpu__pitch__angle__diffusion_8cpp_html_ad5cebda4bfa014cb7a1f859d5afb5cc1"><div class="ttname"><a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ad5cebda4bfa014cb7a1f859d5afb5cc1">j</a></div><div class="ttdeci">const int j</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp_source.html#l00060">gpu_pitch_angle_diffusion.cpp:60</a></div></div>
<div class="ttc" id="agpu__pitch__angle__diffusion_8cpp_html_add32bcb06c853cbf2a386499338c75f6"><div class="ttname"><a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#add32bcb06c853cbf2a386499338c75f6">cellIndex</a></div><div class="ttdeci">int cellIndex</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp_source.html#l00362">gpu_pitch_angle_diffusion.cpp:362</a></div></div>
<div class="ttc" id="agpu__pitch__angle__diffusion_8cpp_html_ae7b9d5f1a2beb5e993da2c8410e9a710"><div class="ttname"><a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae7b9d5f1a2beb5e993da2c8410e9a710">Vpara</a></div><div class="ttdeci">const Real Vpara</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp_source.html#l00077">gpu_pitch_angle_diffusion.cpp:77</a></div></div>
<div class="ttc" id="agpu__pitch__angle__diffusion_8cpp_html_ae85f088d236f562d0bfdd2941b09aa62"><div class="ttname"><a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#ae85f088d236f562d0bfdd2941b09aa62">VX</a></div><div class="ttdeci">const Real VX</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp_source.html#l00068">gpu_pitch_angle_diffusion.cpp:68</a></div></div>
<div class="ttc" id="agpu__pitch__angle__diffusion_8cpp_html_aeac95f79b72f13ef3244522682ba9a21"><div class="ttname"><a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aeac95f79b72f13ef3244522682ba9a21">k</a></div><div class="ttdeci">const int k</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp_source.html#l00061">gpu_pitch_angle_diffusion.cpp:61</a></div></div>
<div class="ttc" id="agpu__pitch__angle__diffusion_8cpp_html_aec0849c7d091eab157bff24464f60af2"><div class="ttname"><a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp.html#aec0849c7d091eab157bff24464f60af2">normV</a></div><div class="ttdeci">const Real normV</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d2e/gpu__pitch__angle__diffusion_8cpp_source.html#l00076">gpu_pitch_angle_diffusion.cpp:76</a></div></div>
<div class="ttc" id="aionosphere_solver_tests_2main_8cpp_html_a9bf4cdc41d466e8710b8aa33a33d32e0"><div class="ttname"><a href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp.html#a9bf4cdc41d466e8710b8aa33a33d32e0">getObjectWrapper</a></div><div class="ttdeci">ObjectWrapper &amp; getObjectWrapper()</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d0b/ionosphere_solver_tests_2main_8cpp_source.html#l00024">main.cpp:24</a></div></div>
<div class="ttc" id="anamespace_block_params_html_a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08"><div class="ttname"><a href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a24023106abbfcb1626819109398a1f08">BlockParams::DVY</a></div><div class="ttdeci">@ DVY</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00112">common.h:112</a></div></div>
<div class="ttc" id="anamespace_block_params_html_a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72"><div class="ttname"><a href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856a27d4a371c02d784af7a96d8108accc72">BlockParams::DVX</a></div><div class="ttdeci">@ DVX</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00111">common.h:111</a></div></div>
<div class="ttc" id="anamespace_block_params_html_a01b4a11ca4cd5230c973721f2a934856aa4ae61e72bc15b4114a74faad6e64b07"><div class="ttname"><a href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aa4ae61e72bc15b4114a74faad6e64b07">BlockParams::VZCRD</a></div><div class="ttdeci">@ VZCRD</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00110">common.h:110</a></div></div>
<div class="ttc" id="anamespace_block_params_html_a01b4a11ca4cd5230c973721f2a934856ace98fdb03651c50d1123499280fcb7ba"><div class="ttname"><a href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856ace98fdb03651c50d1123499280fcb7ba">BlockParams::VXCRD</a></div><div class="ttdeci">@ VXCRD</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00108">common.h:108</a></div></div>
<div class="ttc" id="anamespace_block_params_html_a01b4a11ca4cd5230c973721f2a934856addc5022ec6d36b0fc9a73d025cc14485"><div class="ttname"><a href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856addc5022ec6d36b0fc9a73d025cc14485">BlockParams::VYCRD</a></div><div class="ttdeci">@ VYCRD</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00109">common.h:109</a></div></div>
<div class="ttc" id="anamespace_block_params_html_a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5"><div class="ttname"><a href="../../d6/de1/namespace_block_params.html#a01b4a11ca4cd5230c973721f2a934856aed7f2057686e3266c88f328345fac9d5">BlockParams::DVZ</a></div><div class="ttdeci">@ DVZ</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00113">common.h:113</a></div></div>
<div class="ttc" id="anamespace_cell_params_html_a90b8e80c381dc853e399330bc6936840a0b14dcc916a785f309ca6c122d8acecb"><div class="ttname"><a href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a0b14dcc916a785f309ca6c122d8acecb">CellParams::BGBXVOL</a></div><div class="ttdeci">@ BGBXVOL</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00146">common.h:146</a></div></div>
<div class="ttc" id="anamespace_cell_params_html_a90b8e80c381dc853e399330bc6936840a1512b1251b929440b04528c5ba06f6f9"><div class="ttname"><a href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a1512b1251b929440b04528c5ba06f6f9">CellParams::P_11</a></div><div class="ttdeci">@ P_11</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00165">common.h:165</a></div></div>
<div class="ttc" id="anamespace_cell_params_html_a90b8e80c381dc853e399330bc6936840a228714562c2cdc3ad2e73659046a8efa"><div class="ttname"><a href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a228714562c2cdc3ad2e73659046a8efa">CellParams::P_33</a></div><div class="ttdeci">@ P_33</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00167">common.h:167</a></div></div>
<div class="ttc" id="anamespace_cell_params_html_a90b8e80c381dc853e399330bc6936840a2de546e2cd563cbb4d339f823c28fc7f"><div class="ttname"><a href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a2de546e2cd563cbb4d339f823c28fc7f">CellParams::VZ</a></div><div class="ttdeci">@ VZ</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00139">common.h:139</a></div></div>
<div class="ttc" id="anamespace_cell_params_html_a90b8e80c381dc853e399330bc6936840a469ec6fde1e7d76a72800cd322b733d2"><div class="ttname"><a href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a469ec6fde1e7d76a72800cd322b733d2">CellParams::ZCRD</a></div><div class="ttdeci">@ ZCRD</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00131">common.h:131</a></div></div>
<div class="ttc" id="anamespace_cell_params_html_a90b8e80c381dc853e399330bc6936840a50f3584d2fa8255ba2df24d8b01d8a83"><div class="ttname"><a href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a50f3584d2fa8255ba2df24d8b01d8a83">CellParams::PERBXVOL</a></div><div class="ttdeci">@ PERBXVOL</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00149">common.h:149</a></div></div>
<div class="ttc" id="anamespace_cell_params_html_a90b8e80c381dc853e399330bc6936840a75e41e45c0e401d091dad2e29dde4909"><div class="ttname"><a href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a75e41e45c0e401d091dad2e29dde4909">CellParams::VX</a></div><div class="ttdeci">@ VX</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00137">common.h:137</a></div></div>
<div class="ttc" id="anamespace_cell_params_html_a90b8e80c381dc853e399330bc6936840a80b0754b2b9b26ada32cb7e7ea3835d4"><div class="ttname"><a href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a80b0754b2b9b26ada32cb7e7ea3835d4">CellParams::P_22</a></div><div class="ttdeci">@ P_22</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00166">common.h:166</a></div></div>
<div class="ttc" id="anamespace_cell_params_html_a90b8e80c381dc853e399330bc6936840a8d84d511a8af5fc3860564fbf862845e"><div class="ttname"><a href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840a8d84d511a8af5fc3860564fbf862845e">CellParams::BGBZVOL</a></div><div class="ttdeci">@ BGBZVOL</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00148">common.h:148</a></div></div>
<div class="ttc" id="anamespace_cell_params_html_a90b8e80c381dc853e399330bc6936840ac44a0b8ba721d489ba7f5d0e74c592ac"><div class="ttname"><a href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840ac44a0b8ba721d489ba7f5d0e74c592ac">CellParams::PERBYVOL</a></div><div class="ttdeci">@ PERBYVOL</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00150">common.h:150</a></div></div>
<div class="ttc" id="anamespace_cell_params_html_a90b8e80c381dc853e399330bc6936840ad5a8e812e459b91b7148798568c469a1"><div class="ttname"><a href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840ad5a8e812e459b91b7148798568c469a1">CellParams::DZ</a></div><div class="ttdeci">@ DZ</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00135">common.h:135</a></div></div>
<div class="ttc" id="anamespace_cell_params_html_a90b8e80c381dc853e399330bc6936840ad9d470cda28e4d96059ae0a1335552e5"><div class="ttname"><a href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840ad9d470cda28e4d96059ae0a1335552e5">CellParams::PERBZVOL</a></div><div class="ttdeci">@ PERBZVOL</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00151">common.h:151</a></div></div>
<div class="ttc" id="anamespace_cell_params_html_a90b8e80c381dc853e399330bc6936840ae5c6d66d7d0c73858a1c8ca46f5952a5"><div class="ttname"><a href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840ae5c6d66d7d0c73858a1c8ca46f5952a5">CellParams::BGBYVOL</a></div><div class="ttdeci">@ BGBYVOL</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00147">common.h:147</a></div></div>
<div class="ttc" id="anamespace_cell_params_html_a90b8e80c381dc853e399330bc6936840af916b65768e628165d616adb69c30441"><div class="ttname"><a href="../../dd/dcb/namespace_cell_params.html#a90b8e80c381dc853e399330bc6936840af916b65768e628165d616adb69c30441">CellParams::VY</a></div><div class="ttdeci">@ VY</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00138">common.h:138</a></div></div>
<div class="ttc" id="anamespace_d_r_o_html"><div class="ttname"><a href="../../db/d48/namespace_d_r_o.html">DRO</a></div><div class="ttdef"><b>Definition</b> <a href="#l00036">datareductionoperator.cpp:36</a></div></div>
<div class="ttc" id="anamespace_d_r_o_html_a4665b4ea30292022d8c8d81b83e6813f"><div class="ttname"><a href="../../db/d48/namespace_d_r_o.html#a4665b4ea30292022d8c8d81b83e6813f">DRO::VNonthermalCalculation</a></div><div class="ttdeci">static void VNonthermalCalculation(const SpatialCell *cell, const bool calculateNonthermal, cuint popID, Real *V)</div><div class="ttdef"><b>Definition</b> <a href="#l00774">datareductionoperator.cpp:774</a></div></div>
<div class="ttc" id="anamespace_d_r_o_html_a52c6728e661e56288611a96cf1c25d80"><div class="ttname"><a href="../../db/d48/namespace_d_r_o.html#a52c6728e661e56288611a96cf1c25d80">DRO::PTensorOffDiagonalNonthermalCalculations</a></div><div class="ttdeci">static void PTensorOffDiagonalNonthermalCalculations(const SpatialCell *cell, const bool calculateNonthermal, const Real averageVX, const Real averageVY, const Real averageVZ, cuint popID, Real *PTensor)</div><div class="ttdef"><b>Definition</b> <a href="#l00914">datareductionoperator.cpp:914</a></div></div>
<div class="ttc" id="anamespace_d_r_o_html_a52d86cee7ef279930db199747125a464"><div class="ttname"><a href="../../db/d48/namespace_d_r_o.html#a52d86cee7ef279930db199747125a464">DRO::PTensorDiagonalNonthermalCalculations</a></div><div class="ttdeci">static void PTensorDiagonalNonthermalCalculations(const SpatialCell *cell, const bool calculateNonthermal, const Real averageVX, const Real averageVY, const Real averageVZ, cuint popID, Real *PTensor)</div><div class="ttdef"><b>Definition</b> <a href="#l00849">datareductionoperator.cpp:849</a></div></div>
<div class="ttc" id="anamespace_d_r_o_html_aee822912aab9606485c338aef20c84dc"><div class="ttname"><a href="../../db/d48/namespace_d_r_o.html#aee822912aab9606485c338aef20c84dc">DRO::rhoNonthermalCalculation</a></div><div class="ttdeci">static void rhoNonthermalCalculation(const SpatialCell *cell, const bool calculateNonthermal, cuint popID, Real &amp;rho)</div><div class="ttdef"><b>Definition</b> <a href="#l00720">datareductionoperator.cpp:720</a></div></div>
<div class="ttc" id="anamespacearch_html_a8b44f7f5126702d29110d539cdfbd7e8"><div class="ttname"><a href="../../d9/d6a/namespacearch.html#a8b44f7f5126702d29110d539cdfbd7e8">arch::parallel_reduce</a></div><div class="ttdeci">static void parallel_reduce(const uint(&amp;limits)[NDim], Lambda loop_body, T &amp;sum)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d9d/arch__device__api_8h_source.html#l00040">arch_device_api.h:40</a></div></div>
<div class="ttc" id="anamespacephysicalconstants_html_a3b6b084bee2f2d9da50526b722487f0e"><div class="ttname"><a href="../../d7/d2f/namespacephysicalconstants.html#a3b6b084bee2f2d9da50526b722487f0e">physicalconstants::CHARGE</a></div><div class="ttdeci">const Real CHARGE</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00564">common.h:564</a></div></div>
<div class="ttc" id="anamespacephysicalconstants_html_aae884ab721eb17968526710ba72b0996"><div class="ttname"><a href="../../d7/d2f/namespacephysicalconstants.html#aae884ab721eb17968526710ba72b0996">physicalconstants::K_B</a></div><div class="ttdeci">const Real K_B</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d54/common_8h_source.html#l00563">common.h:563</a></div></div>
<div class="ttc" id="aobject__wrapper_8h_html"><div class="ttname"><a href="../../d0/dfd/object__wrapper_8h.html">object_wrapper.h</a></div></div>
<div class="ttc" id="astruct_object_wrapper_html_a7ad5d76ca5ddb543f0ef6e3cba86f95d"><div class="ttname"><a href="../../db/d4e/struct_object_wrapper.html#a7ad5d76ca5ddb543f0ef6e3cba86f95d">ObjectWrapper::particleSpecies</a></div><div class="ttdeci">std::vector&lt; species::Species &gt; particleSpecies</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dfd/object__wrapper_8h_source.html#l00048">object_wrapper.h:48</a></div></div>
<div class="ttc" id="astruct_parameters_html"><div class="ttname"><a href="../../d0/dbf/struct_parameters.html">Parameters</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/d3b/parameters_8h_source.html#l00037">parameters.h:37</a></div></div>
<div class="ttc" id="astruct_parameters_html_ad1619d6b9d1fc4f197cea1663171cff6"><div class="ttname"><a href="../../d0/dbf/struct_parameters.html#ad1619d6b9d1fc4f197cea1663171cff6">Parameters::PADmubins</a></div><div class="ttdeci">static int PADmubins</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d3b/parameters_8h_source.html#l00238">parameters.h:238</a></div></div>
<div class="ttc" id="astruct_parameters_html_ae493fa7c00c862e1124a85ecb6ea7e19"><div class="ttname"><a href="../../d0/dbf/struct_parameters.html#ae493fa7c00c862e1124a85ecb6ea7e19">Parameters::systemWriteName</a></div><div class="ttdeci">static std::vector&lt; std::string &gt; systemWriteName</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d3b/parameters_8h_source.html#l00082">parameters.h:82</a></div></div>
<div class="ttc" id="astruct_s_b_c_1_1_spherical_tri_grid_html"><div class="ttname"><a href="../../d4/d8d/struct_s_b_c_1_1_spherical_tri_grid.html">SBC::SphericalTriGrid</a></div><div class="ttdef"><b>Definition</b> <a href="../../d5/d91/ionosphere_8h_source.html#l00073">ionosphere.h:73</a></div></div>
<div class="ttc" id="astructspatial__cell_1_1_population_html_a196a102b33d6f8d6fee1aff20c29197a"><div class="ttname"><a href="../../d5/d8c/structspatial__cell_1_1_population.html#a196a102b33d6f8d6fee1aff20c29197a">spatial_cell::Population::V_V</a></div><div class="ttdeci">Real V_V[3]</div><div class="ttdef"><b>Definition</b> <a href="../../d0/deb/spatial__cell__cpu_8hpp_source.html#l00072">spatial_cell_cpu.hpp:72</a></div></div>
<div class="ttc" id="astructspatial__cell_1_1_population_html_a48307ec57a24640206bdc2b7659f66b1"><div class="ttname"><a href="../../d5/d8c/structspatial__cell_1_1_population.html#a48307ec57a24640206bdc2b7659f66b1">spatial_cell::Population::RHO_V</a></div><div class="ttdeci">Real RHO_V</div><div class="ttdef"><b>Definition</b> <a href="../../d0/deb/spatial__cell__cpu_8hpp_source.html#l00071">spatial_cell_cpu.hpp:71</a></div></div>
<div class="ttc" id="avectorclass__fallback_8h_html_a1896c5fbdb17de74189d1d18cdd4cf29"><div class="ttname"><a href="../../d8/dbc/vectorclass__fallback_8h.html#a1896c5fbdb17de74189d1d18cdd4cf29">min</a></div><div class="ttdeci">static ARCH_HOSTDEV VecSimple&lt; T &gt; min(VecSimple&lt; T &gt; const &amp;l, VecSimple&lt; T &gt; const &amp;r)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dbc/vectorclass__fallback_8h_source.html#l00463">vectorclass_fallback.h:463</a></div></div>
<div class="ttc" id="avectorclass__fallback_8h_html_a92b2075c51472d120e4ef0a663e3814b"><div class="ttname"><a href="../../d8/dbc/vectorclass__fallback_8h.html#a92b2075c51472d120e4ef0a663e3814b">max</a></div><div class="ttdeci">static ARCH_HOSTDEV VecSimple&lt; T &gt; max(VecSimple&lt; T &gt; const &amp;l, VecSimple&lt; T &gt; const &amp;r)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dbc/vectorclass__fallback_8h_source.html#l00481">vectorclass_fallback.h:481</a></div></div>
<div class="ttc" id="avectorclass__fallback_8h_html_ad1eccb49237393bcbb5b6b97556fa4e2"><div class="ttname"><a href="../../d8/dbc/vectorclass__fallback_8h.html#ad1eccb49237393bcbb5b6b97556fa4e2">abs</a></div><div class="ttdeci">static ARCH_HOSTDEV VecSimple&lt; T &gt; abs(const VecSimple&lt; T &gt; &amp;l)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dbc/vectorclass__fallback_8h_source.html#l00081">vectorclass_fallback.h:81</a></div></div>
<div class="ttc" id="avectorclass__fallback_8h_html_ae83b95cd4defb63faf66a7cbc78801e6"><div class="ttname"><a href="../../d8/dbc/vectorclass__fallback_8h.html#ae83b95cd4defb63faf66a7cbc78801e6">floor</a></div><div class="ttdeci">static ARCH_HOSTDEV VecSimple&lt; T &gt; floor(VecSimple&lt; T &gt; const &amp;a)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dbc/vectorclass__fallback_8h_source.html#l00598">vectorclass_fallback.h:598</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="../../dir_6394816b87381dc44c84126aa7a65687.html">datareduction</a></li><li class="navelem"><a href="../../d4/d30/datareductionoperator_8cpp.html">datareductionoperator.cpp</a></li>
    <li class="footer">Generated on <span class="timestamp"></span> for Vlasiator by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
